"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
Object.defineProperty(exports, "DEFAULT_ADB_EXEC_TIMEOUT", {
  enumerable: true,
  get: function () {
    return _helpers.DEFAULT_ADB_EXEC_TIMEOUT;
  }
});
exports.default = void 0;
exports.getAndroidBinaryPath = getAndroidBinaryPath;
require("source-map-support/register");
var _path = _interopRequireDefault(require("path"));
var _logger = _interopRequireDefault(require("../logger.js"));
var _bluebird = _interopRequireDefault(require("bluebird"));
var _support = require("@appium/support");
var _helpers = require("../helpers");
var _teen_process = require("teen_process");
var _asyncbox = require("asyncbox");
var _lodash = _interopRequireDefault(require("lodash"));
var _semver = _interopRequireDefault(require("semver"));
let systemCallMethods = {};
const DEFAULT_ADB_REBOOT_RETRIES = 90;
const LINKER_WARNING_REGEXP = /^WARNING: linker.+$/m;
const ADB_RETRY_ERROR_PATTERNS = [/protocol fault \(no status\)/i, /error: device ('.+' )?not found/i, /error: device still connecting/i];
const BINARY_VERSION_PATTERN = /^Version ([\d.]+)-(\d+)/m;
const BRIDGE_VERSION_PATTERN = /^Android Debug Bridge version ([\d.]+)/m;
const CERTS_ROOT = '/system/etc/security/cacerts';
const SDK_BINARY_ROOTS = ['platform-tools', 'emulator', ['cmdline-tools', 'latest', 'bin'], 'tools', ['tools', 'bin'], '.'];
const MIN_DELAY_ADB_API_LEVEL = 28;
const REQUIRED_SERVICES = ['activity', 'package', 'mount'];
systemCallMethods.getSdkBinaryPath = async function getSdkBinaryPath(binaryName) {
  return await this.getBinaryFromSdkRoot(binaryName);
};
systemCallMethods.getBinaryNameForOS = _lodash.default.memoize(function getBinaryNameForOSMemorize(binaryName) {
  return getBinaryNameForOS(binaryName);
});
function getBinaryNameForOS(binaryName) {
  if (!_support.system.isWindows()) {
    return binaryName;
  }
  if (['android', 'apksigner', 'apkanalyzer'].includes(binaryName)) {
    return `${binaryName}.bat`;
  }
  if (!_path.default.extname(binaryName)) {
    return `${binaryName}.exe`;
  }
  return binaryName;
}
systemCallMethods.getBinaryFromSdkRoot = async function getBinaryFromSdkRoot(binaryName) {
  if (this.binaries[binaryName]) {
    return this.binaries[binaryName];
  }
  const fullBinaryName = this.getBinaryNameForOS(binaryName);
  const binaryLocs = getSdkBinaryLocationCandidates(this.sdkRoot, fullBinaryName);
  let buildToolsDirs = await (0, _helpers.getBuildToolsDirs)(this.sdkRoot);
  if (this.buildToolsVersion) {
    buildToolsDirs = buildToolsDirs.filter(x => _path.default.basename(x) === this.buildToolsVersion);
    if (_lodash.default.isEmpty(buildToolsDirs)) {
      _logger.default.info(`Found no build tools whose version matches to '${this.buildToolsVersion}'`);
    } else {
      _logger.default.info(`Using build tools at '${buildToolsDirs}'`);
    }
  }
  binaryLocs.push(..._lodash.default.flatten(buildToolsDirs.map(dir => [_path.default.resolve(dir, fullBinaryName), _path.default.resolve(dir, 'lib', fullBinaryName)])));
  let binaryLoc = null;
  for (const loc of binaryLocs) {
    if (await _support.fs.exists(loc)) {
      binaryLoc = loc;
      break;
    }
  }
  if (_lodash.default.isNull(binaryLoc)) {
    throw new Error(`Could not find '${fullBinaryName}' in ${JSON.stringify(binaryLocs)}. ` + `Do you have Android Build Tools ${this.buildToolsVersion ? `v ${this.buildToolsVersion} ` : ''}` + `installed at '${this.sdkRoot}'?`);
  }
  _logger.default.info(`Using '${fullBinaryName}' from '${binaryLoc}'`);
  this.binaries[binaryName] = binaryLoc;
  return binaryLoc;
};
function getSdkBinaryLocationCandidates(sdkRoot, fullBinaryName) {
  return SDK_BINARY_ROOTS.map(x => _path.default.resolve(sdkRoot, ...(_lodash.default.isArray(x) ? x : [x]), fullBinaryName));
}
async function getAndroidBinaryPath(binaryName) {
  const fullBinaryName = getBinaryNameForOS(binaryName);
  const sdkRoot = (0, _helpers.getSdkRootFromEnv)();
  const binaryLocs = getSdkBinaryLocationCandidates(sdkRoot, fullBinaryName);
  for (const loc of binaryLocs) {
    if (await _support.fs.exists(loc)) {
      return loc;
    }
  }
  throw new Error(`Could not find '${fullBinaryName}' in ${JSON.stringify(binaryLocs)}. ` + `Do you have Android Build Tools installed at '${sdkRoot}'?`);
}
systemCallMethods.getBinaryFromPath = async function getBinaryFromPath(binaryName) {
  if (this.binaries[binaryName]) {
    return this.binaries[binaryName];
  }
  const fullBinaryName = this.getBinaryNameForOS(binaryName);
  try {
    const binaryLoc = await _support.fs.which(fullBinaryName);
    _logger.default.info(`Using '${fullBinaryName}' from '${binaryLoc}'`);
    this.binaries[binaryName] = binaryLoc;
    return binaryLoc;
  } catch (e) {
    throw new Error(`Could not find '${fullBinaryName}' in PATH. Please set the ANDROID_HOME ` + `or ANDROID_SDK_ROOT environment variables to the correct Android SDK root directory path.`);
  }
};
systemCallMethods.getConnectedDevices = async function getConnectedDevices(opts = {}) {
  _logger.default.debug('Getting connected devices');
  const args = [...this.executable.defaultArgs, 'devices'];
  if (opts.verbose) {
    args.push('-l');
  }
  let stdout;
  try {
    ({
      stdout
    } = await (0, _teen_process.exec)(this.executable.path, args));
  } catch (e) {
    throw new Error(`Error while getting connected devices. Original error: ${e.message}`);
  }
  const listHeader = 'List of devices';
  const startingIndex = stdout.indexOf(listHeader);
  if (startingIndex < 0) {
    throw new Error(`Unexpected output while trying to get devices: ${stdout}`);
  }
  stdout = stdout.slice(startingIndex);
  let excludedLines = [listHeader, 'adb server', '* daemon'];
  if (!this.allowOfflineDevices) {
    excludedLines.push('offline');
  }
  const devices = stdout.split('\n').map(_lodash.default.trim).filter(line => line && !excludedLines.some(x => line.includes(x))).map(line => {
    const [udid, state, ...description] = line.split(/\s+/);
    const device = {
      udid,
      state
    };
    if (opts.verbose) {
      for (const entry of description) {
        if (entry.includes(':')) {
          const [key, value] = entry.split(':');
          device[key] = value;
        }
      }
    }
    return device;
  });
  if (_lodash.default.isEmpty(devices)) {
    _logger.default.debug('No connected devices have been detected');
  } else {
    _logger.default.debug(`Connected devices: ${JSON.stringify(devices)}`);
  }
  return devices;
};
systemCallMethods.getDevicesWithRetry = async function getDevicesWithRetry(timeoutMs = 20000) {
  const timer = new _support.timing.Timer().start();
  _logger.default.debug('Trying to find a connected android device');
  const getDevices = async () => {
    if (timer.getDuration().asMilliSeconds > timeoutMs) {
      throw new Error(`Could not find a connected Android device in ${timer.getDuration().asMilliSeconds.toFixed(0)}ms.`);
    }
    try {
      const devices = await this.getConnectedDevices();
      if (devices.length > 0) {
        return devices;
      }
    } catch (ign) {}
    _logger.default.debug('Could not find online devices');
    try {
      await this.reconnect();
    } catch (ign) {
      await this.restartAdb();
    }
    await (0, _asyncbox.sleep)(200);
    return await getDevices();
  };
  return await getDevices();
};
systemCallMethods.reconnect = async function reconnect(target = 'offline') {
  _logger.default.debug(`Reconnecting adb (target ${target})`);
  const args = ['reconnect'];
  if (target) {
    args.push(target);
  }
  try {
    await this.adbExec(args);
  } catch (e) {
    throw new Error(`Cannot reconnect adb. Original error: ${e.stderr || e.message}`);
  }
};
systemCallMethods.restartAdb = async function restartAdb() {
  if (this.suppressKillServer) {
    _logger.default.debug(`Not restarting abd since 'suppressKillServer' is on`);
    return;
  }
  _logger.default.debug('Restarting adb');
  try {
    await this.killServer();
    await this.adbExec(['start-server']);
  } catch (e) {
    _logger.default.error(`Error killing ADB server, going to see if it's online anyway`);
  }
};
systemCallMethods.killServer = async function killServer() {
  _logger.default.debug(`Killing adb server on port '${this.adbPort}'`);
  await this.adbExec(['kill-server'], {
    exclusive: true
  });
};
systemCallMethods.resetTelnetAuthToken = _lodash.default.memoize(async function resetTelnetAuthToken() {
  const homeFolderPath = process.env[process.platform === 'win32' ? 'USERPROFILE' : 'HOME'];
  if (!homeFolderPath) {
    _logger.default.warn(`Cannot find the path to user home folder. Ignoring resetting of emulator's telnet authentication token`);
    return false;
  }
  const dstPath = _path.default.resolve(homeFolderPath, '.emulator_console_auth_token');
  _logger.default.debug(`Overriding ${dstPath} with an empty string to avoid telnet authentication for emulator commands`);
  try {
    await _support.fs.writeFile(dstPath, '');
  } catch (e) {
    _logger.default.warn(`Error ${e.message} while resetting the content of ${dstPath}. Ignoring resetting of emulator's telnet authentication token`);
    return false;
  }
  return true;
});
systemCallMethods.adbExecEmu = async function adbExecEmu(cmd) {
  await this.verifyEmulatorConnected();
  await this.resetTelnetAuthToken();
  await this.adbExec(['emu', ...cmd]);
};
let isExecLocked = false;
systemCallMethods.EXEC_OUTPUT_FORMAT = Object.freeze({
  STDOUT: 'stdout',
  FULL: 'full'
});
systemCallMethods.adbExec = async function adbExec(cmd, opts = {}) {
  if (!cmd) {
    throw new Error('You need to pass in a command to adbExec()');
  }
  opts = _lodash.default.cloneDeep(opts);
  opts.timeout = opts.timeout || this.adbExecTimeout || _helpers.DEFAULT_ADB_EXEC_TIMEOUT;
  opts.timeoutCapName = opts.timeoutCapName || 'adbExecTimeout';
  const {
    outputFormat = this.EXEC_OUTPUT_FORMAT.STDOUT
  } = opts;
  cmd = _lodash.default.isArray(cmd) ? cmd : [cmd];
  let adbRetried = false;
  const execFunc = async () => {
    try {
      const args = [...this.executable.defaultArgs, ...cmd];
      _logger.default.debug(`Running '${this.executable.path} ` + (args.find(arg => /\s+/.test(arg)) ? _support.util.quote(args) : args.join(' ')) + `'`);
      let {
        stdout,
        stderr
      } = await (0, _teen_process.exec)(this.executable.path, args, opts);
      stdout = stdout.replace(LINKER_WARNING_REGEXP, '').trim();
      return outputFormat === this.EXEC_OUTPUT_FORMAT.FULL ? {
        stdout,
        stderr
      } : stdout;
    } catch (e) {
      const errText = `${e.message}, ${e.stdout}, ${e.stderr}`;
      if (ADB_RETRY_ERROR_PATTERNS.some(p => p.test(errText))) {
        _logger.default.info(`Error sending command, reconnecting device and retrying: ${cmd}`);
        await (0, _asyncbox.sleep)(1000);
        await this.getDevicesWithRetry();
        if (adbRetried) {
          adbRetried = true;
          return await execFunc();
        }
      }
      if (e.code === 0 && e.stdout) {
        return e.stdout.replace(LINKER_WARNING_REGEXP, '').trim();
      }
      if (_lodash.default.isNull(e.code)) {
        e.message = `Error executing adbExec. Original error: '${e.message}'. ` + `Try to increase the ${opts.timeout}ms adb execution timeout represented by '${opts.timeoutCapName}' capability`;
      } else {
        e.message = `Error executing adbExec. Original error: '${e.message}'; ` + `Command output: ${e.stderr || e.stdout || '<empty>'}`;
      }
      throw e;
    }
  };
  if (isExecLocked) {
    _logger.default.debug('Waiting until the other exclusive ADB command is completed');
    await (0, _asyncbox.waitForCondition)(() => !isExecLocked, {
      waitMs: Number.MAX_SAFE_INTEGER,
      intervalMs: 10
    });
    _logger.default.debug('Continuing with the current ADB command');
  }
  if (opts.exclusive) {
    isExecLocked = true;
  }
  try {
    return await execFunc();
  } finally {
    if (opts.exclusive) {
      isExecLocked = false;
    }
  }
};
systemCallMethods.shell = async function shell(cmd, opts = {}) {
  const {
    privileged
  } = opts;
  const cmdArr = _lodash.default.isArray(cmd) ? cmd : [cmd];
  const fullCmd = ['shell'];
  if (privileged) {
    _logger.default.info(`'adb shell ${_support.util.quote(cmdArr)}' requires root access`);
    if (await this.isRoot()) {
      _logger.default.info('The device already had root access');
      fullCmd.push(...cmdArr);
    } else {
      fullCmd.push('su', 'root', _support.util.quote(cmdArr));
    }
  } else {
    fullCmd.push(...cmdArr);
  }
  return await this.adbExec(fullCmd, opts);
};
systemCallMethods.createSubProcess = function createSubProcess(args = []) {
  args = [...this.executable.defaultArgs, ...args];
  _logger.default.debug(`Creating ADB subprocess with args: ${JSON.stringify(args)}`);
  return new _teen_process.SubProcess(this.getAdbPath(), args);
};
systemCallMethods.getAdbServerPort = function getAdbServerPort() {
  return this.adbPort;
};
systemCallMethods.getEmulatorPort = async function getEmulatorPort() {
  _logger.default.debug('Getting running emulator port');
  if (this.emulatorPort !== null) {
    return this.emulatorPort;
  }
  try {
    let devices = await this.getConnectedDevices();
    let port = this.getPortFromEmulatorString(devices[0].udid);
    if (port) {
      return port;
    } else {
      throw new Error(`Emulator port not found`);
    }
  } catch (e) {
    throw new Error(`No devices connected. Original error: ${e.message}`);
  }
};
systemCallMethods.getPortFromEmulatorString = function getPortFromEmulatorString(emStr) {
  let portPattern = /emulator-(\d+)/;
  if (portPattern.test(emStr)) {
    return parseInt(portPattern.exec(emStr)[1], 10);
  }
  return false;
};
systemCallMethods.getConnectedEmulators = async function getConnectedEmulators(opts = {}) {
  _logger.default.debug('Getting connected emulators');
  try {
    let devices = await this.getConnectedDevices(opts);
    let emulators = [];
    for (let device of devices) {
      let port = this.getPortFromEmulatorString(device.udid);
      if (port) {
        device.port = port;
        emulators.push(device);
      }
    }
    _logger.default.debug(`${_support.util.pluralize('emulator', emulators.length, true)} connected`);
    return emulators;
  } catch (e) {
    throw new Error(`Error getting emulators. Original error: ${e.message}`);
  }
};
systemCallMethods.setEmulatorPort = function setEmulatorPort(emPort) {
  this.emulatorPort = emPort;
};
systemCallMethods.setDeviceId = function setDeviceId(deviceId) {
  _logger.default.debug(`Setting device id to ${deviceId}`);
  this.curDeviceId = deviceId;
  let argsHasDevice = this.executable.defaultArgs.indexOf('-s');
  if (argsHasDevice !== -1) {
    this.executable.defaultArgs.splice(argsHasDevice, 2);
  }
  this.executable.defaultArgs.push('-s', deviceId);
};
systemCallMethods.setDevice = function setDevice(deviceObj) {
  let deviceId = deviceObj.udid;
  let emPort = this.getPortFromEmulatorString(deviceId);
  this.setEmulatorPort(emPort);
  this.setDeviceId(deviceId);
};
systemCallMethods.getRunningAVD = async function getRunningAVD(avdName) {
  _logger.default.debug(`Trying to find '${avdName}' emulator`);
  try {
    const emulators = await this.getConnectedEmulators();
    for (const emulator of emulators) {
      this.setEmulatorPort(emulator.port);
      const runningAVDName = await this.execEmuConsoleCommand(['avd', 'name'], {
        port: emulator.port,
        execTimeout: 5000,
        connTimeout: 1000
      });
      if (_lodash.default.toLower(avdName) === _lodash.default.toLower(runningAVDName.trim())) {
        _logger.default.debug(`Found emulator '${avdName}' on port ${emulator.port}`);
        this.setDeviceId(emulator.udid);
        return emulator;
      }
    }
    _logger.default.debug(`Emulator '${avdName}' not running`);
    return null;
  } catch (e) {
    throw new Error(`Error getting AVD. Original error: ${e.message}`);
  }
};
systemCallMethods.getRunningAVDWithRetry = async function getRunningAVDWithRetry(avdName, timeoutMs = 20000) {
  try {
    return await (0, _asyncbox.waitForCondition)(async () => {
      try {
        return await this.getRunningAVD(avdName.replace('@', ''));
      } catch (e) {
        _logger.default.debug(e.message);
        return false;
      }
    }, {
      waitMs: timeoutMs,
      intervalMs: 1000
    });
  } catch (e) {
    throw new Error(`Error getting AVD with retry. Original error: ${e.message}`);
  }
};
systemCallMethods.killAllEmulators = async function killAllEmulators() {
  let cmd, args;
  if (_support.system.isWindows()) {
    cmd = 'TASKKILL';
    args = ['TASKKILL', '/IM', 'emulator.exe'];
  } else {
    cmd = '/usr/bin/killall';
    args = ['-m', 'emulator*'];
  }
  try {
    await (0, _teen_process.exec)(cmd, args);
  } catch (e) {
    throw new Error(`Error killing emulators. Original error: ${e.message}`);
  }
};
systemCallMethods.killEmulator = async function killEmulator(avdName = null, timeout = 60000) {
  if (_support.util.hasValue(avdName)) {
    _logger.default.debug(`Killing avd '${avdName}'`);
    const device = await this.getRunningAVD(avdName);
    if (!device) {
      _logger.default.info(`No avd with name '${avdName}' running. Skipping kill step.`);
      return false;
    }
  } else {
    _logger.default.debug(`Killing avd with id '${this.curDeviceId}'`);
    if (!(await this.isEmulatorConnected())) {
      _logger.default.debug(`Emulator with id '${this.curDeviceId}' not connected. Skipping kill step`);
      return false;
    }
  }
  await this.adbExec(['emu', 'kill']);
  _logger.default.debug(`Waiting up to ${timeout}ms until the emulator '${avdName ? avdName : this.curDeviceId}' is killed`);
  try {
    await (0, _asyncbox.waitForCondition)(async () => {
      try {
        return _support.util.hasValue(avdName) ? !(await this.getRunningAVD(avdName)) : !(await this.isEmulatorConnected());
      } catch (ign) {}
      return false;
    }, {
      waitMs: timeout,
      intervalMs: 2000
    });
  } catch (e) {
    throw new Error(`The emulator '${avdName ? avdName : this.curDeviceId}' is still running after being killed ${timeout}ms ago`);
  }
  _logger.default.info(`Successfully killed the '${avdName ? avdName : this.curDeviceId}' emulator`);
  return true;
};
systemCallMethods.launchAVD = async function launchAVD(avdName, opts = {}) {
  const {
    args = [],
    env = {},
    language,
    country,
    launchTimeout = 60000,
    readyTimeout = 60000,
    retryTimes = 1
  } = opts;
  _logger.default.debug(`Launching Emulator with AVD ${avdName}, launchTimeout ` + `${launchTimeout}ms and readyTimeout ${readyTimeout}ms`);
  const emulatorBinaryPath = await this.getSdkBinaryPath('emulator');
  if (avdName[0] === '@') {
    avdName = avdName.substr(1);
  }
  await this.checkAvdExist(avdName);
  const launchArgs = ['-avd', avdName];
  launchArgs.push(...(0, _helpers.toAvdLocaleArgs)(language, country));
  let isDelayAdbFeatureEnabled = false;
  if (this.allowDelayAdb) {
    const {
      revision
    } = await this.getEmuVersionInfo();
    if (revision && _support.util.compareVersions(revision, '>=', '29.0.7')) {
      try {
        const {
          target
        } = await this.getEmuImageProperties(avdName);
        const apiMatch = /\d+/.exec(target);
        if (apiMatch && parseInt(apiMatch[0], 10) >= MIN_DELAY_ADB_API_LEVEL) {
          launchArgs.push('-delay-adb');
          isDelayAdbFeatureEnabled = true;
        } else {
          throw new Error(`The actual image API version is below ${MIN_DELAY_ADB_API_LEVEL}`);
        }
      } catch (e) {
        _logger.default.info(`The -delay-adb emulator startup detection feature will not be enabled. ` + `Original error: ${e.message}`);
      }
    }
  } else {
    _logger.default.info('The -delay-adb emulator startup detection feature has been explicitly disabled');
  }
  if (!_lodash.default.isEmpty(args)) {
    launchArgs.push(...(_lodash.default.isArray(args) ? args : _support.util.shellParse(`${args}`)));
  }
  _logger.default.debug(`Running '${emulatorBinaryPath}' with args: ${_support.util.quote(launchArgs)}`);
  if (!_lodash.default.isEmpty(env)) {
    _logger.default.debug(`Customized emulator environment: ${JSON.stringify(env)}`);
  }
  const proc = new _teen_process.SubProcess(emulatorBinaryPath, launchArgs, {
    env: Object.assign({}, process.env, env)
  });
  await proc.start(0);
  proc.on('output', (stdout, stderr) => {
    for (let line of (stdout || stderr || '').split('\n').filter(Boolean)) {
      _logger.default.info(`[AVD OUTPUT] ${line}`);
    }
  });
  proc.on('die', (code, signal) => {
    _logger.default.warn(`Emulator avd ${avdName} exited with code ${code}${signal ? `, signal ${signal}` : ''}`);
  });
  await (0, _asyncbox.retry)(retryTimes, async () => await this.getRunningAVDWithRetry(avdName, launchTimeout));
  const timer = new _support.timing.Timer().start();
  if (isDelayAdbFeatureEnabled) {
    try {
      await this.adbExec(['wait-for-device'], {
        timeout: readyTimeout
      });
    } catch (e) {
      throw new Error(`'${avdName}' Emulator has failed to boot: ${e.stderr || e.message}`);
    }
  }
  await this.waitForEmulatorReady(readyTimeout - timer.getDuration().asMilliSeconds);
  return proc;
};
systemCallMethods.getVersion = _lodash.default.memoize(async function getVersion() {
  let stdout;
  try {
    stdout = await this.adbExec('version');
  } catch (e) {
    throw new Error(`Error getting adb version: ${e.stderr || e.message}`);
  }
  const result = {};
  const binaryVersionMatch = BINARY_VERSION_PATTERN.exec(stdout);
  if (binaryVersionMatch) {
    result.binary = {
      version: _semver.default.coerce(binaryVersionMatch[1]),
      build: parseInt(binaryVersionMatch[2], 10)
    };
  }
  const bridgeVersionMatch = BRIDGE_VERSION_PATTERN.exec(stdout);
  if (bridgeVersionMatch) {
    result.bridge = {
      version: _semver.default.coerce(bridgeVersionMatch[1])
    };
  }
  return result;
});
systemCallMethods.waitForEmulatorReady = async function waitForEmulatorReady(timeoutMs = 20000) {
  const requiredServicesRe = REQUIRED_SERVICES.map(name => new RegExp(`\\b${name}:`));
  let services;
  try {
    await (0, _asyncbox.waitForCondition)(async () => {
      try {
        services = await this.shell(['service', 'list']);
        return requiredServicesRe.every(pattern => pattern.test(services));
      } catch (err) {
        _logger.default.debug(`Waiting for emulator startup. Intermediate error: ${err.message}`);
        return false;
      }
    }, {
      waitMs: timeoutMs,
      intervalMs: 3000
    });
  } catch (e) {
    if (services) {
      _logger.default.debug(`Recently listed services:\n${services}`);
    }
    const missingServices = _lodash.default.zip(REQUIRED_SERVICES, requiredServicesRe).filter(([, pattern]) => !pattern.test(services)).map(([name]) => name);
    throw new Error(`Emulator is not ready within ${timeoutMs}ms ` + `(${missingServices} service${missingServices.length === 1 ? ' is' : 's are'} not running)`);
  }
};
systemCallMethods.waitForDevice = async function waitForDevice(appDeviceReadyTimeout = 30) {
  this.appDeviceReadyTimeout = appDeviceReadyTimeout;
  const retries = 3;
  const timeout = parseInt(this.appDeviceReadyTimeout, 10) * 1000 / retries;
  await (0, _asyncbox.retry)(retries, async () => {
    try {
      await this.adbExec('wait-for-device', {
        timeout
      });
      await this.ping();
    } catch (e) {
      try {
        await this.reconnect();
      } catch (ign) {
        await this.restartAdb();
      }
      await this.getConnectedDevices();
      throw new Error(`Error waiting for the device to be available. Original error: '${e.message}'`);
    }
  });
};
systemCallMethods.reboot = async function reboot(retries = DEFAULT_ADB_REBOOT_RETRIES) {
  const {
    wasAlreadyRooted
  } = await this.root();
  try {
    await this.shell(['stop']);
    await _bluebird.default.delay(2000);
    await this.setDeviceProperty('sys.boot_completed', 0, {
      privileged: false
    });
    await this.shell(['start']);
  } catch (e) {
    const {
      message
    } = e;
    if (message.includes('must be root')) {
      throw new Error(`Could not reboot device. Rebooting requires root access and ` + `attempt to get root access on device failed with error: '${message}'`);
    }
    throw e;
  } finally {
    if (!wasAlreadyRooted) {
      await this.unroot();
    }
  }
  const timer = new _support.timing.Timer().start();
  await (0, _asyncbox.retryInterval)(retries, 1000, async () => {
    if ((await this.getDeviceProperty('sys.boot_completed')) === '1') {
      return;
    }
    const msg = `Reboot is not completed after ${timer.getDuration().asMilliSeconds.toFixed(0)}ms`;
    _logger.default.debug(msg);
    throw new Error(msg);
  });
};
systemCallMethods.changeUserPrivileges = async function changeUserPrivileges(isElevated) {
  const cmd = isElevated ? 'root' : 'unroot';
  const retryIfOffline = async cmdFunc => {
    try {
      return await cmdFunc();
    } catch (err) {
      if (['closed', 'device offline', 'timeout expired'].some(x => (err.stderr || '').toLowerCase().includes(x))) {
        _logger.default.warn(`Attempt to ${cmd} caused ADB to think the device went offline`);
        try {
          await this.reconnect();
        } catch (ign) {
          await this.restartAdb();
        }
        return await cmdFunc();
      } else {
        throw err;
      }
    }
  };
  const isRoot = await retryIfOffline(async () => await this.isRoot());
  if (isRoot && isElevated || !isRoot && !isElevated) {
    return {
      isSuccessful: true,
      wasAlreadyRooted: isRoot
    };
  }
  let wasAlreadyRooted = isRoot;
  try {
    const {
      stdout
    } = await retryIfOffline(async () => await this.adbExec([cmd]));
    _logger.default.debug(stdout);
    if (stdout) {
      if (stdout.includes('adbd cannot run as root')) {
        return {
          isSuccessful: false,
          wasAlreadyRooted
        };
      }
      if (stdout.includes('already running as root')) {
        wasAlreadyRooted = true;
      }
    }
    return {
      isSuccessful: true,
      wasAlreadyRooted
    };
  } catch (err) {
    const {
      stderr = '',
      message
    } = err;
    _logger.default.warn(`Unable to ${cmd} adb daemon. Original error: '${message}'. Stderr: '${stderr}'. Continuing.`);
    return {
      isSuccessful: false,
      wasAlreadyRooted
    };
  }
};
systemCallMethods.root = async function root() {
  return await this.changeUserPrivileges(true);
};
systemCallMethods.unroot = async function unroot() {
  return await this.changeUserPrivileges(false);
};
systemCallMethods.isRoot = async function isRoot() {
  return (await this.shell(['whoami'])).trim() === 'root';
};
systemCallMethods.fileExists = async function fileExists(remotePath) {
  const passFlag = '__PASS__';
  const checkCmd = `[ -e '${remotePath.replace(/'/g, `\\'`)}' ] && echo ${passFlag}`;
  try {
    return _lodash.default.includes(await this.shell([checkCmd]), passFlag);
  } catch (ign) {
    return false;
  }
};
systemCallMethods.ls = async function ls(remotePath, opts = []) {
  try {
    let args = ['ls', ...opts, remotePath];
    let stdout = await this.shell(args);
    let lines = stdout.split('\n');
    return lines.map(l => l.trim()).filter(Boolean).filter(l => l.indexOf('No such file') === -1);
  } catch (err) {
    if (err.message.indexOf('No such file or directory') === -1) {
      throw err;
    }
    return [];
  }
};
systemCallMethods.fileSize = async function fileSize(remotePath) {
  try {
    const files = await this.ls(remotePath, ['-la']);
    if (files.length !== 1) {
      throw new Error(`Remote path is not a file`);
    }
    const match = /[rwxsStT\-+]{10}[\s\d]*\s[^\s]+\s+[^\s]+\s+(\d+)/.exec(files[0]);
    if (!match || _lodash.default.isNaN(parseInt(match[1], 10))) {
      throw new Error(`Unable to parse size from list output: '${files[0]}'`);
    }
    return parseInt(match[1], 10);
  } catch (err) {
    throw new Error(`Unable to get file size for '${remotePath}': ${err.message}`);
  }
};
systemCallMethods.installMitmCertificate = async function installMitmCertificate(cert) {
  const openSsl = await (0, _helpers.getOpenSslForOs)();
  if (!_lodash.default.isBuffer(cert)) {
    cert = Buffer.from(cert, 'base64');
  }
  const tmpRoot = await _support.tempDir.openDir();
  try {
    const srcCert = _path.default.resolve(tmpRoot, 'source.cer');
    await _support.fs.writeFile(srcCert, cert);
    let {
      stdout
    } = await (0, _teen_process.exec)(openSsl, ['x509', '-noout', '-hash', '-in', srcCert]);
    const certHash = stdout.trim();
    _logger.default.debug(`Got certificate hash: ${certHash}`);
    _logger.default.debug('Preparing certificate content');
    ({
      stdout
    } = await (0, _teen_process.exec)(openSsl, ['x509', '-in', srcCert], {
      isBuffer: true
    }));
    let dstCertContent = stdout;
    ({
      stdout
    } = await (0, _teen_process.exec)(openSsl, ['x509', '-in', srcCert, '-text', '-fingerprint', '-noout'], {
      isBuffer: true
    }));
    dstCertContent = Buffer.concat([dstCertContent, stdout]);
    const dstCert = _path.default.resolve(tmpRoot, `${certHash}.0`);
    await _support.fs.writeFile(dstCert, dstCertContent);
    _logger.default.debug('Remounting /system in rw mode');
    await (0, _asyncbox.retryInterval)(5, 2000, async () => await this.adbExec(['remount']));
    _logger.default.debug(`Uploading the generated certificate from '${dstCert}' to '${CERTS_ROOT}'`);
    await this.push(dstCert, CERTS_ROOT);
    _logger.default.debug('Remounting /system to confirm changes');
    await this.adbExec(['remount']);
  } catch (err) {
    throw new Error(`Cannot inject the custom certificate. ` + `Is the certificate properly encoded into base64-string? ` + `Do you have root permissions on the device? ` + `Original error: ${err.message}`);
  } finally {
    await _support.fs.rimraf(tmpRoot);
  }
};
systemCallMethods.isMitmCertificateInstalled = async function isMitmCertificateInstalled(cert) {
  const openSsl = await (0, _helpers.getOpenSslForOs)();
  if (!_lodash.default.isBuffer(cert)) {
    cert = Buffer.from(cert, 'base64');
  }
  const tmpRoot = await _support.tempDir.openDir();
  let certHash;
  try {
    const tmpCert = _path.default.resolve(tmpRoot, 'source.cer');
    await _support.fs.writeFile(tmpCert, cert);
    const {
      stdout
    } = await (0, _teen_process.exec)(openSsl, ['x509', '-noout', '-hash', '-in', tmpCert]);
    certHash = stdout.trim();
  } catch (err) {
    throw new Error(`Cannot retrieve the certificate hash. ` + `Is the certificate properly encoded into base64-string? ` + `Original error: ${err.message}`);
  } finally {
    await _support.fs.rimraf(tmpRoot);
  }
  const dstPath = _path.default.posix.resolve(CERTS_ROOT, `${certHash}.0`);
  _logger.default.debug(`Checking if the certificate is already installed at '${dstPath}'`);
  return await this.fileExists(dstPath);
};
var _default = systemCallMethods;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcGF0aCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2xvZ2dlciIsIl9ibHVlYmlyZCIsIl9zdXBwb3J0IiwiX2hlbHBlcnMiLCJfdGVlbl9wcm9jZXNzIiwiX2FzeW5jYm94IiwiX2xvZGFzaCIsIl9zZW12ZXIiLCJzeXN0ZW1DYWxsTWV0aG9kcyIsIkRFRkFVTFRfQURCX1JFQk9PVF9SRVRSSUVTIiwiTElOS0VSX1dBUk5JTkdfUkVHRVhQIiwiQURCX1JFVFJZX0VSUk9SX1BBVFRFUk5TIiwiQklOQVJZX1ZFUlNJT05fUEFUVEVSTiIsIkJSSURHRV9WRVJTSU9OX1BBVFRFUk4iLCJDRVJUU19ST09UIiwiU0RLX0JJTkFSWV9ST09UUyIsIk1JTl9ERUxBWV9BREJfQVBJX0xFVkVMIiwiUkVRVUlSRURfU0VSVklDRVMiLCJnZXRTZGtCaW5hcnlQYXRoIiwiYmluYXJ5TmFtZSIsImdldEJpbmFyeUZyb21TZGtSb290IiwiZ2V0QmluYXJ5TmFtZUZvck9TIiwiXyIsIm1lbW9pemUiLCJnZXRCaW5hcnlOYW1lRm9yT1NNZW1vcml6ZSIsInN5c3RlbSIsImlzV2luZG93cyIsImluY2x1ZGVzIiwicGF0aCIsImV4dG5hbWUiLCJiaW5hcmllcyIsImZ1bGxCaW5hcnlOYW1lIiwiYmluYXJ5TG9jcyIsImdldFNka0JpbmFyeUxvY2F0aW9uQ2FuZGlkYXRlcyIsInNka1Jvb3QiLCJidWlsZFRvb2xzRGlycyIsImdldEJ1aWxkVG9vbHNEaXJzIiwiYnVpbGRUb29sc1ZlcnNpb24iLCJmaWx0ZXIiLCJ4IiwiYmFzZW5hbWUiLCJpc0VtcHR5IiwibG9nIiwiaW5mbyIsInB1c2giLCJmbGF0dGVuIiwibWFwIiwiZGlyIiwicmVzb2x2ZSIsImJpbmFyeUxvYyIsImxvYyIsImZzIiwiZXhpc3RzIiwiaXNOdWxsIiwiRXJyb3IiLCJKU09OIiwic3RyaW5naWZ5IiwiaXNBcnJheSIsImdldEFuZHJvaWRCaW5hcnlQYXRoIiwiZ2V0U2RrUm9vdEZyb21FbnYiLCJnZXRCaW5hcnlGcm9tUGF0aCIsIndoaWNoIiwiZSIsImdldENvbm5lY3RlZERldmljZXMiLCJvcHRzIiwiZGVidWciLCJhcmdzIiwiZXhlY3V0YWJsZSIsImRlZmF1bHRBcmdzIiwidmVyYm9zZSIsInN0ZG91dCIsImV4ZWMiLCJtZXNzYWdlIiwibGlzdEhlYWRlciIsInN0YXJ0aW5nSW5kZXgiLCJpbmRleE9mIiwic2xpY2UiLCJleGNsdWRlZExpbmVzIiwiYWxsb3dPZmZsaW5lRGV2aWNlcyIsImRldmljZXMiLCJzcGxpdCIsInRyaW0iLCJsaW5lIiwic29tZSIsInVkaWQiLCJzdGF0ZSIsImRlc2NyaXB0aW9uIiwiZGV2aWNlIiwiZW50cnkiLCJrZXkiLCJ2YWx1ZSIsImdldERldmljZXNXaXRoUmV0cnkiLCJ0aW1lb3V0TXMiLCJ0aW1lciIsInRpbWluZyIsIlRpbWVyIiwic3RhcnQiLCJnZXREZXZpY2VzIiwiZ2V0RHVyYXRpb24iLCJhc01pbGxpU2Vjb25kcyIsInRvRml4ZWQiLCJsZW5ndGgiLCJpZ24iLCJyZWNvbm5lY3QiLCJyZXN0YXJ0QWRiIiwic2xlZXAiLCJ0YXJnZXQiLCJhZGJFeGVjIiwic3RkZXJyIiwic3VwcHJlc3NLaWxsU2VydmVyIiwia2lsbFNlcnZlciIsImVycm9yIiwiYWRiUG9ydCIsImV4Y2x1c2l2ZSIsInJlc2V0VGVsbmV0QXV0aFRva2VuIiwiaG9tZUZvbGRlclBhdGgiLCJwcm9jZXNzIiwiZW52IiwicGxhdGZvcm0iLCJ3YXJuIiwiZHN0UGF0aCIsIndyaXRlRmlsZSIsImFkYkV4ZWNFbXUiLCJjbWQiLCJ2ZXJpZnlFbXVsYXRvckNvbm5lY3RlZCIsImlzRXhlY0xvY2tlZCIsIkVYRUNfT1VUUFVUX0ZPUk1BVCIsIk9iamVjdCIsImZyZWV6ZSIsIlNURE9VVCIsIkZVTEwiLCJjbG9uZURlZXAiLCJ0aW1lb3V0IiwiYWRiRXhlY1RpbWVvdXQiLCJERUZBVUxUX0FEQl9FWEVDX1RJTUVPVVQiLCJ0aW1lb3V0Q2FwTmFtZSIsIm91dHB1dEZvcm1hdCIsImFkYlJldHJpZWQiLCJleGVjRnVuYyIsImZpbmQiLCJhcmciLCJ0ZXN0IiwidXRpbCIsInF1b3RlIiwiam9pbiIsInJlcGxhY2UiLCJlcnJUZXh0IiwicCIsImNvZGUiLCJ3YWl0Rm9yQ29uZGl0aW9uIiwid2FpdE1zIiwiTnVtYmVyIiwiTUFYX1NBRkVfSU5URUdFUiIsImludGVydmFsTXMiLCJzaGVsbCIsInByaXZpbGVnZWQiLCJjbWRBcnIiLCJmdWxsQ21kIiwiaXNSb290IiwiY3JlYXRlU3ViUHJvY2VzcyIsIlN1YlByb2Nlc3MiLCJnZXRBZGJQYXRoIiwiZ2V0QWRiU2VydmVyUG9ydCIsImdldEVtdWxhdG9yUG9ydCIsImVtdWxhdG9yUG9ydCIsInBvcnQiLCJnZXRQb3J0RnJvbUVtdWxhdG9yU3RyaW5nIiwiZW1TdHIiLCJwb3J0UGF0dGVybiIsInBhcnNlSW50IiwiZ2V0Q29ubmVjdGVkRW11bGF0b3JzIiwiZW11bGF0b3JzIiwicGx1cmFsaXplIiwic2V0RW11bGF0b3JQb3J0IiwiZW1Qb3J0Iiwic2V0RGV2aWNlSWQiLCJkZXZpY2VJZCIsImN1ckRldmljZUlkIiwiYXJnc0hhc0RldmljZSIsInNwbGljZSIsInNldERldmljZSIsImRldmljZU9iaiIsImdldFJ1bm5pbmdBVkQiLCJhdmROYW1lIiwiZW11bGF0b3IiLCJydW5uaW5nQVZETmFtZSIsImV4ZWNFbXVDb25zb2xlQ29tbWFuZCIsImV4ZWNUaW1lb3V0IiwiY29ublRpbWVvdXQiLCJ0b0xvd2VyIiwiZ2V0UnVubmluZ0FWRFdpdGhSZXRyeSIsImtpbGxBbGxFbXVsYXRvcnMiLCJraWxsRW11bGF0b3IiLCJoYXNWYWx1ZSIsImlzRW11bGF0b3JDb25uZWN0ZWQiLCJsYXVuY2hBVkQiLCJsYW5ndWFnZSIsImNvdW50cnkiLCJsYXVuY2hUaW1lb3V0IiwicmVhZHlUaW1lb3V0IiwicmV0cnlUaW1lcyIsImVtdWxhdG9yQmluYXJ5UGF0aCIsInN1YnN0ciIsImNoZWNrQXZkRXhpc3QiLCJsYXVuY2hBcmdzIiwidG9BdmRMb2NhbGVBcmdzIiwiaXNEZWxheUFkYkZlYXR1cmVFbmFibGVkIiwiYWxsb3dEZWxheUFkYiIsInJldmlzaW9uIiwiZ2V0RW11VmVyc2lvbkluZm8iLCJjb21wYXJlVmVyc2lvbnMiLCJnZXRFbXVJbWFnZVByb3BlcnRpZXMiLCJhcGlNYXRjaCIsInNoZWxsUGFyc2UiLCJwcm9jIiwiYXNzaWduIiwib24iLCJCb29sZWFuIiwic2lnbmFsIiwicmV0cnkiLCJ3YWl0Rm9yRW11bGF0b3JSZWFkeSIsImdldFZlcnNpb24iLCJyZXN1bHQiLCJiaW5hcnlWZXJzaW9uTWF0Y2giLCJiaW5hcnkiLCJ2ZXJzaW9uIiwic2VtdmVyIiwiY29lcmNlIiwiYnVpbGQiLCJicmlkZ2VWZXJzaW9uTWF0Y2giLCJicmlkZ2UiLCJyZXF1aXJlZFNlcnZpY2VzUmUiLCJuYW1lIiwiUmVnRXhwIiwic2VydmljZXMiLCJldmVyeSIsInBhdHRlcm4iLCJlcnIiLCJtaXNzaW5nU2VydmljZXMiLCJ6aXAiLCJ3YWl0Rm9yRGV2aWNlIiwiYXBwRGV2aWNlUmVhZHlUaW1lb3V0IiwicmV0cmllcyIsInBpbmciLCJyZWJvb3QiLCJ3YXNBbHJlYWR5Um9vdGVkIiwicm9vdCIsIkIiLCJkZWxheSIsInNldERldmljZVByb3BlcnR5IiwidW5yb290IiwicmV0cnlJbnRlcnZhbCIsImdldERldmljZVByb3BlcnR5IiwibXNnIiwiY2hhbmdlVXNlclByaXZpbGVnZXMiLCJpc0VsZXZhdGVkIiwicmV0cnlJZk9mZmxpbmUiLCJjbWRGdW5jIiwidG9Mb3dlckNhc2UiLCJpc1N1Y2Nlc3NmdWwiLCJmaWxlRXhpc3RzIiwicmVtb3RlUGF0aCIsInBhc3NGbGFnIiwiY2hlY2tDbWQiLCJscyIsImxpbmVzIiwibCIsImZpbGVTaXplIiwiZmlsZXMiLCJtYXRjaCIsImlzTmFOIiwiaW5zdGFsbE1pdG1DZXJ0aWZpY2F0ZSIsImNlcnQiLCJvcGVuU3NsIiwiZ2V0T3BlblNzbEZvck9zIiwiaXNCdWZmZXIiLCJCdWZmZXIiLCJmcm9tIiwidG1wUm9vdCIsInRlbXBEaXIiLCJvcGVuRGlyIiwic3JjQ2VydCIsImNlcnRIYXNoIiwiZHN0Q2VydENvbnRlbnQiLCJjb25jYXQiLCJkc3RDZXJ0IiwicmltcmFmIiwiaXNNaXRtQ2VydGlmaWNhdGVJbnN0YWxsZWQiLCJ0bXBDZXJ0IiwicG9zaXgiLCJfZGVmYXVsdCIsImV4cG9ydHMiLCJkZWZhdWx0Il0sInNvdXJjZXMiOlsiLi4vLi4vLi4vbGliL3Rvb2xzL3N5c3RlbS1jYWxscy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCBsb2cgZnJvbSAnLi4vbG9nZ2VyLmpzJztcbmltcG9ydCBCIGZyb20gJ2JsdWViaXJkJztcbmltcG9ydCB7IHN5c3RlbSwgZnMsIHV0aWwsIHRlbXBEaXIsIHRpbWluZyB9IGZyb20gJ0BhcHBpdW0vc3VwcG9ydCc7XG5pbXBvcnQge1xuICBnZXRCdWlsZFRvb2xzRGlycywgdG9BdmRMb2NhbGVBcmdzLFxuICBnZXRPcGVuU3NsRm9yT3MsIERFRkFVTFRfQURCX0VYRUNfVElNRU9VVCwgZ2V0U2RrUm9vdEZyb21FbnZcbn0gZnJvbSAnLi4vaGVscGVycyc7XG5pbXBvcnQgeyBleGVjLCBTdWJQcm9jZXNzIH0gZnJvbSAndGVlbl9wcm9jZXNzJztcbmltcG9ydCB7IHNsZWVwLCByZXRyeSwgcmV0cnlJbnRlcnZhbCwgd2FpdEZvckNvbmRpdGlvbiB9IGZyb20gJ2FzeW5jYm94JztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgc2VtdmVyIGZyb20gJ3NlbXZlcic7XG5cblxubGV0IHN5c3RlbUNhbGxNZXRob2RzID0ge307XG5cbmNvbnN0IERFRkFVTFRfQURCX1JFQk9PVF9SRVRSSUVTID0gOTA7XG5jb25zdCBMSU5LRVJfV0FSTklOR19SRUdFWFAgPSAvXldBUk5JTkc6IGxpbmtlci4rJC9tO1xuY29uc3QgQURCX1JFVFJZX0VSUk9SX1BBVFRFUk5TID0gW1xuICAvcHJvdG9jb2wgZmF1bHQgXFwobm8gc3RhdHVzXFwpL2ksXG4gIC9lcnJvcjogZGV2aWNlICgnLisnICk/bm90IGZvdW5kL2ksXG4gIC9lcnJvcjogZGV2aWNlIHN0aWxsIGNvbm5lY3RpbmcvaSxcbl07XG5jb25zdCBCSU5BUllfVkVSU0lPTl9QQVRURVJOID0gL15WZXJzaW9uIChbXFxkLl0rKS0oXFxkKykvbTtcbmNvbnN0IEJSSURHRV9WRVJTSU9OX1BBVFRFUk4gPSAvXkFuZHJvaWQgRGVidWcgQnJpZGdlIHZlcnNpb24gKFtcXGQuXSspL207XG5jb25zdCBDRVJUU19ST09UID0gJy9zeXN0ZW0vZXRjL3NlY3VyaXR5L2NhY2VydHMnO1xuY29uc3QgU0RLX0JJTkFSWV9ST09UUyA9IFtcbiAgJ3BsYXRmb3JtLXRvb2xzJyxcbiAgJ2VtdWxhdG9yJyxcbiAgWydjbWRsaW5lLXRvb2xzJywgJ2xhdGVzdCcsICdiaW4nXSxcbiAgJ3Rvb2xzJyxcbiAgWyd0b29scycsICdiaW4nXSxcbiAgJy4nIC8vIEFsbG93IGN1c3RvbSBzZGtSb290IHRvIHNwZWNpZnkgZnVsbCBmb2xkZXIgcGF0aFxuXTtcbmNvbnN0IE1JTl9ERUxBWV9BREJfQVBJX0xFVkVMID0gMjg7XG5jb25zdCBSRVFVSVJFRF9TRVJWSUNFUyA9IFsnYWN0aXZpdHknLCAncGFja2FnZScsICdtb3VudCddO1xuXG4vKipcbiAqIFJldHJpZXZlIGZ1bGwgcGF0aCB0byB0aGUgZ2l2ZW4gYmluYXJ5LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBiaW5hcnlOYW1lIC0gVGhlIG5hbWUgb2YgdGhlIGJpbmFyeS5cbiAqIEByZXR1cm4ge3N0cmluZ30gRnVsbCBwYXRoIHRvIHRoZSBnaXZlbiBiaW5hcnkgaW5jbHVkaW5nIGN1cnJlbnQgU0RLIHJvb3QuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmdldFNka0JpbmFyeVBhdGggPSBhc3luYyBmdW5jdGlvbiBnZXRTZGtCaW5hcnlQYXRoIChiaW5hcnlOYW1lKSB7XG4gIHJldHVybiBhd2FpdCB0aGlzLmdldEJpbmFyeUZyb21TZGtSb290KGJpbmFyeU5hbWUpO1xufTtcblxuLyoqXG4gKiBSZXRyaWV2ZSBmdWxsIGJpbmFyeSBuYW1lIGZvciB0aGUgY3VycmVudCBvcGVyYXRpbmcgc3lzdGVtIGFzIG1lbW90aXplLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBiaW5hcnlOYW1lIC0gc2ltcGxlIGJpbmFyeSBuYW1lLCBmb3IgZXhhbXBsZSAnYW5kcm9pZCcuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IEZvcm1hdHRlZCBiaW5hcnkgbmFtZSBkZXBlbmRpbmcgb24gdGhlIGN1cnJlbnQgcGxhdGZvcm0sXG4gKiAgICAgICAgICAgICAgICAgIGZvciBleGFtcGxlLCAnYW5kcm9pZC5iYXQnIG9uIFdpbmRvd3MuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmdldEJpbmFyeU5hbWVGb3JPUyA9IF8ubWVtb2l6ZShmdW5jdGlvbiBnZXRCaW5hcnlOYW1lRm9yT1NNZW1vcml6ZSAoYmluYXJ5TmFtZSkge1xuICByZXR1cm4gZ2V0QmluYXJ5TmFtZUZvck9TKGJpbmFyeU5hbWUpO1xufSk7XG5cbi8qKlxuICogUmV0cmlldmUgZnVsbCBiaW5hcnkgbmFtZSBmb3IgdGhlIGN1cnJlbnQgb3BlcmF0aW5nIHN5c3RlbS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYmluYXJ5TmFtZSAtIHNpbXBsZSBiaW5hcnkgbmFtZSwgZm9yIGV4YW1wbGUgJ2FuZHJvaWQnLlxuICogQHJldHVybiB7c3RyaW5nfSBGb3JtYXR0ZWQgYmluYXJ5IG5hbWUgZGVwZW5kaW5nIG9uIHRoZSBjdXJyZW50IHBsYXRmb3JtLFxuICogICAgICAgICAgICAgICAgICBmb3IgZXhhbXBsZSwgJ2FuZHJvaWQuYmF0JyBvbiBXaW5kb3dzLlxuICovXG5mdW5jdGlvbiBnZXRCaW5hcnlOYW1lRm9yT1MgKGJpbmFyeU5hbWUpIHtcbiAgaWYgKCFzeXN0ZW0uaXNXaW5kb3dzKCkpIHtcbiAgICByZXR1cm4gYmluYXJ5TmFtZTtcbiAgfVxuXG4gIGlmIChbJ2FuZHJvaWQnLCAnYXBrc2lnbmVyJywgJ2Fwa2FuYWx5emVyJ10uaW5jbHVkZXMoYmluYXJ5TmFtZSkpIHtcbiAgICByZXR1cm4gYCR7YmluYXJ5TmFtZX0uYmF0YDtcbiAgfVxuICBpZiAoIXBhdGguZXh0bmFtZShiaW5hcnlOYW1lKSkge1xuICAgIHJldHVybiBgJHtiaW5hcnlOYW1lfS5leGVgO1xuICB9XG4gIHJldHVybiBiaW5hcnlOYW1lO1xufVxuXG4vKipcbiAqIFJldHJpZXZlIGZ1bGwgcGF0aCB0byB0aGUgZ2l2ZW4gYmluYXJ5IGFuZCBjYWNoZXMgaXQgaW50byBgYmluYXJpZXNgXG4gKiBwcm9wZXJ0eSBvZiB0aGUgY3VycmVudCBBREIgaW5zdGFuY2UuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGJpbmFyeU5hbWUgLSBTaW1wbGUgbmFtZSBvZiBhIGJpbmFyeSBmaWxlLlxuICogQHJldHVybiB7c3RyaW5nfSBGdWxsIHBhdGggdG8gdGhlIGdpdmVuIGJpbmFyeS4gVGhlIG1ldGhvZCB0cmllc1xuICogICAgICAgICAgICAgICAgICB0byBlbnVtZXJhdGUgYWxsIHRoZSBrbm93biBsb2NhdGlvbnMgd2hlcmUgdGhlIGJpbmFyeVxuICogICAgICAgICAgICAgICAgICBtaWdodCBiZSBsb2NhdGVkIGFuZCBzdG9wcyB0aGUgc2VhcmNoIGFzIHNvb24gYXMgdGhlIGZpcnN0XG4gKiAgICAgICAgICAgICAgICAgIG1hdGNoIGlzIGZvdW5kIG9uIHRoZSBsb2NhbCBmaWxlIHN5c3RlbS5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgYmluYXJ5IHdpdGggZ2l2ZW4gbmFtZSBpcyBub3QgcHJlc2VudCBhdCBhbnlcbiAqICAgICAgICAgICAgICAgICBvZiBrbm93biBsb2NhdGlvbnMgb3IgQW5kcm9pZCBTREsgaXMgbm90IGluc3RhbGxlZCBvbiB0aGVcbiAqICAgICAgICAgICAgICAgICBsb2NhbCBmaWxlIHN5c3RlbS5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMuZ2V0QmluYXJ5RnJvbVNka1Jvb3QgPSBhc3luYyBmdW5jdGlvbiBnZXRCaW5hcnlGcm9tU2RrUm9vdCAoYmluYXJ5TmFtZSkge1xuICBpZiAodGhpcy5iaW5hcmllc1tiaW5hcnlOYW1lXSkge1xuICAgIHJldHVybiB0aGlzLmJpbmFyaWVzW2JpbmFyeU5hbWVdO1xuICB9XG4gIGNvbnN0IGZ1bGxCaW5hcnlOYW1lID0gdGhpcy5nZXRCaW5hcnlOYW1lRm9yT1MoYmluYXJ5TmFtZSk7XG4gIGNvbnN0IGJpbmFyeUxvY3MgPSBnZXRTZGtCaW5hcnlMb2NhdGlvbkNhbmRpZGF0ZXModGhpcy5zZGtSb290LCBmdWxsQmluYXJ5TmFtZSk7XG5cbiAgLy8gZ2V0IHN1YnBhdGhzIGZvciBjdXJyZW50bHkgaW5zdGFsbGVkIGJ1aWxkIHRvb2wgZGlyZWN0b3JpZXNcbiAgbGV0IGJ1aWxkVG9vbHNEaXJzID0gYXdhaXQgZ2V0QnVpbGRUb29sc0RpcnModGhpcy5zZGtSb290KTtcbiAgaWYgKHRoaXMuYnVpbGRUb29sc1ZlcnNpb24pIHtcbiAgICBidWlsZFRvb2xzRGlycyA9IGJ1aWxkVG9vbHNEaXJzXG4gICAgICAuZmlsdGVyKCh4KSA9PiBwYXRoLmJhc2VuYW1lKHgpID09PSB0aGlzLmJ1aWxkVG9vbHNWZXJzaW9uKTtcbiAgICBpZiAoXy5pc0VtcHR5KGJ1aWxkVG9vbHNEaXJzKSkge1xuICAgICAgbG9nLmluZm8oYEZvdW5kIG5vIGJ1aWxkIHRvb2xzIHdob3NlIHZlcnNpb24gbWF0Y2hlcyB0byAnJHt0aGlzLmJ1aWxkVG9vbHNWZXJzaW9ufSdgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbG9nLmluZm8oYFVzaW5nIGJ1aWxkIHRvb2xzIGF0ICcke2J1aWxkVG9vbHNEaXJzfSdgKTtcbiAgICB9XG4gIH1cbiAgYmluYXJ5TG9jcy5wdXNoKC4uLihfLmZsYXR0ZW4oYnVpbGRUb29sc0RpcnNcbiAgICAubWFwKChkaXIpID0+IFtcbiAgICAgIHBhdGgucmVzb2x2ZShkaXIsIGZ1bGxCaW5hcnlOYW1lKSxcbiAgICAgIHBhdGgucmVzb2x2ZShkaXIsICdsaWInLCBmdWxsQmluYXJ5TmFtZSksXG4gICAgXSkpXG4gICkpO1xuXG4gIGxldCBiaW5hcnlMb2MgPSBudWxsO1xuICBmb3IgKGNvbnN0IGxvYyBvZiBiaW5hcnlMb2NzKSB7XG4gICAgaWYgKGF3YWl0IGZzLmV4aXN0cyhsb2MpKSB7XG4gICAgICBiaW5hcnlMb2MgPSBsb2M7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cbiAgaWYgKF8uaXNOdWxsKGJpbmFyeUxvYykpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCBmaW5kICcke2Z1bGxCaW5hcnlOYW1lfScgaW4gJHtKU09OLnN0cmluZ2lmeShiaW5hcnlMb2NzKX0uIGAgK1xuICAgICAgYERvIHlvdSBoYXZlIEFuZHJvaWQgQnVpbGQgVG9vbHMgJHt0aGlzLmJ1aWxkVG9vbHNWZXJzaW9uID8gYHYgJHt0aGlzLmJ1aWxkVG9vbHNWZXJzaW9ufSBgIDogJyd9YCArXG4gICAgICBgaW5zdGFsbGVkIGF0ICcke3RoaXMuc2RrUm9vdH0nP2ApO1xuICB9XG4gIGxvZy5pbmZvKGBVc2luZyAnJHtmdWxsQmluYXJ5TmFtZX0nIGZyb20gJyR7YmluYXJ5TG9jfSdgKTtcbiAgdGhpcy5iaW5hcmllc1tiaW5hcnlOYW1lXSA9IGJpbmFyeUxvYztcbiAgcmV0dXJuIGJpbmFyeUxvYztcbn07XG5cbi8qKlxuICogIFJldHVybnMgdGhlIEFuZHJvaWQgYmluYXJpZXMgbG9jYXRpb25zXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHNka1Jvb3QgVGhlIHBhdGggdG8gQW5kcm9pZCBTREsgcm9vdC5cbiAqIEBwYXJhbSB7c3RyaW5nfSBmdWxsQmluYXJ5TmFtZSBUaGUgbmFtZSBvZiBmdWxsIGJpbmFyeSBuYW1lLlxuICogQHJldHVybiB7QXJyYXk8c3RyaW5nPn0gVGhlIGxpc3Qgb2YgU0RLX0JJTkFSWV9ST09UUyBwYXRoc1xuICogICAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggc2RrUm9vdCBhbmQgZnVsbEJpbmFyeU5hbWUuXG4gKi9cbmZ1bmN0aW9uIGdldFNka0JpbmFyeUxvY2F0aW9uQ2FuZGlkYXRlcyAoc2RrUm9vdCwgZnVsbEJpbmFyeU5hbWUpIHtcbiAgcmV0dXJuIFNES19CSU5BUllfUk9PVFMubWFwKCh4KSA9PlxuICAgIHBhdGgucmVzb2x2ZShzZGtSb290LCAuLi4oXy5pc0FycmF5KHgpID8geCA6IFt4XSksIGZ1bGxCaW5hcnlOYW1lKSk7XG59XG5cbi8qKlxuICogUmV0cmlldmUgZnVsbCBwYXRoIHRvIHRoZSBnaXZlbiBiaW5hcnkuXG4gKiBUaGlzIG1ldGhvZCBkb2VzIG5vdCBoYXZlIGNhY2hlLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBiaW5hcnlOYW1lIC0gU2ltcGxlIG5hbWUgb2YgYSBiaW5hcnkgZmlsZS5cbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5nLiAnYWRiJywgJ2FuZHJvaWQnXG4gKiBAcmV0dXJuIHtzdHJpbmd9IEZ1bGwgcGF0aCB0byB0aGUgZ2l2ZW4gYmluYXJ5LiBUaGUgbWV0aG9kIHRyaWVzXG4gKiAgICAgICAgICAgICAgICAgIHRvIGVudW1lcmF0ZSBhbGwgdGhlIGtub3duIGxvY2F0aW9ucyB3aGVyZSB0aGUgYmluYXJ5XG4gKiAgICAgICAgICAgICAgICAgIG1pZ2h0IGJlIGxvY2F0ZWQgYW5kIHN0b3BzIHRoZSBzZWFyY2ggYXMgc29vbiBhcyB0aGUgZmlyc3RcbiAqICAgICAgICAgICAgICAgICAgbWF0Y2ggaXMgZm91bmQgb24gdGhlIGxvY2FsIGZpbGUgc3lzdGVtLlxuICogICAgICAgICAgICAgICAgICBlLmcuICcvUGF0aC9Uby9BbmRyb2lkL3Nkay9wbGF0Zm9ybS10b29scy9hZGInXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGJpbmFyeSB3aXRoIGdpdmVuIG5hbWUgaXMgbm90IHByZXNlbnQgYXQgYW55XG4gKiAgICAgICAgICAgICAgICAgb2Yga25vd24gbG9jYXRpb25zIG9yIEFuZHJvaWQgU0RLIGlzIG5vdCBpbnN0YWxsZWQgb24gdGhlXG4gKiAgICAgICAgICAgICAgICAgbG9jYWwgZmlsZSBzeXN0ZW0uXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldEFuZHJvaWRCaW5hcnlQYXRoIChiaW5hcnlOYW1lKSB7XG4gIGNvbnN0IGZ1bGxCaW5hcnlOYW1lID0gZ2V0QmluYXJ5TmFtZUZvck9TKGJpbmFyeU5hbWUpO1xuICBjb25zdCBzZGtSb290ID0gZ2V0U2RrUm9vdEZyb21FbnYoKTtcbiAgY29uc3QgYmluYXJ5TG9jcyA9IGdldFNka0JpbmFyeUxvY2F0aW9uQ2FuZGlkYXRlcyhzZGtSb290LCBmdWxsQmluYXJ5TmFtZSk7XG4gIGZvciAoY29uc3QgbG9jIG9mIGJpbmFyeUxvY3MpIHtcbiAgICBpZiAoYXdhaXQgZnMuZXhpc3RzKGxvYykpIHtcbiAgICAgIHJldHVybiBsb2M7XG4gICAgfVxuICB9XG4gIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgJyR7ZnVsbEJpbmFyeU5hbWV9JyBpbiAke0pTT04uc3RyaW5naWZ5KGJpbmFyeUxvY3MpfS4gYCArXG4gICAgYERvIHlvdSBoYXZlIEFuZHJvaWQgQnVpbGQgVG9vbHMgaW5zdGFsbGVkIGF0ICcke3Nka1Jvb3R9Jz9gKTtcbn1cblxuLyoqXG4gKiBSZXRyaWV2ZSBmdWxsIHBhdGggdG8gYSBiaW5hcnkgZmlsZSB1c2luZyB0aGUgc3RhbmRhcmQgc3lzdGVtIGxvb2t1cCB0b29sLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBiaW5hcnlOYW1lIC0gVGhlIG5hbWUgb2YgdGhlIGJpbmFyeS5cbiAqIEByZXR1cm4ge3N0cmluZ30gRnVsbCBwYXRoIHRvIHRoZSBiaW5hcnkgcmVjZWl2ZWQgZnJvbSAnd2hpY2gnLyd3aGVyZSdcbiAqICAgICAgICAgICAgICAgICAgb3V0cHV0LlxuICogQHRocm93cyB7RXJyb3J9IElmIGxvb2t1cCB0b29sIHJldHVybnMgbm9uLXplcm8gcmV0dXJuIGNvZGUuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmdldEJpbmFyeUZyb21QYXRoID0gYXN5bmMgZnVuY3Rpb24gZ2V0QmluYXJ5RnJvbVBhdGggKGJpbmFyeU5hbWUpIHtcbiAgaWYgKHRoaXMuYmluYXJpZXNbYmluYXJ5TmFtZV0pIHtcbiAgICByZXR1cm4gdGhpcy5iaW5hcmllc1tiaW5hcnlOYW1lXTtcbiAgfVxuXG4gIGNvbnN0IGZ1bGxCaW5hcnlOYW1lID0gdGhpcy5nZXRCaW5hcnlOYW1lRm9yT1MoYmluYXJ5TmFtZSk7XG4gIHRyeSB7XG4gICAgY29uc3QgYmluYXJ5TG9jID0gYXdhaXQgZnMud2hpY2goZnVsbEJpbmFyeU5hbWUpO1xuICAgIGxvZy5pbmZvKGBVc2luZyAnJHtmdWxsQmluYXJ5TmFtZX0nIGZyb20gJyR7YmluYXJ5TG9jfSdgKTtcbiAgICB0aGlzLmJpbmFyaWVzW2JpbmFyeU5hbWVdID0gYmluYXJ5TG9jO1xuICAgIHJldHVybiBiaW5hcnlMb2M7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCBmaW5kICcke2Z1bGxCaW5hcnlOYW1lfScgaW4gUEFUSC4gUGxlYXNlIHNldCB0aGUgQU5EUk9JRF9IT01FIGAgK1xuICAgICAgYG9yIEFORFJPSURfU0RLX1JPT1QgZW52aXJvbm1lbnQgdmFyaWFibGVzIHRvIHRoZSBjb3JyZWN0IEFuZHJvaWQgU0RLIHJvb3QgZGlyZWN0b3J5IHBhdGguYCk7XG4gIH1cbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gQ29ubmVjdGVkRGV2aWNlc09wdGlvbnNcbiAqIEBwcm9wZXJ0eSB7P2Jvb2xlYW59IHZlcmJvc2UgLSBXaGV0aGVyIHRvIGdldCBsb25nIG91dHB1dCwgd2hpY2ggaW5jbHVkZXMgZXh0cmEgcHJvcGVydGllcyBpbiBlYWNoIGRldmljZS5cbiAqIEFraW4gdG8gcnVubmluZyBgYWRiIGRldmljZXMgLWxgLlxuICovXG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gRGV2aWNlXG4gKiBAcHJvcGVydHkge3N0cmluZ30gdWRpZCAtIFRoZSBkZXZpY2UgdWRpZC5cbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBzdGF0ZSAtIEN1cnJlbnQgZGV2aWNlIHN0YXRlLCBhcyBpdCBpcyB2aXNpYmxlIGluXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYWRiIGRldmljZXMgLWxfIG91dHB1dC5cbiAqL1xuXG4vKipcbiAqIEB0eXBlZGVmIHtEZXZpY2V9IFZlcmJvc2VEZXZpY2UgQWRkaXRpb25hbCBwcm9wZXJ0aWVzIHJldHVybmVkIHdoZW4gYHZlcmJvc2VgIGlzIHRydWUuXG4gKiBAcHJvcGVydHkge3N0cmluZ30gcHJvZHVjdCAtIFRoZSBwcm9kdWN0IGNvZGVuYW1lIG9mIHRoZSBkZXZpY2UsIHN1Y2ggYXMgXCJyYXpvclwiLlxuICogQHByb3BlcnR5IHtzdHJpbmd9IG1vZGVsIC0gVGhlIG1vZGVsIG5hbWUgb2YgdGhlIGRldmljZSwgc3VjaCBhcyBcIk5leHVzXzdcIi5cbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkZXZpY2UgLSBUaGUgZGV2aWNlIGNvZGVuYW1lLCBzdWNoIGFzIFwiZmxvd1wiLlxuICogQHByb3BlcnR5IHs/c3RyaW5nfSB1c2IgLSBSZXByZXNlbnRzIHRoZSBVU0IgcG9ydCB0aGUgZGV2aWNlIGlzIGNvbm5lY3RlZCB0bywgc3VjaCBhcyBcIjEtMVwiLlxuICogQHByb3BlcnR5IHs/c3RyaW5nfSB0cmFuc3BvcnRfaWQgLSBUaGUgVHJhbnNwb3J0IElEIGZvciB0aGUgZGV2aWNlLCBzdWNoIGFzIFwiMVwiLlxuICovXG5cbi8qKlxuICogUmV0cmlldmUgdGhlIGxpc3Qgb2YgZGV2aWNlcyB2aXNpYmxlIHRvIGFkYi5cbiAqXG4gKiBAcGFyYW0gez9Db25uZWN0ZWREZXZpY2VzT3B0aW9uc30gb3B0cyBbe31dIC0gQWRkaXRpb25hbCBvcHRpb25zIG1hcHBpbmcuXG4gKiBAcmV0dXJuIHtBcnJheS48RGV2aWNlPn0gVGhlIGxpc3Qgb2YgZGV2aWNlcyBvciBhbiBlbXB0eSBsaXN0IGlmXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgbm8gZGV2aWNlcyBhcmUgY29ubmVjdGVkLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZXJlIHdhcyBhbiBlcnJvciB3aGlsZSBsaXN0aW5nIGRldmljZXMuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmdldENvbm5lY3RlZERldmljZXMgPSBhc3luYyBmdW5jdGlvbiBnZXRDb25uZWN0ZWREZXZpY2VzIChvcHRzID0ge30pIHtcbiAgbG9nLmRlYnVnKCdHZXR0aW5nIGNvbm5lY3RlZCBkZXZpY2VzJyk7XG4gIGNvbnN0IGFyZ3MgPSBbLi4udGhpcy5leGVjdXRhYmxlLmRlZmF1bHRBcmdzLCAnZGV2aWNlcyddO1xuICBpZiAob3B0cy52ZXJib3NlKSB7XG4gICAgYXJncy5wdXNoKCctbCcpO1xuICB9XG5cbiAgbGV0IHN0ZG91dDtcbiAgdHJ5IHtcbiAgICAoe3N0ZG91dH0gPSBhd2FpdCBleGVjKHRoaXMuZXhlY3V0YWJsZS5wYXRoLCBhcmdzKSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIHdoaWxlIGdldHRpbmcgY29ubmVjdGVkIGRldmljZXMuIE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgfVxuICBjb25zdCBsaXN0SGVhZGVyID0gJ0xpc3Qgb2YgZGV2aWNlcyc7XG4gIC8vIGV4cGVjdGluZyBhZGIgZGV2aWNlcyB0byByZXR1cm4gb3V0cHV0IGFzXG4gIC8vIExpc3Qgb2YgZGV2aWNlcyBhdHRhY2hlZFxuICAvLyBlbXVsYXRvci01NTU0XHRkZXZpY2VcbiAgY29uc3Qgc3RhcnRpbmdJbmRleCA9IHN0ZG91dC5pbmRleE9mKGxpc3RIZWFkZXIpO1xuICBpZiAoc3RhcnRpbmdJbmRleCA8IDApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgb3V0cHV0IHdoaWxlIHRyeWluZyB0byBnZXQgZGV2aWNlczogJHtzdGRvdXR9YCk7XG4gIH1cbiAgLy8gc2xpY2luZyBvdXRwdXQgd2UgY2FyZSBhYm91dFxuICBzdGRvdXQgPSBzdGRvdXQuc2xpY2Uoc3RhcnRpbmdJbmRleCk7XG4gIGxldCBleGNsdWRlZExpbmVzID0gW2xpc3RIZWFkZXIsICdhZGIgc2VydmVyJywgJyogZGFlbW9uJ107XG4gIGlmICghdGhpcy5hbGxvd09mZmxpbmVEZXZpY2VzKSB7XG4gICAgZXhjbHVkZWRMaW5lcy5wdXNoKCdvZmZsaW5lJyk7XG4gIH1cbiAgY29uc3QgZGV2aWNlcyA9IHN0ZG91dC5zcGxpdCgnXFxuJylcbiAgICAubWFwKF8udHJpbSlcbiAgICAuZmlsdGVyKChsaW5lKSA9PiBsaW5lICYmICFleGNsdWRlZExpbmVzLnNvbWUoKHgpID0+IGxpbmUuaW5jbHVkZXMoeCkpKVxuICAgIC5tYXAoKGxpbmUpID0+IHtcbiAgICAgIC8vIHN0YXRlIGlzIFwiZGV2aWNlXCIsIGFmYWljXG4gICAgICBjb25zdCBbdWRpZCwgc3RhdGUsIC4uLmRlc2NyaXB0aW9uXSA9IGxpbmUuc3BsaXQoL1xccysvKTtcbiAgICAgIGNvbnN0IGRldmljZSA9IHt1ZGlkLCBzdGF0ZX07XG4gICAgICBpZiAob3B0cy52ZXJib3NlKSB7XG4gICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgZGVzY3JpcHRpb24pIHtcbiAgICAgICAgICBpZiAoZW50cnkuaW5jbHVkZXMoJzonKSkge1xuICAgICAgICAgICAgLy8gZWFjaCBlbnRyeSBsb29rcyBsaWtlIGtleTp2YWx1ZVxuICAgICAgICAgICAgY29uc3QgW2tleSwgdmFsdWVdID0gZW50cnkuc3BsaXQoJzonKTtcbiAgICAgICAgICAgIGRldmljZVtrZXldID0gdmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZGV2aWNlO1xuICAgIH0pO1xuICBpZiAoXy5pc0VtcHR5KGRldmljZXMpKSB7XG4gICAgbG9nLmRlYnVnKCdObyBjb25uZWN0ZWQgZGV2aWNlcyBoYXZlIGJlZW4gZGV0ZWN0ZWQnKTtcbiAgfSBlbHNlIHtcbiAgICBsb2cuZGVidWcoYENvbm5lY3RlZCBkZXZpY2VzOiAke0pTT04uc3RyaW5naWZ5KGRldmljZXMpfWApO1xuICB9XG4gIHJldHVybiBkZXZpY2VzO1xufTtcblxuLyoqXG4gKiBSZXRyaWV2ZSB0aGUgbGlzdCBvZiBkZXZpY2VzIHZpc2libGUgdG8gYWRiIHdpdGhpbiB0aGUgZ2l2ZW4gdGltZW91dC5cbiAqXG4gKiBAcGFyYW0ge251bWJlcn0gdGltZW91dE1zIC0gVGhlIG1heGltdW0gbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byBnZXQgYXQgbGVhc3RcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbmUgbGlzdCBpdGVtLlxuICogQHJldHVybiB7QXJyYXkuPERldmljZT59IFRoZSBsaXN0IG9mIGNvbm5lY3RlZCBkZXZpY2VzLlxuICogQHRocm93cyB7RXJyb3J9IElmIG5vIGNvbm5lY3RlZCBkZXZpY2VzIGNhbiBiZSBkZXRlY3RlZCB3aXRoaW4gdGhlIGdpdmVuIHRpbWVvdXQuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmdldERldmljZXNXaXRoUmV0cnkgPSBhc3luYyBmdW5jdGlvbiBnZXREZXZpY2VzV2l0aFJldHJ5ICh0aW1lb3V0TXMgPSAyMDAwMCkge1xuICBjb25zdCB0aW1lciA9IG5ldyB0aW1pbmcuVGltZXIoKS5zdGFydCgpO1xuICBsb2cuZGVidWcoJ1RyeWluZyB0byBmaW5kIGEgY29ubmVjdGVkIGFuZHJvaWQgZGV2aWNlJyk7XG4gIGNvbnN0IGdldERldmljZXMgPSBhc3luYyAoKSA9PiB7XG4gICAgaWYgKHRpbWVyLmdldER1cmF0aW9uKCkuYXNNaWxsaVNlY29uZHMgPiB0aW1lb3V0TXMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgYSBjb25uZWN0ZWQgQW5kcm9pZCBkZXZpY2UgaW4gJHt0aW1lci5nZXREdXJhdGlvbigpLmFzTWlsbGlTZWNvbmRzLnRvRml4ZWQoMCl9bXMuYCk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICBjb25zdCBkZXZpY2VzID0gYXdhaXQgdGhpcy5nZXRDb25uZWN0ZWREZXZpY2VzKCk7XG4gICAgICBpZiAoZGV2aWNlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBkZXZpY2VzO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGlnbikge31cblxuICAgIGxvZy5kZWJ1ZygnQ291bGQgbm90IGZpbmQgb25saW5lIGRldmljZXMnKTtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5yZWNvbm5lY3QoKTtcbiAgICB9IGNhdGNoIChpZ24pIHtcbiAgICAgIGF3YWl0IHRoaXMucmVzdGFydEFkYigpO1xuICAgIH1cbiAgICAvLyBjb29sIGRvd25cbiAgICBhd2FpdCBzbGVlcCgyMDApO1xuICAgIHJldHVybiBhd2FpdCBnZXREZXZpY2VzKCk7XG4gIH07XG4gIHJldHVybiBhd2FpdCBnZXREZXZpY2VzKCk7XG59O1xuXG4vKipcbiAqIEtpY2sgY3VycmVudCBjb25uZWN0aW9uIGZyb20gaG9zdC9kZXZpY2Ugc2lkZSBhbmQgbWFrZSBpdCByZWNvbm5lY3RcbiAqXG4gKiBAcGFyYW0gez9zdHJpbmd9IHRhcmdldCBbb2ZmbGluZV0gT25lIG9mIHBvc3NpYmxlIHRhcmdldHMgdG8gcmVjb25uZWN0OlxuICogb2ZmbGluZSwgZGV2aWNlIG9yIG51bGxcbiAqIFByb3ZpZGluZyBgbnVsbGAgd2lsbCBjYXVzZSByZWNvbm5lY3Rpb24gdG8gaGFwcGVuIGZyb20gdGhlIGhvc3Qgc2lkZS5cbiAqXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgZWl0aGVyIEFEQiB2ZXJzaW9uIGlzIHRvbyBvbGQgYW5kIGRvZXMgbm90IHN1cHBvcnQgdGhpc1xuICogY29tbWFuZCBvciB0aGVyZSB3YXMgYSBmYWlsdXJlIGR1cmluZyByZWNvbm5lY3QuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLnJlY29ubmVjdCA9IGFzeW5jIGZ1bmN0aW9uIHJlY29ubmVjdCAodGFyZ2V0ID0gJ29mZmxpbmUnKSB7XG4gIGxvZy5kZWJ1ZyhgUmVjb25uZWN0aW5nIGFkYiAodGFyZ2V0ICR7dGFyZ2V0fSlgKTtcblxuICBjb25zdCBhcmdzID0gWydyZWNvbm5lY3QnXTtcbiAgaWYgKHRhcmdldCkge1xuICAgIGFyZ3MucHVzaCh0YXJnZXQpO1xuICB9XG4gIHRyeSB7XG4gICAgYXdhaXQgdGhpcy5hZGJFeGVjKGFyZ3MpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBDYW5ub3QgcmVjb25uZWN0IGFkYi4gT3JpZ2luYWwgZXJyb3I6ICR7ZS5zdGRlcnIgfHwgZS5tZXNzYWdlfWApO1xuICB9XG59O1xuXG4vKipcbiAqIFJlc3RhcnQgYWRiIHNlcnZlciwgdW5sZXNzIF90aGlzLnN1cHByZXNzS2lsbFNlcnZlcl8gcHJvcGVydHkgaXMgdHJ1ZS5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMucmVzdGFydEFkYiA9IGFzeW5jIGZ1bmN0aW9uIHJlc3RhcnRBZGIgKCkge1xuICBpZiAodGhpcy5zdXBwcmVzc0tpbGxTZXJ2ZXIpIHtcbiAgICBsb2cuZGVidWcoYE5vdCByZXN0YXJ0aW5nIGFiZCBzaW5jZSAnc3VwcHJlc3NLaWxsU2VydmVyJyBpcyBvbmApO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGxvZy5kZWJ1ZygnUmVzdGFydGluZyBhZGInKTtcbiAgdHJ5IHtcbiAgICBhd2FpdCB0aGlzLmtpbGxTZXJ2ZXIoKTtcbiAgICBhd2FpdCB0aGlzLmFkYkV4ZWMoWydzdGFydC1zZXJ2ZXInXSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBsb2cuZXJyb3IoYEVycm9yIGtpbGxpbmcgQURCIHNlcnZlciwgZ29pbmcgdG8gc2VlIGlmIGl0J3Mgb25saW5lIGFueXdheWApO1xuICB9XG59O1xuXG4vKipcbiAqIEtpbGwgYWRiIHNlcnZlci5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMua2lsbFNlcnZlciA9IGFzeW5jIGZ1bmN0aW9uIGtpbGxTZXJ2ZXIgKCkge1xuICBsb2cuZGVidWcoYEtpbGxpbmcgYWRiIHNlcnZlciBvbiBwb3J0ICcke3RoaXMuYWRiUG9ydH0nYCk7XG4gIGF3YWl0IHRoaXMuYWRiRXhlYyhbJ2tpbGwtc2VydmVyJ10sIHtcbiAgICBleGNsdXNpdmU6IHRydWUsXG4gIH0pO1xufTtcblxuLyoqXG4gKiBSZXNldCBUZWxuZXQgYXV0aGVudGljYXRpb24gdG9rZW4uXG4gKiBAc2VlIHtAbGluayBodHRwOi8vdG9vbHMuYW5kcm9pZC5jb20vcmVjZW50L2VtdWxhdG9yMjUxNnJlbGVhc2Vub3Rlc30gZm9yIG1vcmUgZGV0YWlscy5cbiAqXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gSWYgdG9rZW4gcmVzZXQgd2FzIHN1Y2Nlc3NmdWwuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLnJlc2V0VGVsbmV0QXV0aFRva2VuID0gXy5tZW1vaXplKGFzeW5jIGZ1bmN0aW9uIHJlc2V0VGVsbmV0QXV0aFRva2VuICgpIHtcbiAgLy8gVGhlIG1ldGhvZHMgaXMgdXNlZCB0byByZW1vdmUgdGVsbmV0IGF1dGggdG9rZW5cbiAgLy9cbiAgY29uc3QgaG9tZUZvbGRlclBhdGggPSBwcm9jZXNzLmVudlsocHJvY2Vzcy5wbGF0Zm9ybSA9PT0gJ3dpbjMyJykgPyAnVVNFUlBST0ZJTEUnIDogJ0hPTUUnXTtcbiAgaWYgKCFob21lRm9sZGVyUGF0aCkge1xuICAgIGxvZy53YXJuKGBDYW5ub3QgZmluZCB0aGUgcGF0aCB0byB1c2VyIGhvbWUgZm9sZGVyLiBJZ25vcmluZyByZXNldHRpbmcgb2YgZW11bGF0b3IncyB0ZWxuZXQgYXV0aGVudGljYXRpb24gdG9rZW5gKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgY29uc3QgZHN0UGF0aCA9IHBhdGgucmVzb2x2ZShob21lRm9sZGVyUGF0aCwgJy5lbXVsYXRvcl9jb25zb2xlX2F1dGhfdG9rZW4nKTtcbiAgbG9nLmRlYnVnKGBPdmVycmlkaW5nICR7ZHN0UGF0aH0gd2l0aCBhbiBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgdGVsbmV0IGF1dGhlbnRpY2F0aW9uIGZvciBlbXVsYXRvciBjb21tYW5kc2ApO1xuICB0cnkge1xuICAgIGF3YWl0IGZzLndyaXRlRmlsZShkc3RQYXRoLCAnJyk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBsb2cud2FybihgRXJyb3IgJHtlLm1lc3NhZ2V9IHdoaWxlIHJlc2V0dGluZyB0aGUgY29udGVudCBvZiAke2RzdFBhdGh9LiBJZ25vcmluZyByZXNldHRpbmcgb2YgZW11bGF0b3IncyB0ZWxuZXQgYXV0aGVudGljYXRpb24gdG9rZW5gKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59KTtcblxuLyoqXG4gKiBFeGVjdXRlIHRoZSBnaXZlbiBlbXVsYXRvciBjb21tYW5kIHVzaW5nIF9hZGIgZW11XyB0b29sLlxuICpcbiAqIEBwYXJhbSB7QXJyYXkuPHN0cmluZz59IGNtZCAtIFRoZSBhcnJheSBvZiByZXN0IGNvbW1hbmQgbGluZSBwYXJhbWV0ZXJzLlxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5hZGJFeGVjRW11ID0gYXN5bmMgZnVuY3Rpb24gYWRiRXhlY0VtdSAoY21kKSB7XG4gIGF3YWl0IHRoaXMudmVyaWZ5RW11bGF0b3JDb25uZWN0ZWQoKTtcbiAgYXdhaXQgdGhpcy5yZXNldFRlbG5ldEF1dGhUb2tlbigpO1xuICBhd2FpdCB0aGlzLmFkYkV4ZWMoWydlbXUnLCAuLi5jbWRdKTtcbn07XG5cbmxldCBpc0V4ZWNMb2NrZWQgPSBmYWxzZTtcblxuc3lzdGVtQ2FsbE1ldGhvZHMuRVhFQ19PVVRQVVRfRk9STUFUID0gT2JqZWN0LmZyZWV6ZSh7XG4gIFNURE9VVDogJ3N0ZG91dCcsXG4gIEZVTEw6ICdmdWxsJyxcbn0pO1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IEV4ZWNSZXN1bHRcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBzdGRvdXQgVGhlIHN0ZG91dCByZWNlaXZlZCBmcm9tIGV4ZWNcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBzdGRlcnIgVGhlIHN0ZGVyciByZWNlaXZlZCBmcm9tIGV4ZWNcbiAqL1xuXG4vKipcbiAqIEV4ZWN1dGUgdGhlIGdpdmVuIGFkYiBjb21tYW5kLlxuICpcbiAqIEBwYXJhbSB7QXJyYXkuPHN0cmluZz59IGNtZCAtIFRoZSBhcnJheSBvZiByZXN0IGNvbW1hbmQgbGluZSBwYXJhbWV0ZXJzXG4gKiAgICAgICAgICAgICAgICAgICAgICBvciBhIHNpbmdsZSBzdHJpbmcgcGFyYW1ldGVyLlxuICogQHBhcmFtIHtPYmplY3R9IG9wdHMgLSBBZGRpdGlvbmFsIG9wdGlvbnMgbWFwcGluZy4gU2VlXG4gKiAgICAgICAgICAgICAgICAgICAgICAgIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vYXBwaXVtL25vZGUtdGVlbl9wcm9jZXNzfVxuICogICAgICAgICAgICAgICAgICAgICAgICBmb3IgbW9yZSBkZXRhaWxzLlxuICogICAgICAgICAgICAgICAgICAgICAgICBZb3UgY2FuIGFsc28gc2V0IHRoZSBhZGRpdGlvbmFsIGBleGNsdXNpdmVgIHBhcmFtXG4gKiAgICAgICAgICAgICAgICAgICAgICAgIHRvIGB0cnVlYCB0aGF0IGFzc3VyZXMgbm8gb3RoZXIgcGFyYWxsZWwgYWRiIGNvbW1hbmRzXG4gKiAgICAgICAgICAgICAgICAgICAgICAgIGFyZSBnb2luZyB0byBiZSBleGVjdXRlZCB3aGlsZSB0aGUgY3VycmVudCBvbmUgaXMgcnVubmluZ1xuICogICAgICAgICAgICAgICAgICAgICAgICBZb3UgY2FuIHNldCB0aGUgYG91dHB1dEZvcm1hdGAgcGFyYW0gdG8gYHN0ZG91dGAgdG8gcmVjZWl2ZSBqdXN0IHRoZSBzdGRvdXRcbiAqICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0IChkZWZhdWx0KSBvciBgZnVsbGAgdG8gcmVjZWl2ZSB0aGUgc3Rkb3V0IGFuZCBzdGRlcnIgcmVzcG9uc2UgZnJvbSBhXG4gKiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmQgd2l0aCBhIHplcm8gZXhpdCBjb2RlXG4gKiBAcmV0dXJuIHtzdHJpbmd8RXhlY1Jlc3VsdH0gLSBDb21tYW5kJ3Mgc3Rkb3V0IG9yIGFuIG9iamVjdCBjb250YWluaW5nIHN0ZG91dCBhbmQgc3RkZXJyLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBjb21tYW5kIHJldHVybmVkIG5vbi16ZXJvIGV4aXQgY29kZS5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMuYWRiRXhlYyA9IGFzeW5jIGZ1bmN0aW9uIGFkYkV4ZWMgKGNtZCwgb3B0cyA9IHt9KSB7XG4gIGlmICghY21kKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgbmVlZCB0byBwYXNzIGluIGEgY29tbWFuZCB0byBhZGJFeGVjKCknKTtcbiAgfVxuXG4gIG9wdHMgPSBfLmNsb25lRGVlcChvcHRzKTtcbiAgLy8gc2V0dGluZyBkZWZhdWx0IHRpbWVvdXQgZm9yIGVhY2ggY29tbWFuZCB0byBwcmV2ZW50IGluZmluaXRlIHdhaXQuXG4gIG9wdHMudGltZW91dCA9IG9wdHMudGltZW91dCB8fCB0aGlzLmFkYkV4ZWNUaW1lb3V0IHx8IERFRkFVTFRfQURCX0VYRUNfVElNRU9VVDtcbiAgb3B0cy50aW1lb3V0Q2FwTmFtZSA9IG9wdHMudGltZW91dENhcE5hbWUgfHwgJ2FkYkV4ZWNUaW1lb3V0JzsgLy8gRm9yIGVycm9yIG1lc3NhZ2VcblxuICBjb25zdCB7b3V0cHV0Rm9ybWF0ID0gdGhpcy5FWEVDX09VVFBVVF9GT1JNQVQuU1RET1VUfSA9IG9wdHM7XG5cbiAgY21kID0gXy5pc0FycmF5KGNtZCkgPyBjbWQgOiBbY21kXTtcbiAgbGV0IGFkYlJldHJpZWQgPSBmYWxzZTtcbiAgY29uc3QgZXhlY0Z1bmMgPSBhc3luYyAoKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGFyZ3MgPSBbLi4udGhpcy5leGVjdXRhYmxlLmRlZmF1bHRBcmdzLCAuLi5jbWRdO1xuICAgICAgbG9nLmRlYnVnKGBSdW5uaW5nICcke3RoaXMuZXhlY3V0YWJsZS5wYXRofSBgICtcbiAgICAgICAgKGFyZ3MuZmluZCgoYXJnKSA9PiAvXFxzKy8udGVzdChhcmcpKSA/IHV0aWwucXVvdGUoYXJncykgOiBhcmdzLmpvaW4oJyAnKSkgKyBgJ2ApO1xuICAgICAgbGV0IHtzdGRvdXQsIHN0ZGVycn0gPSBhd2FpdCBleGVjKHRoaXMuZXhlY3V0YWJsZS5wYXRoLCBhcmdzLCBvcHRzKTtcbiAgICAgIC8vIHNvbWV0aW1lcyBBREIgcHJpbnRzIG91dCB3ZWlyZCBzdGRvdXQgd2FybmluZ3MgdGhhdCB3ZSBkb24ndCB3YW50XG4gICAgICAvLyB0byBpbmNsdWRlIGluIGFueSBvZiB0aGUgcmVzcG9uc2UgZGF0YSwgc28gbGV0J3Mgc3RyaXAgaXQgb3V0XG4gICAgICBzdGRvdXQgPSBzdGRvdXQucmVwbGFjZShMSU5LRVJfV0FSTklOR19SRUdFWFAsICcnKS50cmltKCk7XG4gICAgICByZXR1cm4gb3V0cHV0Rm9ybWF0ID09PSB0aGlzLkVYRUNfT1VUUFVUX0ZPUk1BVC5GVUxMID8ge3N0ZG91dCwgc3RkZXJyfSA6IHN0ZG91dDtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zdCBlcnJUZXh0ID0gYCR7ZS5tZXNzYWdlfSwgJHtlLnN0ZG91dH0sICR7ZS5zdGRlcnJ9YDtcbiAgICAgIGlmIChBREJfUkVUUllfRVJST1JfUEFUVEVSTlMuc29tZSgocCkgPT4gcC50ZXN0KGVyclRleHQpKSkge1xuICAgICAgICBsb2cuaW5mbyhgRXJyb3Igc2VuZGluZyBjb21tYW5kLCByZWNvbm5lY3RpbmcgZGV2aWNlIGFuZCByZXRyeWluZzogJHtjbWR9YCk7XG4gICAgICAgIGF3YWl0IHNsZWVwKDEwMDApO1xuICAgICAgICBhd2FpdCB0aGlzLmdldERldmljZXNXaXRoUmV0cnkoKTtcblxuICAgICAgICAvLyB0cnkgYWdhaW4gb25lIHRpbWVcbiAgICAgICAgaWYgKGFkYlJldHJpZWQpIHtcbiAgICAgICAgICBhZGJSZXRyaWVkID0gdHJ1ZTtcbiAgICAgICAgICByZXR1cm4gYXdhaXQgZXhlY0Z1bmMoKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoZS5jb2RlID09PSAwICYmIGUuc3Rkb3V0KSB7XG4gICAgICAgIHJldHVybiBlLnN0ZG91dC5yZXBsYWNlKExJTktFUl9XQVJOSU5HX1JFR0VYUCwgJycpLnRyaW0oKTtcbiAgICAgIH1cblxuICAgICAgaWYgKF8uaXNOdWxsKGUuY29kZSkpIHtcbiAgICAgICAgZS5tZXNzYWdlID0gYEVycm9yIGV4ZWN1dGluZyBhZGJFeGVjLiBPcmlnaW5hbCBlcnJvcjogJyR7ZS5tZXNzYWdlfScuIGAgK1xuICAgICAgICAgIGBUcnkgdG8gaW5jcmVhc2UgdGhlICR7b3B0cy50aW1lb3V0fW1zIGFkYiBleGVjdXRpb24gdGltZW91dCByZXByZXNlbnRlZCBieSAnJHtvcHRzLnRpbWVvdXRDYXBOYW1lfScgY2FwYWJpbGl0eWA7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBlLm1lc3NhZ2UgPSBgRXJyb3IgZXhlY3V0aW5nIGFkYkV4ZWMuIE9yaWdpbmFsIGVycm9yOiAnJHtlLm1lc3NhZ2V9JzsgYCArXG4gICAgICAgICAgYENvbW1hbmQgb3V0cHV0OiAke2Uuc3RkZXJyIHx8IGUuc3Rkb3V0IHx8ICc8ZW1wdHk+J31gO1xuICAgICAgfVxuICAgICAgdGhyb3cgZTtcbiAgICB9XG4gIH07XG5cbiAgaWYgKGlzRXhlY0xvY2tlZCkge1xuICAgIGxvZy5kZWJ1ZygnV2FpdGluZyB1bnRpbCB0aGUgb3RoZXIgZXhjbHVzaXZlIEFEQiBjb21tYW5kIGlzIGNvbXBsZXRlZCcpO1xuICAgIGF3YWl0IHdhaXRGb3JDb25kaXRpb24oKCkgPT4gIWlzRXhlY0xvY2tlZCwge1xuICAgICAgd2FpdE1zOiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUixcbiAgICAgIGludGVydmFsTXM6IDEwLFxuICAgIH0pO1xuICAgIGxvZy5kZWJ1ZygnQ29udGludWluZyB3aXRoIHRoZSBjdXJyZW50IEFEQiBjb21tYW5kJyk7XG4gIH1cbiAgaWYgKG9wdHMuZXhjbHVzaXZlKSB7XG4gICAgaXNFeGVjTG9ja2VkID0gdHJ1ZTtcbiAgfVxuICB0cnkge1xuICAgIHJldHVybiBhd2FpdCBleGVjRnVuYygpO1xuICB9IGZpbmFsbHkge1xuICAgIGlmIChvcHRzLmV4Y2x1c2l2ZSkge1xuICAgICAgaXNFeGVjTG9ja2VkID0gZmFsc2U7XG4gICAgfVxuICB9XG59O1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IFNoZWxsRXhlY09wdGlvbnNcbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gdGltZW91dENhcE5hbWUgW2FkYkV4ZWNUaW1lb3V0XSAtIHRoZSBuYW1lIG9mIHRoZSBjb3JyZXNwb25kaW5nIEFwcGl1bSdzIHRpbWVvdXQgY2FwYWJpbGl0eVxuICogKHVzZWQgaW4gdGhlIGVycm9yIG1lc3NhZ2VzKS5cbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0gdGltZW91dCBbYWRiRXhlY1RpbWVvdXRdIC0gY29tbWFuZCBleGVjdXRpb24gdGltZW91dC5cbiAqIEBwcm9wZXJ0eSB7P2Jvb2xlYW59IHByaXZpbGVnZWQgW2ZhbHN5XSAtIFdoZXRoZXIgdG8gcnVuIHRoZSBnaXZlbiBjb21tYW5kIGFzIHJvb3QuXG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IG91dHB1dEZvcm1hdCBbc3Rkb3V0XSAtIFdoZXRoZXIgcmVzcG9uc2Ugc2hvdWxkIGluY2x1ZGUgZnVsbCBleGVjIG91dHB1dCBvciBqdXN0IHN0ZG91dC5cbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUG90ZW50aWFsIHZhbHVlcyBhcmUgZnVsbCBvciBzdGRvdXQuXG4gKlxuICogQWxsIG90aGVyIHByb3BlcnRpZXMgYXJlIHRoZSBzYW1lIGFzIGZvciBgZXhlY2AgY2FsbCBmcm9tIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vYXBwaXVtL25vZGUtdGVlbl9wcm9jZXNzfVxuICogbW9kdWxlXG4gKi9cblxuLyoqXG4gKiBFeGVjdXRlIHRoZSBnaXZlbiBjb21tYW5kIHVzaW5nIF9hZGIgc2hlbGxfIHByZWZpeC5cbiAqXG4gKiBAcGFyYW0geyFBcnJheS48c3RyaW5nPnxzdHJpbmd9IGNtZCAtIFRoZSBhcnJheSBvZiByZXN0IGNvbW1hbmQgbGluZSBwYXJhbWV0ZXJzIG9yIGEgc2luZ2xlXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nIHBhcmFtZXRlci5cbiAqIEBwYXJhbSB7P1NoZWxsRXhlY09wdGlvbnN9IG9wdHMgW3t9XSAtIEFkZGl0aW9uYWwgb3B0aW9ucyBtYXBwaW5nLlxuICogQHJldHVybiB7c3RyaW5nfSAtIENvbW1hbmQncyBzdGRvdXQuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGNvbW1hbmQgcmV0dXJuZWQgbm9uLXplcm8gZXhpdCBjb2RlLlxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5zaGVsbCA9IGFzeW5jIGZ1bmN0aW9uIHNoZWxsIChjbWQsIG9wdHMgPSB7fSkge1xuICBjb25zdCB7XG4gICAgcHJpdmlsZWdlZCxcbiAgfSA9IG9wdHM7XG5cbiAgY29uc3QgY21kQXJyID0gXy5pc0FycmF5KGNtZCkgPyBjbWQgOiBbY21kXTtcbiAgY29uc3QgZnVsbENtZCA9IFsnc2hlbGwnXTtcbiAgaWYgKHByaXZpbGVnZWQpIHtcbiAgICBsb2cuaW5mbyhgJ2FkYiBzaGVsbCAke3V0aWwucXVvdGUoY21kQXJyKX0nIHJlcXVpcmVzIHJvb3QgYWNjZXNzYCk7XG4gICAgaWYgKGF3YWl0IHRoaXMuaXNSb290KCkpIHtcbiAgICAgIGxvZy5pbmZvKCdUaGUgZGV2aWNlIGFscmVhZHkgaGFkIHJvb3QgYWNjZXNzJyk7XG4gICAgICBmdWxsQ21kLnB1c2goLi4uY21kQXJyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZnVsbENtZC5wdXNoKCdzdScsICdyb290JywgdXRpbC5xdW90ZShjbWRBcnIpKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgZnVsbENtZC5wdXNoKC4uLmNtZEFycik7XG4gIH1cbiAgcmV0dXJuIGF3YWl0IHRoaXMuYWRiRXhlYyhmdWxsQ21kLCBvcHRzKTtcbn07XG5cbnN5c3RlbUNhbGxNZXRob2RzLmNyZWF0ZVN1YlByb2Nlc3MgPSBmdW5jdGlvbiBjcmVhdGVTdWJQcm9jZXNzIChhcmdzID0gW10pIHtcbiAgLy8gYWRkIHRoZSBkZWZhdWx0IGFyZ3VtZW50c1xuICBhcmdzID0gWy4uLnRoaXMuZXhlY3V0YWJsZS5kZWZhdWx0QXJncywgLi4uYXJnc107XG4gIGxvZy5kZWJ1ZyhgQ3JlYXRpbmcgQURCIHN1YnByb2Nlc3Mgd2l0aCBhcmdzOiAke0pTT04uc3RyaW5naWZ5KGFyZ3MpfWApO1xuICByZXR1cm4gbmV3IFN1YlByb2Nlc3ModGhpcy5nZXRBZGJQYXRoKCksIGFyZ3MpO1xufTtcblxuLyoqXG4gKiBSZXRyaWV2ZSB0aGUgY3VycmVudCBhZGIgcG9ydC5cbiAqIEB0b2RvIGNhbiBwcm9iYWJseSBkZXByZWNhdGUgdGhpcyBub3cgdGhhdCB0aGUgbG9naWMgaXMganVzdCB0byByZWFkIHRoaXMuYWRiUG9ydFxuICogQHJldHVybiB7bnVtYmVyfSBUaGUgY3VycmVudCBhZGIgcG9ydCBudW1iZXIuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmdldEFkYlNlcnZlclBvcnQgPSBmdW5jdGlvbiBnZXRBZGJTZXJ2ZXJQb3J0ICgpIHtcbiAgcmV0dXJuIHRoaXMuYWRiUG9ydDtcbn07XG5cbi8qKlxuICogUmV0cmlldmUgdGhlIGN1cnJlbnQgZW11bGF0b3IgcG9ydCBmcm9tIF9hZGIgZGV2aXZlc18gb3V0cHV0LlxuICpcbiAqIEByZXR1cm4ge251bWJlcn0gVGhlIGN1cnJlbnQgZW11bGF0b3IgcG9ydC5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGVyZSBhcmUgbm8gY29ubmVjdGVkIGRldmljZXMuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmdldEVtdWxhdG9yUG9ydCA9IGFzeW5jIGZ1bmN0aW9uIGdldEVtdWxhdG9yUG9ydCAoKSB7XG4gIGxvZy5kZWJ1ZygnR2V0dGluZyBydW5uaW5nIGVtdWxhdG9yIHBvcnQnKTtcbiAgaWYgKHRoaXMuZW11bGF0b3JQb3J0ICE9PSBudWxsKSB7XG4gICAgcmV0dXJuIHRoaXMuZW11bGF0b3JQb3J0O1xuICB9XG4gIHRyeSB7XG4gICAgbGV0IGRldmljZXMgPSBhd2FpdCB0aGlzLmdldENvbm5lY3RlZERldmljZXMoKTtcbiAgICBsZXQgcG9ydCA9IHRoaXMuZ2V0UG9ydEZyb21FbXVsYXRvclN0cmluZyhkZXZpY2VzWzBdLnVkaWQpO1xuICAgIGlmIChwb3J0KSB7XG4gICAgICByZXR1cm4gcG9ydDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFbXVsYXRvciBwb3J0IG5vdCBmb3VuZGApO1xuICAgIH1cbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgTm8gZGV2aWNlcyBjb25uZWN0ZWQuIE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgfVxufTtcblxuLyoqXG4gKiBSZXRyaWV2ZSB0aGUgY3VycmVudCBlbXVsYXRvciBwb3J0IGJ5IHBhcnNpbmcgZW11bGF0b3IgbmFtZSBzdHJpbmcuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGVtU3RyIC0gRW11bGF0b3IgbmFtZSBzdHJpbmcuXG4gKiBAcmV0dXJuIHtudW1iZXJ8Ym9vbGVhbn0gRWl0aGVyIHRoZSBjdXJyZW50IGVtdWxhdG9yIHBvcnQgb3JcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICBfZmFsc2VfIGlmIHBvcnQgbnVtYmVyIGNhbm5vdCBiZSBwYXJzZWQuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmdldFBvcnRGcm9tRW11bGF0b3JTdHJpbmcgPSBmdW5jdGlvbiBnZXRQb3J0RnJvbUVtdWxhdG9yU3RyaW5nIChlbVN0cikge1xuICBsZXQgcG9ydFBhdHRlcm4gPSAvZW11bGF0b3ItKFxcZCspLztcbiAgaWYgKHBvcnRQYXR0ZXJuLnRlc3QoZW1TdHIpKSB7XG4gICAgcmV0dXJuIHBhcnNlSW50KHBvcnRQYXR0ZXJuLmV4ZWMoZW1TdHIpWzFdLCAxMCk7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuLyoqXG4gKiBSZXRyaWV2ZSB0aGUgbGlzdCBvZiBjdXJyZW50bHkgY29ubmVjdGVkIGVtdWxhdG9ycy5cbiAqXG4gKiBAcGFyYW0gez9Db25uZWN0ZWREZXZpY2VzT3B0aW9uc30gb3B0cyBbe31dIC0gQWRkaXRpb25hbCBvcHRpb25zIG1hcHBpbmcuXG4gKiBAcmV0dXJuIHtBcnJheS48RGV2aWNlPn0gVGhlIGxpc3Qgb2YgY29ubmVjdGVkIGRldmljZXMuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmdldENvbm5lY3RlZEVtdWxhdG9ycyA9IGFzeW5jIGZ1bmN0aW9uIGdldENvbm5lY3RlZEVtdWxhdG9ycyAob3B0cyA9IHt9KSB7XG4gIGxvZy5kZWJ1ZygnR2V0dGluZyBjb25uZWN0ZWQgZW11bGF0b3JzJyk7XG4gIHRyeSB7XG4gICAgbGV0IGRldmljZXMgPSBhd2FpdCB0aGlzLmdldENvbm5lY3RlZERldmljZXMob3B0cyk7XG4gICAgbGV0IGVtdWxhdG9ycyA9IFtdO1xuICAgIGZvciAobGV0IGRldmljZSBvZiBkZXZpY2VzKSB7XG4gICAgICBsZXQgcG9ydCA9IHRoaXMuZ2V0UG9ydEZyb21FbXVsYXRvclN0cmluZyhkZXZpY2UudWRpZCk7XG4gICAgICBpZiAocG9ydCkge1xuICAgICAgICBkZXZpY2UucG9ydCA9IHBvcnQ7XG4gICAgICAgIGVtdWxhdG9ycy5wdXNoKGRldmljZSk7XG4gICAgICB9XG4gICAgfVxuICAgIGxvZy5kZWJ1ZyhgJHt1dGlsLnBsdXJhbGl6ZSgnZW11bGF0b3InLCBlbXVsYXRvcnMubGVuZ3RoLCB0cnVlKX0gY29ubmVjdGVkYCk7XG4gICAgcmV0dXJuIGVtdWxhdG9ycztcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3IgZ2V0dGluZyBlbXVsYXRvcnMuIE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgfVxufTtcblxuLyoqXG4gKiBTZXQgX2VtdWxhdG9yUG9ydF8gcHJvcGVydHkgb2YgdGhlIGN1cnJlbnQgY2xhc3MuXG4gKlxuICogQHBhcmFtIHtudW1iZXJ9IGVtUG9ydCAtIFRoZSBlbXVsYXRvciBwb3J0IHRvIGJlIHNldC5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMuc2V0RW11bGF0b3JQb3J0ID0gZnVuY3Rpb24gc2V0RW11bGF0b3JQb3J0IChlbVBvcnQpIHtcbiAgdGhpcy5lbXVsYXRvclBvcnQgPSBlbVBvcnQ7XG59O1xuXG4vKipcbiAqIFNldCB0aGUgaWRlbnRpZmllciBvZiB0aGUgY3VycmVudCBkZXZpY2UgKF90aGlzLmN1ckRldmljZUlkXykuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IC0gVGhlIGRldmljZSBpZGVudGlmaWVyLlxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5zZXREZXZpY2VJZCA9IGZ1bmN0aW9uIHNldERldmljZUlkIChkZXZpY2VJZCkge1xuICBsb2cuZGVidWcoYFNldHRpbmcgZGV2aWNlIGlkIHRvICR7ZGV2aWNlSWR9YCk7XG4gIHRoaXMuY3VyRGV2aWNlSWQgPSBkZXZpY2VJZDtcbiAgbGV0IGFyZ3NIYXNEZXZpY2UgPSB0aGlzLmV4ZWN1dGFibGUuZGVmYXVsdEFyZ3MuaW5kZXhPZignLXMnKTtcbiAgaWYgKGFyZ3NIYXNEZXZpY2UgIT09IC0xKSB7XG4gICAgLy8gcmVtb3ZlIHRoZSBvbGQgZGV2aWNlIGlkIGZyb20gdGhlIGFyZ3VtZW50c1xuICAgIHRoaXMuZXhlY3V0YWJsZS5kZWZhdWx0QXJncy5zcGxpY2UoYXJnc0hhc0RldmljZSwgMik7XG4gIH1cbiAgdGhpcy5leGVjdXRhYmxlLmRlZmF1bHRBcmdzLnB1c2goJy1zJywgZGV2aWNlSWQpO1xufTtcblxuLyoqXG4gKiBTZXQgdGhlIHRoZSBjdXJyZW50IGRldmljZSBvYmplY3QuXG4gKlxuICogQHBhcmFtIHtEZXZpY2V9IGRldmljZU9iaiAtIFRoZSBkZXZpY2Ugb2JqZWN0IHRvIGJlIHNldC5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMuc2V0RGV2aWNlID0gZnVuY3Rpb24gc2V0RGV2aWNlIChkZXZpY2VPYmopIHtcbiAgbGV0IGRldmljZUlkID0gZGV2aWNlT2JqLnVkaWQ7XG4gIGxldCBlbVBvcnQgPSB0aGlzLmdldFBvcnRGcm9tRW11bGF0b3JTdHJpbmcoZGV2aWNlSWQpO1xuICB0aGlzLnNldEVtdWxhdG9yUG9ydChlbVBvcnQpO1xuICB0aGlzLnNldERldmljZUlkKGRldmljZUlkKTtcbn07XG5cbi8qKlxuICogR2V0IHRoZSBvYmplY3QgZm9yIHRoZSBjdXJyZW50bHkgcnVubmluZyBlbXVsYXRvci5cbiAqICEhISBUaGlzIG1ldGhvZCBoYXMgYSBzaWRlIGVmZmVjdCAtIGl0IGltcGxpY2l0bHkgY2hhbmdlcyB0aGVcbiAqIGBkZXZpY2VJZGAgKG9ubHkgaWYgQVZEIHdpdGggYSBtYXRjaGluZyBuYW1lIGlzIGZvdW5kKVxuICogYW5kIGBlbXVsYXRvclBvcnRgIGluc3RhbmNlIHByb3BlcnRpZXMuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGF2ZE5hbWUgLSBFbXVsYXRvciBuYW1lLlxuICogQHJldHVybiB7P0RldmljZX0gQ3VycmVudGx5IHJ1bm5pbmcgZW11bGF0b3Igb3IgX251bGxfLlxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5nZXRSdW5uaW5nQVZEID0gYXN5bmMgZnVuY3Rpb24gZ2V0UnVubmluZ0FWRCAoYXZkTmFtZSkge1xuICBsb2cuZGVidWcoYFRyeWluZyB0byBmaW5kICcke2F2ZE5hbWV9JyBlbXVsYXRvcmApO1xuICB0cnkge1xuICAgIGNvbnN0IGVtdWxhdG9ycyA9IGF3YWl0IHRoaXMuZ2V0Q29ubmVjdGVkRW11bGF0b3JzKCk7XG4gICAgZm9yIChjb25zdCBlbXVsYXRvciBvZiBlbXVsYXRvcnMpIHtcbiAgICAgIHRoaXMuc2V0RW11bGF0b3JQb3J0KGVtdWxhdG9yLnBvcnQpO1xuICAgICAgY29uc3QgcnVubmluZ0FWRE5hbWUgPSBhd2FpdCB0aGlzLmV4ZWNFbXVDb25zb2xlQ29tbWFuZChbJ2F2ZCcsICduYW1lJ10sIHtcbiAgICAgICAgcG9ydDogZW11bGF0b3IucG9ydCxcbiAgICAgICAgZXhlY1RpbWVvdXQ6IDUwMDAsXG4gICAgICAgIGNvbm5UaW1lb3V0OiAxMDAwLFxuICAgICAgfSk7XG4gICAgICBpZiAoXy50b0xvd2VyKGF2ZE5hbWUpID09PSBfLnRvTG93ZXIocnVubmluZ0FWRE5hbWUudHJpbSgpKSkge1xuICAgICAgICBsb2cuZGVidWcoYEZvdW5kIGVtdWxhdG9yICcke2F2ZE5hbWV9JyBvbiBwb3J0ICR7ZW11bGF0b3IucG9ydH1gKTtcbiAgICAgICAgdGhpcy5zZXREZXZpY2VJZChlbXVsYXRvci51ZGlkKTtcbiAgICAgICAgcmV0dXJuIGVtdWxhdG9yO1xuICAgICAgfVxuICAgIH1cbiAgICBsb2cuZGVidWcoYEVtdWxhdG9yICcke2F2ZE5hbWV9JyBub3QgcnVubmluZ2ApO1xuICAgIHJldHVybiBudWxsO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBnZXR0aW5nIEFWRC4gT3JpZ2luYWwgZXJyb3I6ICR7ZS5tZXNzYWdlfWApO1xuICB9XG59O1xuXG4vKipcbiAqIEdldCB0aGUgb2JqZWN0IGZvciB0aGUgY3VycmVudGx5IHJ1bm5pbmcgZW11bGF0b3IuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGF2ZE5hbWUgLSBFbXVsYXRvciBuYW1lLlxuICogQHBhcmFtIHtudW1iZXJ9IHRpbWVvdXRNcyBbMjAwMDBdIC0gVGhlIG1heGltdW0gbnVtYmVyIG9mIG1pbGxpc2Vjb25kc1xuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gd2FpdCB1bnRpbCBhdCBsZWFzdCBvbmUgcnVubmluZyBBVkQgb2JqZWN0XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpcyBkZXRlY3RlZC5cbiAqIEByZXR1cm4gez9EZXZpY2V9IEN1cnJlbnRseSBydW5uaW5nIGVtdWxhdG9yIG9yIF9udWxsXy5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiBubyBkZXZpY2UgaGFzIGJlZW4gZGV0ZWN0ZWQgd2l0aGluIHRoZSB0aW1lb3V0LlxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5nZXRSdW5uaW5nQVZEV2l0aFJldHJ5ID0gYXN5bmMgZnVuY3Rpb24gZ2V0UnVubmluZ0FWRFdpdGhSZXRyeSAoYXZkTmFtZSwgdGltZW91dE1zID0gMjAwMDApIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQgd2FpdEZvckNvbmRpdGlvbihhc3luYyAoKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5nZXRSdW5uaW5nQVZEKGF2ZE5hbWUucmVwbGFjZSgnQCcsICcnKSk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGxvZy5kZWJ1ZyhlLm1lc3NhZ2UpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSwge1xuICAgICAgd2FpdE1zOiB0aW1lb3V0TXMsXG4gICAgICBpbnRlcnZhbE1zOiAxMDAwLFxuICAgIH0pO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBnZXR0aW5nIEFWRCB3aXRoIHJldHJ5LiBPcmlnaW5hbCBlcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gIH1cbn07XG5cbi8qKlxuICogU2h1dGRvd24gYWxsIHJ1bm5pbmcgZW11bGF0b3JzIGJ5IGtpbGxpbmcgdGhlaXIgcHJvY2Vzc2VzLlxuICpcbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiBraWxsaW5nIHRvb2wgcmV0dXJuZWQgbm9uLXplcm8gcmV0dXJuIGNvZGUuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmtpbGxBbGxFbXVsYXRvcnMgPSBhc3luYyBmdW5jdGlvbiBraWxsQWxsRW11bGF0b3JzICgpIHtcbiAgbGV0IGNtZCwgYXJncztcbiAgaWYgKHN5c3RlbS5pc1dpbmRvd3MoKSkge1xuICAgIGNtZCA9ICdUQVNLS0lMTCc7XG4gICAgYXJncyA9IFsnVEFTS0tJTEwnLCAnL0lNJywgJ2VtdWxhdG9yLmV4ZSddO1xuICB9IGVsc2Uge1xuICAgIGNtZCA9ICcvdXNyL2Jpbi9raWxsYWxsJztcbiAgICBhcmdzID0gWyctbScsICdlbXVsYXRvcionXTtcbiAgfVxuICB0cnkge1xuICAgIGF3YWl0IGV4ZWMoY21kLCBhcmdzKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3Iga2lsbGluZyBlbXVsYXRvcnMuIE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgfVxufTtcblxuLyoqXG4gKiBLaWxsIGVtdWxhdG9yIHdpdGggdGhlIGdpdmVuIG5hbWUuIE5vIGVycm9yXG4gKiBpcyB0aHJvd24gaXMgZ2l2ZW4gYXZkIGRvZXMgbm90IGV4aXN0L2lzIG5vdCBydW5uaW5nLlxuICpcbiAqIEBwYXJhbSB7P3N0cmluZ30gYXZkTmFtZSAtIFRoZSBuYW1lIG9mIHRoZSBlbXVsYXRvciB0byBiZSBraWxsZWQuIElmIGVtcHR5LFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlIGN1cnJlbnQgZW11bGF0b3Igd2lsbCBiZSBraWxsZWQuXG4gKiBAcGFyYW0gez9udW1iZXJ9IHRpbWVvdXQgWzYwMDAwXSAtIFRoZSBhbW91bnQgb2YgdGltZSB0byB3YWl0IGJlZm9yZSB0aHJvd2luZ1xuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbiBleGNlcHRpb24gYWJvdXQgdW5zdWNjZXNzZnVsIGtpbGxpbmdcbiAqIEByZXR1cm4ge2Jvb2xlYW59IC0gVHJ1ZSBpZiB0aGUgZW11bGF0b3Igd2FzIGtpbGxlZCwgZmFsc2Ugb3RoZXJ3aXNlLlxuICogQHRocm93cyB7RXJyb3J9IGlmIHRoZXJlIHdhcyBhIGZhaWx1cmUgYnkga2lsbGluZyB0aGUgZW11bGF0b3JcbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMua2lsbEVtdWxhdG9yID0gYXN5bmMgZnVuY3Rpb24ga2lsbEVtdWxhdG9yIChhdmROYW1lID0gbnVsbCwgdGltZW91dCA9IDYwMDAwKSB7XG4gIGlmICh1dGlsLmhhc1ZhbHVlKGF2ZE5hbWUpKSB7XG4gICAgbG9nLmRlYnVnKGBLaWxsaW5nIGF2ZCAnJHthdmROYW1lfSdgKTtcbiAgICBjb25zdCBkZXZpY2UgPSBhd2FpdCB0aGlzLmdldFJ1bm5pbmdBVkQoYXZkTmFtZSk7XG4gICAgaWYgKCFkZXZpY2UpIHtcbiAgICAgIGxvZy5pbmZvKGBObyBhdmQgd2l0aCBuYW1lICcke2F2ZE5hbWV9JyBydW5uaW5nLiBTa2lwcGluZyBraWxsIHN0ZXAuYCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIC8vIGtpbGxpbmcgdGhlIGN1cnJlbnQgYXZkXG4gICAgbG9nLmRlYnVnKGBLaWxsaW5nIGF2ZCB3aXRoIGlkICcke3RoaXMuY3VyRGV2aWNlSWR9J2ApO1xuICAgIGlmICghYXdhaXQgdGhpcy5pc0VtdWxhdG9yQ29ubmVjdGVkKCkpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgRW11bGF0b3Igd2l0aCBpZCAnJHt0aGlzLmN1ckRldmljZUlkfScgbm90IGNvbm5lY3RlZC4gU2tpcHBpbmcga2lsbCBzdGVwYCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIGF3YWl0IHRoaXMuYWRiRXhlYyhbJ2VtdScsICdraWxsJ10pO1xuICBsb2cuZGVidWcoYFdhaXRpbmcgdXAgdG8gJHt0aW1lb3V0fW1zIHVudGlsIHRoZSBlbXVsYXRvciAnJHthdmROYW1lID8gYXZkTmFtZSA6IHRoaXMuY3VyRGV2aWNlSWR9JyBpcyBraWxsZWRgKTtcbiAgdHJ5IHtcbiAgICBhd2FpdCB3YWl0Rm9yQ29uZGl0aW9uKGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJldHVybiB1dGlsLmhhc1ZhbHVlKGF2ZE5hbWUpXG4gICAgICAgICAgPyAhYXdhaXQgdGhpcy5nZXRSdW5uaW5nQVZEKGF2ZE5hbWUpXG4gICAgICAgICAgOiAhYXdhaXQgdGhpcy5pc0VtdWxhdG9yQ29ubmVjdGVkKCk7XG4gICAgICB9IGNhdGNoIChpZ24pIHt9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSwge1xuICAgICAgd2FpdE1zOiB0aW1lb3V0LFxuICAgICAgaW50ZXJ2YWxNczogMjAwMCxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgVGhlIGVtdWxhdG9yICcke2F2ZE5hbWUgPyBhdmROYW1lIDogdGhpcy5jdXJEZXZpY2VJZH0nIGlzIHN0aWxsIHJ1bm5pbmcgYWZ0ZXIgYmVpbmcga2lsbGVkICR7dGltZW91dH1tcyBhZ29gKTtcbiAgfVxuICBsb2cuaW5mbyhgU3VjY2Vzc2Z1bGx5IGtpbGxlZCB0aGUgJyR7YXZkTmFtZSA/IGF2ZE5hbWUgOiB0aGlzLmN1ckRldmljZUlkfScgZW11bGF0b3JgKTtcbiAgcmV0dXJuIHRydWU7XG59O1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IEF2ZExhdW5jaE9wdGlvbnNcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfEFycmF5PHN0cmluZz59IGFyZ3MgQWRkaXRpb25hbCBlbXVsYXRvciBjb21tYW5kIGxpbmUgYXJndW1lbnRzXG4gKiBAcHJvcGVydHkge09iamVjdH0gZW52IEFkZGl0aW9uYWwgZW11bGF0b3IgZW52aXJvbm1lbnQgdmFyaWFibGVzXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbGFuZ3VhZ2UgRW11bGF0b3Igc3lzdGVtIGxhbmd1YWdlXG4gKiBAcHJvcGVydHkge3N0cmluZ30gY291bnRyeSBFbXVsYXRvciBzeXN0ZW0gY291bnRyeVxuICogQHByb3BlcnR5IHtudW1iZXJ9IGxhdW5jaFRpbWVvdXQgWzYwMDAwXSBFbXVsYXRvciBzdGFydHVwIHRpbWVvdXQgaW4gbWlsbGlzZWNvbmRzXG4gKiBAcHJvcGVydHkge251bWJlcn0gcmVhZHlUaW1lb3V0IFs2MDAwMF0gVGhlIG1heGltdW0gcGVyaW9kIG9mIHRpbWUgdG8gd2FpdCB1bnRpbCBFbXVsYXRvclxuICogaXMgcmVhZHkgZm9yIHVzYWdlIGluIG1pbGxpc2Vjb25kc1xuICogQHByb3BlcnR5IHtudW1iZXJ9IHJldHJ5VGltZXMgWzFdIFRoZSBtYXhpbXVtIG51bWJlciBvZiBzdGFydHVwIHJldHJpZXNcbiAqL1xuXG4vKipcbiAqIFN0YXJ0IGFuIGVtdWxhdG9yIHdpdGggZ2l2ZW4gcGFyYW1ldGVycyBhbmQgd2FpdCB1bnRpbCBpdCBpcyBmdWxseSBzdGFydGVkLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBhdmROYW1lIC0gVGhlIG5hbWUgb2YgYW4gZXhpc3RpbmcgZW11bGF0b3IuXG4gKiBAcGFyYW0gez9BdmRMYXVuY2hPcHRpb25zfSBvcHRzXG4gKiBAcmV0dXJucyB7U3ViUHJvY2Vzc30gRW11bGF0b3Igc3VicHJvY2VzcyBpbnN0YW5jZVxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBlbXVsYXRvciBmYWlscyB0byBzdGFydCB3aXRoaW4gdGhlIGdpdmVuIHRpbWVvdXQuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmxhdW5jaEFWRCA9IGFzeW5jIGZ1bmN0aW9uIGxhdW5jaEFWRCAoYXZkTmFtZSwgb3B0cyA9IHt9KSB7XG4gIGNvbnN0IHtcbiAgICBhcmdzID0gW10sXG4gICAgZW52ID0ge30sXG4gICAgbGFuZ3VhZ2UsXG4gICAgY291bnRyeSxcbiAgICBsYXVuY2hUaW1lb3V0ID0gNjAwMDAsXG4gICAgcmVhZHlUaW1lb3V0ID0gNjAwMDAsXG4gICAgcmV0cnlUaW1lcyA9IDEsXG4gIH0gPSBvcHRzO1xuICBsb2cuZGVidWcoYExhdW5jaGluZyBFbXVsYXRvciB3aXRoIEFWRCAke2F2ZE5hbWV9LCBsYXVuY2hUaW1lb3V0IGAgK1xuICAgICAgICAgICAgYCR7bGF1bmNoVGltZW91dH1tcyBhbmQgcmVhZHlUaW1lb3V0ICR7cmVhZHlUaW1lb3V0fW1zYCk7XG4gIGNvbnN0IGVtdWxhdG9yQmluYXJ5UGF0aCA9IGF3YWl0IHRoaXMuZ2V0U2RrQmluYXJ5UGF0aCgnZW11bGF0b3InKTtcbiAgaWYgKGF2ZE5hbWVbMF0gPT09ICdAJykge1xuICAgIGF2ZE5hbWUgPSBhdmROYW1lLnN1YnN0cigxKTtcbiAgfVxuICBhd2FpdCB0aGlzLmNoZWNrQXZkRXhpc3QoYXZkTmFtZSk7XG5cbiAgY29uc3QgbGF1bmNoQXJncyA9IFsnLWF2ZCcsIGF2ZE5hbWVdO1xuICBsYXVuY2hBcmdzLnB1c2goLi4uKHRvQXZkTG9jYWxlQXJncyhsYW5ndWFnZSwgY291bnRyeSkpKTtcblxuICBsZXQgaXNEZWxheUFkYkZlYXR1cmVFbmFibGVkID0gZmFsc2U7XG4gIGlmICh0aGlzLmFsbG93RGVsYXlBZGIpIHtcbiAgICBjb25zdCB7cmV2aXNpb259ID0gYXdhaXQgdGhpcy5nZXRFbXVWZXJzaW9uSW5mbygpO1xuICAgIGlmIChyZXZpc2lvbiAmJiB1dGlsLmNvbXBhcmVWZXJzaW9ucyhyZXZpc2lvbiwgJz49JywgJzI5LjAuNycpKSB7XG4gICAgICAvLyBodHRwczovL2FuZHJvaWRzdHVkaW8uZ29vZ2xlYmxvZy5jb20vMjAxOS8wNS9lbXVsYXRvci0yOTA3LWNhbmFyeS5odG1sXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB7dGFyZ2V0fSA9IGF3YWl0IHRoaXMuZ2V0RW11SW1hZ2VQcm9wZXJ0aWVzKGF2ZE5hbWUpO1xuICAgICAgICBjb25zdCBhcGlNYXRjaCA9IC9cXGQrLy5leGVjKHRhcmdldCk7XG4gICAgICAgIC8vIGh0dHBzOi8vaXNzdWV0cmFja2VyLmdvb2dsZS5jb20vaXNzdWVzLzE0MjUzMzM1NVxuICAgICAgICBpZiAoYXBpTWF0Y2ggJiYgcGFyc2VJbnQoYXBpTWF0Y2hbMF0sIDEwKSA+PSBNSU5fREVMQVlfQURCX0FQSV9MRVZFTCkge1xuICAgICAgICAgIGxhdW5jaEFyZ3MucHVzaCgnLWRlbGF5LWFkYicpO1xuICAgICAgICAgIGlzRGVsYXlBZGJGZWF0dXJlRW5hYmxlZCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgYWN0dWFsIGltYWdlIEFQSSB2ZXJzaW9uIGlzIGJlbG93ICR7TUlOX0RFTEFZX0FEQl9BUElfTEVWRUx9YCk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgbG9nLmluZm8oYFRoZSAtZGVsYXktYWRiIGVtdWxhdG9yIHN0YXJ0dXAgZGV0ZWN0aW9uIGZlYXR1cmUgd2lsbCBub3QgYmUgZW5hYmxlZC4gYCArXG4gICAgICAgICAgYE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgbG9nLmluZm8oJ1RoZSAtZGVsYXktYWRiIGVtdWxhdG9yIHN0YXJ0dXAgZGV0ZWN0aW9uIGZlYXR1cmUgaGFzIGJlZW4gZXhwbGljaXRseSBkaXNhYmxlZCcpO1xuICB9XG5cbiAgaWYgKCFfLmlzRW1wdHkoYXJncykpIHtcbiAgICBsYXVuY2hBcmdzLnB1c2goLi4uKF8uaXNBcnJheShhcmdzKSA/IGFyZ3MgOiB1dGlsLnNoZWxsUGFyc2UoYCR7YXJnc31gKSkpO1xuICB9XG5cbiAgbG9nLmRlYnVnKGBSdW5uaW5nICcke2VtdWxhdG9yQmluYXJ5UGF0aH0nIHdpdGggYXJnczogJHt1dGlsLnF1b3RlKGxhdW5jaEFyZ3MpfWApO1xuICBpZiAoIV8uaXNFbXB0eShlbnYpKSB7XG4gICAgbG9nLmRlYnVnKGBDdXN0b21pemVkIGVtdWxhdG9yIGVudmlyb25tZW50OiAke0pTT04uc3RyaW5naWZ5KGVudil9YCk7XG4gIH1cbiAgY29uc3QgcHJvYyA9IG5ldyBTdWJQcm9jZXNzKGVtdWxhdG9yQmluYXJ5UGF0aCwgbGF1bmNoQXJncywge1xuICAgIGVudjogT2JqZWN0LmFzc2lnbih7fSwgcHJvY2Vzcy5lbnYsIGVudiksXG4gIH0pO1xuICBhd2FpdCBwcm9jLnN0YXJ0KDApO1xuICBwcm9jLm9uKCdvdXRwdXQnLCAoc3Rkb3V0LCBzdGRlcnIpID0+IHtcbiAgICBmb3IgKGxldCBsaW5lIG9mIChzdGRvdXQgfHwgc3RkZXJyIHx8ICcnKS5zcGxpdCgnXFxuJykuZmlsdGVyKEJvb2xlYW4pKSB7XG4gICAgICBsb2cuaW5mbyhgW0FWRCBPVVRQVVRdICR7bGluZX1gKTtcbiAgICB9XG4gIH0pO1xuICBwcm9jLm9uKCdkaWUnLCAoY29kZSwgc2lnbmFsKSA9PiB7XG4gICAgbG9nLndhcm4oYEVtdWxhdG9yIGF2ZCAke2F2ZE5hbWV9IGV4aXRlZCB3aXRoIGNvZGUgJHtjb2RlfSR7c2lnbmFsID8gYCwgc2lnbmFsICR7c2lnbmFsfWAgOiAnJ31gKTtcbiAgfSk7XG4gIGF3YWl0IHJldHJ5KHJldHJ5VGltZXMsIGFzeW5jICgpID0+IGF3YWl0IHRoaXMuZ2V0UnVubmluZ0FWRFdpdGhSZXRyeShhdmROYW1lLCBsYXVuY2hUaW1lb3V0KSk7XG4gIC8vIEF0IHRoaXMgcG9pbnQgd2UgaGF2ZSBkZXZpY2VJZCBhbHJlYWR5IGFzc2lnbmVkXG4gIGNvbnN0IHRpbWVyID0gbmV3IHRpbWluZy5UaW1lcigpLnN0YXJ0KCk7XG4gIGlmIChpc0RlbGF5QWRiRmVhdHVyZUVuYWJsZWQpIHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5hZGJFeGVjKFsnd2FpdC1mb3ItZGV2aWNlJ10sIHt0aW1lb3V0OiByZWFkeVRpbWVvdXR9KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYCcke2F2ZE5hbWV9JyBFbXVsYXRvciBoYXMgZmFpbGVkIHRvIGJvb3Q6ICR7ZS5zdGRlcnIgfHwgZS5tZXNzYWdlfWApO1xuICAgIH1cbiAgfVxuICBhd2FpdCB0aGlzLndhaXRGb3JFbXVsYXRvclJlYWR5KHJlYWR5VGltZW91dCAtIHRpbWVyLmdldER1cmF0aW9uKCkuYXNNaWxsaVNlY29uZHMpO1xuICByZXR1cm4gcHJvYztcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gQmluYXJ5VmVyc2lvblxuICogQHByb3BlcnR5IHtTZW1WZXJ9IHZlcnNpb24gLSBUaGUgQURCIGJpbmFyeSB2ZXJzaW9uIG51bWJlclxuICogQHByb3BlcnR5IHtudW1iZXJ9IGJ1aWxkIC0gVGhlIEFEQiBiaW5hcnkgYnVpbGQgbnVtYmVyXG4gKi9cblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBCcmlkZ2VWZXJzaW9uXG4gKiBAcHJvcGVydHkge1NlbVZlcn0gdmVyc2lvbiAtIFRoZSBBbmRyb2lkIERlYnVnIEJyaWRnZSB2ZXJzaW9uIG51bWJlclxuICovXG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gVmVyc2lvblxuICogQHByb3BlcnR5IHs/QmluYXJ5VmVyc2lvbn0gYmluYXJ5IFRoaXMgdmVyc2lvbiBudW1iZXIgbWlnaHQgbm90IGJlXG4gKiBiZSBwcmVzZW50IGZvciBvbGRlciBBREIgcmVsZWFzZXMuXG4gKiBAcHJvcGVydHkge0JyaWRnZVZlcnNpb259IGJyaWRnZVxuICovXG5cbi8qKlxuICogR2V0IHRoZSBhZGIgdmVyc2lvbi4gVGhlIHJlc3VsdCBvZiB0aGlzIG1ldGhvZCBpcyBjYWNoZWQuXG4gKlxuICogQHJldHVybiB7VmVyc2lvbn1cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiBpdCBpcyBub3QgcG9zc2libGUgdG8gcGFyc2UgYWRiIGJpbmFyeSB2ZXJzaW9uLlxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5nZXRWZXJzaW9uID0gXy5tZW1vaXplKGFzeW5jIGZ1bmN0aW9uIGdldFZlcnNpb24gKCkge1xuICBsZXQgc3Rkb3V0O1xuICB0cnkge1xuICAgIHN0ZG91dCA9IGF3YWl0IHRoaXMuYWRiRXhlYygndmVyc2lvbicpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBnZXR0aW5nIGFkYiB2ZXJzaW9uOiAke2Uuc3RkZXJyIHx8IGUubWVzc2FnZX1gKTtcbiAgfVxuXG4gIGNvbnN0IHJlc3VsdCA9IHt9O1xuICBjb25zdCBiaW5hcnlWZXJzaW9uTWF0Y2ggPSBCSU5BUllfVkVSU0lPTl9QQVRURVJOLmV4ZWMoc3Rkb3V0KTtcbiAgaWYgKGJpbmFyeVZlcnNpb25NYXRjaCkge1xuICAgIHJlc3VsdC5iaW5hcnkgPSB7XG4gICAgICB2ZXJzaW9uOiBzZW12ZXIuY29lcmNlKGJpbmFyeVZlcnNpb25NYXRjaFsxXSksXG4gICAgICBidWlsZDogcGFyc2VJbnQoYmluYXJ5VmVyc2lvbk1hdGNoWzJdLCAxMCksXG4gICAgfTtcbiAgfVxuICBjb25zdCBicmlkZ2VWZXJzaW9uTWF0Y2ggPSBCUklER0VfVkVSU0lPTl9QQVRURVJOLmV4ZWMoc3Rkb3V0KTtcbiAgaWYgKGJyaWRnZVZlcnNpb25NYXRjaCkge1xuICAgIHJlc3VsdC5icmlkZ2UgPSB7XG4gICAgICB2ZXJzaW9uOiBzZW12ZXIuY29lcmNlKGJyaWRnZVZlcnNpb25NYXRjaFsxXSksXG4gICAgfTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufSk7XG5cbi8qKlxuICogQ2hlY2sgaWYgdGhlIGN1cnJlbnQgZW11bGF0b3IgaXMgcmVhZHkgdG8gYWNjZXB0IGZ1cnRoZXIgY29tbWFuZHMgKGJvb3RpbmcgY29tcGxldGVkKS5cbiAqXG4gKiBAcGFyYW0ge251bWJlcn0gdGltZW91dE1zIFsyMDAwMF0gLSBUaGUgbWF4aW11bSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHRvIHdhaXQuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGVtdWxhdG9yIGlzIG5vdCByZWFkeSB3aXRoaW4gdGhlIGdpdmVuIHRpbWVvdXQuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLndhaXRGb3JFbXVsYXRvclJlYWR5ID0gYXN5bmMgZnVuY3Rpb24gd2FpdEZvckVtdWxhdG9yUmVhZHkgKHRpbWVvdXRNcyA9IDIwMDAwKSB7XG4gIGNvbnN0IHJlcXVpcmVkU2VydmljZXNSZSA9IFJFUVVJUkVEX1NFUlZJQ0VTLm1hcCgobmFtZSkgPT4gbmV3IFJlZ0V4cChgXFxcXGIke25hbWV9OmApKTtcbiAgbGV0IHNlcnZpY2VzO1xuICB0cnkge1xuICAgIGF3YWl0IHdhaXRGb3JDb25kaXRpb24oYXN5bmMgKCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgc2VydmljZXMgPSBhd2FpdCB0aGlzLnNoZWxsKFsnc2VydmljZScsICdsaXN0J10pO1xuICAgICAgICByZXR1cm4gcmVxdWlyZWRTZXJ2aWNlc1JlLmV2ZXJ5KChwYXR0ZXJuKSA9PiBwYXR0ZXJuLnRlc3Qoc2VydmljZXMpKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBsb2cuZGVidWcoYFdhaXRpbmcgZm9yIGVtdWxhdG9yIHN0YXJ0dXAuIEludGVybWVkaWF0ZSBlcnJvcjogJHtlcnIubWVzc2FnZX1gKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIHdhaXRNczogdGltZW91dE1zLFxuICAgICAgaW50ZXJ2YWxNczogMzAwMCxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGlmIChzZXJ2aWNlcykge1xuICAgICAgbG9nLmRlYnVnKGBSZWNlbnRseSBsaXN0ZWQgc2VydmljZXM6XFxuJHtzZXJ2aWNlc31gKTtcbiAgICB9XG4gICAgY29uc3QgbWlzc2luZ1NlcnZpY2VzID0gXy56aXAoUkVRVUlSRURfU0VSVklDRVMsIHJlcXVpcmVkU2VydmljZXNSZSlcbiAgICAgIC5maWx0ZXIoKFssIHBhdHRlcm5dKSA9PiAhcGF0dGVybi50ZXN0KHNlcnZpY2VzKSlcbiAgICAgIC5tYXAoKFtuYW1lXSkgPT4gbmFtZSk7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBFbXVsYXRvciBpcyBub3QgcmVhZHkgd2l0aGluICR7dGltZW91dE1zfW1zIGAgK1xuICAgICAgYCgke21pc3NpbmdTZXJ2aWNlc30gc2VydmljZSR7bWlzc2luZ1NlcnZpY2VzLmxlbmd0aCA9PT0gMSA/ICcgaXMnIDogJ3MgYXJlJ30gbm90IHJ1bm5pbmcpYCk7XG4gIH1cbn07XG5cbi8qKlxuICogQ2hlY2sgaWYgdGhlIGN1cnJlbnQgZGV2aWNlIGlzIHJlYWR5IHRvIGFjY2VwdCBmdXJ0aGVyIGNvbW1hbmRzIChib290aW5nIGNvbXBsZXRlZCkuXG4gKlxuICogQHBhcmFtIHtudW1iZXJ9IGFwcERldmljZVJlYWR5VGltZW91dCBbMzBdIC0gVGhlIG1heGltdW0gbnVtYmVyIG9mIHNlY29uZHMgdG8gd2FpdC5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgZGV2aWNlIGlzIG5vdCByZWFkeSB3aXRoaW4gdGhlIGdpdmVuIHRpbWVvdXQuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLndhaXRGb3JEZXZpY2UgPSBhc3luYyBmdW5jdGlvbiB3YWl0Rm9yRGV2aWNlIChhcHBEZXZpY2VSZWFkeVRpbWVvdXQgPSAzMCkge1xuICB0aGlzLmFwcERldmljZVJlYWR5VGltZW91dCA9IGFwcERldmljZVJlYWR5VGltZW91dDtcbiAgY29uc3QgcmV0cmllcyA9IDM7XG4gIGNvbnN0IHRpbWVvdXQgPSBwYXJzZUludCh0aGlzLmFwcERldmljZVJlYWR5VGltZW91dCwgMTApICogMTAwMCAvIHJldHJpZXM7XG4gIGF3YWl0IHJldHJ5KHJldHJpZXMsIGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5hZGJFeGVjKCd3YWl0LWZvci1kZXZpY2UnLCB7dGltZW91dH0pO1xuICAgICAgYXdhaXQgdGhpcy5waW5nKCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgdGhpcy5yZWNvbm5lY3QoKTtcbiAgICAgIH0gY2F0Y2ggKGlnbikge1xuICAgICAgICBhd2FpdCB0aGlzLnJlc3RhcnRBZGIoKTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IHRoaXMuZ2V0Q29ubmVjdGVkRGV2aWNlcygpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciB3YWl0aW5nIGZvciB0aGUgZGV2aWNlIHRvIGJlIGF2YWlsYWJsZS4gT3JpZ2luYWwgZXJyb3I6ICcke2UubWVzc2FnZX0nYCk7XG4gICAgfVxuICB9KTtcbn07XG5cbi8qKlxuICogUmVib290IHRoZSBjdXJyZW50IGRldmljZSBhbmQgd2FpdCB1bnRpbCBpdCBpcyBjb21wbGV0ZWQuXG4gKlxuICogQHBhcmFtIHtudW1iZXJ9IHJldHJpZXMgW0RFRkFVTFRfQURCX1JFQk9PVF9SRVRSSUVTXSAtIFRoZSBtYXhpbXVtIG51bWJlciBvZiByZWJvb3QgcmV0cmllcy5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgZGV2aWNlIGZhaWxlZCB0byByZWJvb3QgYW5kIG51bWJlciBvZiByZXRyaWVzIGlzIGV4Y2VlZGVkLlxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5yZWJvb3QgPSBhc3luYyBmdW5jdGlvbiByZWJvb3QgKHJldHJpZXMgPSBERUZBVUxUX0FEQl9SRUJPT1RfUkVUUklFUykge1xuICAvLyBHZXQgcm9vdCBhY2Nlc3Mgc28gd2UgY2FuIHJ1biB0aGUgbmV4dCBzaGVsbCBjb21tYW5kcyB3aGljaCByZXF1aXJlIHJvb3QgYWNjZXNzXG4gIGNvbnN0IHsgd2FzQWxyZWFkeVJvb3RlZCB9ID0gYXdhaXQgdGhpcy5yb290KCk7XG4gIHRyeSB7XG4gICAgLy8gU3RvcCBhbmQgcmUtc3RhcnQgdGhlIGRldmljZVxuICAgIGF3YWl0IHRoaXMuc2hlbGwoWydzdG9wJ10pO1xuICAgIGF3YWl0IEIuZGVsYXkoMjAwMCk7IC8vIGxldCB0aGUgZW11IGZpbmlzaCBzdG9wcGluZztcbiAgICBhd2FpdCB0aGlzLnNldERldmljZVByb3BlcnR5KCdzeXMuYm9vdF9jb21wbGV0ZWQnLCAwLCB7XG4gICAgICBwcml2aWxlZ2VkOiBmYWxzZSAvLyBubyBuZWVkIHRvIHNldCBwcml2aWxlZ2VkIHRydWUgYmVjYXVzZSBkZXZpY2UgYWxyZWFkeSByb290ZWRcbiAgICB9KTtcbiAgICBhd2FpdCB0aGlzLnNoZWxsKFsnc3RhcnQnXSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zdCB7bWVzc2FnZX0gPSBlO1xuXG4gICAgLy8gcHJvdmlkZSBhIGhlbHBmdWwgZXJyb3IgbWVzc2FnZSBpZiB0aGUgcmVhc29uIHJlYm9vdCBmYWlsZWQgd2FzIGJlY2F1c2UgQURCIGNvdWxkbid0IGdhaW4gcm9vdCBhY2Nlc3NcbiAgICBpZiAobWVzc2FnZS5pbmNsdWRlcygnbXVzdCBiZSByb290JykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IHJlYm9vdCBkZXZpY2UuIFJlYm9vdGluZyByZXF1aXJlcyByb290IGFjY2VzcyBhbmQgYCArXG4gICAgICAgIGBhdHRlbXB0IHRvIGdldCByb290IGFjY2VzcyBvbiBkZXZpY2UgZmFpbGVkIHdpdGggZXJyb3I6ICcke21lc3NhZ2V9J2ApO1xuICAgIH1cbiAgICB0aHJvdyBlO1xuICB9IGZpbmFsbHkge1xuICAgIC8vIFJldHVybiByb290IHN0YXRlIHRvIHdoYXQgaXQgd2FzIGJlZm9yZVxuICAgIGlmICghd2FzQWxyZWFkeVJvb3RlZCkge1xuICAgICAgYXdhaXQgdGhpcy51bnJvb3QoKTtcbiAgICB9XG4gIH1cbiAgY29uc3QgdGltZXIgPSBuZXcgdGltaW5nLlRpbWVyKCkuc3RhcnQoKTtcbiAgYXdhaXQgcmV0cnlJbnRlcnZhbChyZXRyaWVzLCAxMDAwLCBhc3luYyAoKSA9PiB7XG4gICAgaWYgKChhd2FpdCB0aGlzLmdldERldmljZVByb3BlcnR5KCdzeXMuYm9vdF9jb21wbGV0ZWQnKSkgPT09ICcxJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvLyB3ZSBkb24ndCB3YW50IHRoZSBzdGFjayB0cmFjZSwgc28gbm8gbG9nLmVycm9yQW5kVGhyb3dcbiAgICBjb25zdCBtc2cgPSBgUmVib290IGlzIG5vdCBjb21wbGV0ZWQgYWZ0ZXIgJHt0aW1lci5nZXREdXJhdGlvbigpLmFzTWlsbGlTZWNvbmRzLnRvRml4ZWQoMCl9bXNgO1xuICAgIGxvZy5kZWJ1Zyhtc2cpO1xuICAgIHRocm93IG5ldyBFcnJvcihtc2cpO1xuICB9KTtcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gcm9vdFJlc3VsdFxuICogQHByb3BlcnR5IHtib29sZWFufSBpc1N1Y2Nlc3NmdWwgVHJ1ZSBpZiB0aGUgY2FsbCB0byByb290L3Vucm9vdCB3YXMgc3VjY2Vzc2Z1bFxuICogQHByb3BlcnR5IHtib29sZWFufSB3YXNBbHJlYWR5Um9vdGVkIFRydWUgaWYgdGhlIGRldmljZSB3YXMgYWxyZWFkeSByb290ZWRcbiAqL1xuXG4vKipcbiAqIFN3aXRjaCBhZGIgc2VydmVyIHJvb3QgcHJpdmlsZWdlcy5cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNFbGV2YXRlZCAtIFNob3VsZCB3ZSBlbGV2YXRlIHRvIHRvIHJvb3Qgb3IgdW5yb290PyAoZGVmYXVsdCB0cnVlKVxuICogQHJldHVybiB7cm9vdFJlc3VsdH1cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMuY2hhbmdlVXNlclByaXZpbGVnZXMgPSBhc3luYyBmdW5jdGlvbiBjaGFuZ2VVc2VyUHJpdmlsZWdlcyAoaXNFbGV2YXRlZCkge1xuICBjb25zdCBjbWQgPSBpc0VsZXZhdGVkID8gJ3Jvb3QnIDogJ3Vucm9vdCc7XG5cbiAgY29uc3QgcmV0cnlJZk9mZmxpbmUgPSBhc3luYyAoY21kRnVuYykgPT4ge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgY21kRnVuYygpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgLy8gQ2hlY2sgdGhlIG91dHB1dCBvZiB0aGUgc3RkRXJyIHRvIHNlZSBpZiB0aGVyZSdzIGFueSBjbHVlcyB0aGF0IHNob3cgdGhhdCB0aGUgZGV2aWNlIHdlbnQgb2ZmbGluZVxuICAgICAgLy8gYW5kIGlmIGl0IGRpZCBnbyBvZmZsaW5lLCByZXN0YXJ0IEFEQlxuICAgICAgaWYgKFsnY2xvc2VkJywgJ2RldmljZSBvZmZsaW5lJywgJ3RpbWVvdXQgZXhwaXJlZCddXG4gICAgICAgICAgLnNvbWUoKHgpID0+IChlcnIuc3RkZXJyIHx8ICcnKS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHgpKSkge1xuICAgICAgICBsb2cud2FybihgQXR0ZW1wdCB0byAke2NtZH0gY2F1c2VkIEFEQiB0byB0aGluayB0aGUgZGV2aWNlIHdlbnQgb2ZmbGluZWApO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IHRoaXMucmVjb25uZWN0KCk7XG4gICAgICAgIH0gY2F0Y2ggKGlnbikge1xuICAgICAgICAgIGF3YWl0IHRoaXMucmVzdGFydEFkYigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhd2FpdCBjbWRGdW5jKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBlcnI7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8vIElmIGl0J3MgYWxyZWFkeSByb290ZWQsIG91ciBqb2IgaXMgZG9uZS4gTm8gbmVlZCB0byByb290IGl0IGFnYWluLlxuICBjb25zdCBpc1Jvb3QgPSBhd2FpdCByZXRyeUlmT2ZmbGluZShhc3luYyAoKSA9PiBhd2FpdCB0aGlzLmlzUm9vdCgpKTtcbiAgaWYgKChpc1Jvb3QgJiYgaXNFbGV2YXRlZCkgfHwgKCFpc1Jvb3QgJiYgIWlzRWxldmF0ZWQpKSB7XG4gICAgcmV0dXJuIHtpc1N1Y2Nlc3NmdWw6IHRydWUsIHdhc0FscmVhZHlSb290ZWQ6IGlzUm9vdH07XG4gIH1cblxuICBsZXQgd2FzQWxyZWFkeVJvb3RlZCA9IGlzUm9vdDtcbiAgdHJ5IHtcbiAgICBjb25zdCB7c3Rkb3V0fSA9IGF3YWl0IHJldHJ5SWZPZmZsaW5lKGFzeW5jICgpID0+IGF3YWl0IHRoaXMuYWRiRXhlYyhbY21kXSkpO1xuICAgIGxvZy5kZWJ1ZyhzdGRvdXQpO1xuXG4gICAgLy8gb24gcmVhbCBkZXZpY2VzIGluIHNvbWUgc2l0dWF0aW9ucyB3ZSBnZXQgYW4gZXJyb3IgaW4gdGhlIHN0ZG91dFxuICAgIGlmIChzdGRvdXQpIHtcbiAgICAgIGlmIChzdGRvdXQuaW5jbHVkZXMoJ2FkYmQgY2Fubm90IHJ1biBhcyByb290JykpIHtcbiAgICAgICAgcmV0dXJuIHtpc1N1Y2Nlc3NmdWw6IGZhbHNlLCB3YXNBbHJlYWR5Um9vdGVkfTtcbiAgICAgIH1cbiAgICAgIC8vIGlmIHRoZSBkZXZpY2Ugd2FzIGFscmVhZHkgcm9vdGVkLCByZXR1cm4gdGhhdCBpbiB0aGUgcmVzdWx0XG4gICAgICBpZiAoc3Rkb3V0LmluY2x1ZGVzKCdhbHJlYWR5IHJ1bm5pbmcgYXMgcm9vdCcpKSB7XG4gICAgICAgIHdhc0FscmVhZHlSb290ZWQgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge2lzU3VjY2Vzc2Z1bDogdHJ1ZSwgd2FzQWxyZWFkeVJvb3RlZH07XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGNvbnN0IHtzdGRlcnIgPSAnJywgbWVzc2FnZX0gPSBlcnI7XG4gICAgbG9nLndhcm4oYFVuYWJsZSB0byAke2NtZH0gYWRiIGRhZW1vbi4gT3JpZ2luYWwgZXJyb3I6ICcke21lc3NhZ2V9Jy4gU3RkZXJyOiAnJHtzdGRlcnJ9Jy4gQ29udGludWluZy5gKTtcbiAgICByZXR1cm4ge2lzU3VjY2Vzc2Z1bDogZmFsc2UsIHdhc0FscmVhZHlSb290ZWR9O1xuICB9XG59O1xuXG4vKipcbiAqIFN3aXRjaCBhZGIgc2VydmVyIHRvIHJvb3QgbW9kZVxuICogQHJldHVybiB7cm9vdFJlc3VsdH1cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMucm9vdCA9IGFzeW5jIGZ1bmN0aW9uIHJvb3QgKCkge1xuICByZXR1cm4gYXdhaXQgdGhpcy5jaGFuZ2VVc2VyUHJpdmlsZWdlcyh0cnVlKTtcbn07XG5cbi8qKlxuICogU3dpdGNoIGFkYiBzZXJ2ZXIgdG8gbm9uLXJvb3QgbW9kZS5cbiAqXG4gKiBAcmV0dXJuIHtyb290UmVzdWx0fVxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy51bnJvb3QgPSBhc3luYyBmdW5jdGlvbiB1bnJvb3QgKCkge1xuICByZXR1cm4gYXdhaXQgdGhpcy5jaGFuZ2VVc2VyUHJpdmlsZWdlcyhmYWxzZSk7XG59O1xuXG4vKipcbiAqIENoZWNrcyB3aGV0aGVyIHRoZSBjdXJyZW50IHVzZXIgaXMgcm9vdFxuICpcbiAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgdGhlIHVzZXIgaXMgcm9vdFxuICogQHRocm93cyB7RXJyb3J9IGlmIHRoZXJlIHdhcyBhbiBlcnJvciB3aGlsZSBpZGVudGlmeWluZ1xuICogdGhlIHVzZXIuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmlzUm9vdCA9IGFzeW5jIGZ1bmN0aW9uIGlzUm9vdCAoKSB7XG4gIHJldHVybiAoYXdhaXQgdGhpcy5zaGVsbChbJ3dob2FtaSddKSkudHJpbSgpID09PSAncm9vdCc7XG59O1xuXG4vKipcbiAqIFZlcmlmeSB3aGV0aGVyIGEgcmVtb3RlIHBhdGggZXhpc3RzIG9uIHRoZSBkZXZpY2UgdW5kZXIgdGVzdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcmVtb3RlUGF0aCAtIFRoZSByZW1vdGUgcGF0aCB0byB2ZXJpZnkuXG4gKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIHRoZSBnaXZlbiBwYXRoIGV4aXN0cyBvbiB0aGUgZGV2aWNlLlxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5maWxlRXhpc3RzID0gYXN5bmMgZnVuY3Rpb24gZmlsZUV4aXN0cyAocmVtb3RlUGF0aCkge1xuICBjb25zdCBwYXNzRmxhZyA9ICdfX1BBU1NfXyc7XG4gIGNvbnN0IGNoZWNrQ21kID0gYFsgLWUgJyR7cmVtb3RlUGF0aC5yZXBsYWNlKC8nL2csIGBcXFxcJ2ApfScgXSAmJiBlY2hvICR7cGFzc0ZsYWd9YDtcbiAgdHJ5IHtcbiAgICByZXR1cm4gXy5pbmNsdWRlcyhhd2FpdCB0aGlzLnNoZWxsKFtjaGVja0NtZF0pLCBwYXNzRmxhZyk7XG4gIH0gY2F0Y2ggKGlnbikge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufTtcblxuLyoqXG4gKiBHZXQgdGhlIG91dHB1dCBvZiBfbHNfIGNvbW1hbmQgb24gdGhlIGRldmljZSB1bmRlciB0ZXN0LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSByZW1vdGVQYXRoIC0gVGhlIHJlbW90ZSBwYXRoICh0aGUgZmlyc3QgYXJndW1lbnQgdG8gdGhlIF9sc18gY29tbWFuZCkuXG4gKiBAcGFyYW0ge0FycmF5LjxTdHJpbmc+fSBvcHRzIFtbXV0gLSBBZGRpdGlvbmFsIF9sc18gb3B0aW9ucy5cbiAqIEByZXR1cm4ge0FycmF5LjxTdHJpbmc+fSBUaGUgX2xzXyBvdXRwdXQgYXMgYW4gYXJyYXkgb2Ygc3BsaXQgbGluZXMuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgQW4gZW1wdHkgYXJyYXkgaXMgcmV0dXJuZWQgb2YgdGhlIGdpdmVuIF9yZW1vdGVQYXRoX1xuICogICAgICAgICAgICAgICAgICAgICAgICAgIGRvZXMgbm90IGV4aXN0LlxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5scyA9IGFzeW5jIGZ1bmN0aW9uIGxzIChyZW1vdGVQYXRoLCBvcHRzID0gW10pIHtcbiAgdHJ5IHtcbiAgICBsZXQgYXJncyA9IFsnbHMnLCAuLi5vcHRzLCByZW1vdGVQYXRoXTtcbiAgICBsZXQgc3Rkb3V0ID0gYXdhaXQgdGhpcy5zaGVsbChhcmdzKTtcbiAgICBsZXQgbGluZXMgPSBzdGRvdXQuc3BsaXQoJ1xcbicpO1xuICAgIHJldHVybiBsaW5lcy5tYXAoKGwpID0+IGwudHJpbSgpKVxuICAgICAgLmZpbHRlcihCb29sZWFuKVxuICAgICAgLmZpbHRlcigobCkgPT4gbC5pbmRleE9mKCdObyBzdWNoIGZpbGUnKSA9PT0gLTEpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBpZiAoZXJyLm1lc3NhZ2UuaW5kZXhPZignTm8gc3VjaCBmaWxlIG9yIGRpcmVjdG9yeScpID09PSAtMSkge1xuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgICByZXR1cm4gW107XG4gIH1cbn07XG5cbi8qKlxuICogR2V0IHRoZSBzaXplIG9mIHRoZSBwYXJ0aWN1bGFyIGZpbGUgbG9jYXRlZCBvbiB0aGUgZGV2aWNlIHVuZGVyIHRlc3QuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHJlbW90ZVBhdGggLSBUaGUgcmVtb3RlIHBhdGggdG8gdGhlIGZpbGUuXG4gKiBAcmV0dXJuIHtudW1iZXJ9IEZpbGUgc2l6ZSBpbiBieXRlcy5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGVyZSB3YXMgYW4gZXJyb3Igd2hpbGUgZ2V0dGluZyB0aGUgc2l6ZSBvZiB0aGUgZ2l2ZW4gZmlsZS5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMuZmlsZVNpemUgPSBhc3luYyBmdW5jdGlvbiBmaWxlU2l6ZSAocmVtb3RlUGF0aCkge1xuICB0cnkge1xuICAgIGNvbnN0IGZpbGVzID0gYXdhaXQgdGhpcy5scyhyZW1vdGVQYXRoLCBbJy1sYSddKTtcbiAgICBpZiAoZmlsZXMubGVuZ3RoICE9PSAxKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFJlbW90ZSBwYXRoIGlzIG5vdCBhIGZpbGVgKTtcbiAgICB9XG4gICAgLy8gaHR0cHM6Ly9yZWdleDEwMS5jb20vci9mT3M0UDQvOFxuICAgIGNvbnN0IG1hdGNoID0gL1tyd3hzU3RUXFwtK117MTB9W1xcc1xcZF0qXFxzW15cXHNdK1xccytbXlxcc10rXFxzKyhcXGQrKS8uZXhlYyhmaWxlc1swXSk7XG4gICAgaWYgKCFtYXRjaCB8fCBfLmlzTmFOKHBhcnNlSW50KG1hdGNoWzFdLCAxMCkpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuYWJsZSB0byBwYXJzZSBzaXplIGZyb20gbGlzdCBvdXRwdXQ6ICcke2ZpbGVzWzBdfSdgKTtcbiAgICB9XG4gICAgcmV0dXJuIHBhcnNlSW50KG1hdGNoWzFdLCAxMCk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHRocm93IG5ldyBFcnJvcihgVW5hYmxlIHRvIGdldCBmaWxlIHNpemUgZm9yICcke3JlbW90ZVBhdGh9JzogJHtlcnIubWVzc2FnZX1gKTtcbiAgfVxufTtcblxuLyoqXG4gKiBJbnN0YWxscyB0aGUgZ2l2ZW4gY2VydGlmaWNhdGUgb24gYSByb290ZWQgcmVhbCBkZXZpY2Ugb3JcbiAqIGFuIGVtdWxhdG9yLiBUaGUgZW11bGF0b3IgbXVzdCBiZSBleGVjdXRlZCB3aXRoIGAtd3JpdGFibGUtc3lzdGVtYFxuICogY29tbWFuZCBsaW5lIG9wdGlvbiBhbmQgYWRiIGRhZW1vbiBzaG91bGQgYmUgcnVubmluZyBpbiByb290XG4gKiBtb2RlIGZvciB0aGlzIG1ldGhvZCB0byB3b3JrIHByb3Blcmx5LiBUaGUgbWV0aG9kIGFsc28gcmVxdWlyZXNcbiAqIG9wZW5zc2wgdG9vbCB0byBiZSBhdmFpbGFibGUgb24gdGhlIGRlc3RpbmF0aW9uIHN5c3RlbS5cbiAqIFJlYWQgaHR0cHM6Ly9naXRodWIuY29tL2FwcGl1bS9hcHBpdW0vaXNzdWVzLzEwOTY0XG4gKiBmb3IgbW9yZSBkZXRhaWxzIG9uIHRoaXMgdG9waWNcbiAqXG4gKiBAcGFyYW0ge0J1ZmZlcnxzdHJpbmd9IGNlcnQgLSBiYXNlNjQtZGVjb2RlZCBjb250ZW50IG9mIHRoZSBhY3R1YWwgY2VydGlmaWNhdGVcbiAqIHJlcHJlc2VudGVkIGFzIGEgc3RyaW5nIG9yIGEgYnVmZmVyXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgb3BlbnNzbCB0b29sIGlzIG5vdCBhdmFpbGFibGUgb24gdGhlIGRlc3RpbmF0aW9uIHN5c3RlbVxuICogb3IgaWYgdGhlcmUgd2FzIGFuIGVycm9yIHdoaWxlIGluc3RhbGxpbmcgdGhlIGNlcnRpZmljYXRlXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmluc3RhbGxNaXRtQ2VydGlmaWNhdGUgPSBhc3luYyBmdW5jdGlvbiBpbnN0YWxsTWl0bUNlcnRpZmljYXRlIChjZXJ0KSB7XG4gIGNvbnN0IG9wZW5Tc2wgPSBhd2FpdCBnZXRPcGVuU3NsRm9yT3MoKTtcblxuICBpZiAoIV8uaXNCdWZmZXIoY2VydCkpIHtcbiAgICBjZXJ0ID0gQnVmZmVyLmZyb20oY2VydCwgJ2Jhc2U2NCcpO1xuICB9XG5cbiAgY29uc3QgdG1wUm9vdCA9IGF3YWl0IHRlbXBEaXIub3BlbkRpcigpO1xuICB0cnkge1xuICAgIGNvbnN0IHNyY0NlcnQgPSBwYXRoLnJlc29sdmUodG1wUm9vdCwgJ3NvdXJjZS5jZXInKTtcbiAgICBhd2FpdCBmcy53cml0ZUZpbGUoc3JjQ2VydCwgY2VydCk7XG4gICAgbGV0IHtzdGRvdXR9ID0gYXdhaXQgZXhlYyhvcGVuU3NsLCBbJ3g1MDknLCAnLW5vb3V0JywgJy1oYXNoJywgJy1pbicsIHNyY0NlcnRdKTtcbiAgICBjb25zdCBjZXJ0SGFzaCA9IHN0ZG91dC50cmltKCk7XG4gICAgbG9nLmRlYnVnKGBHb3QgY2VydGlmaWNhdGUgaGFzaDogJHtjZXJ0SGFzaH1gKTtcbiAgICBsb2cuZGVidWcoJ1ByZXBhcmluZyBjZXJ0aWZpY2F0ZSBjb250ZW50Jyk7XG4gICAgKHtzdGRvdXR9ID0gYXdhaXQgZXhlYyhvcGVuU3NsLCBbJ3g1MDknLCAnLWluJywgc3JjQ2VydF0sIHtpc0J1ZmZlcjogdHJ1ZX0pKTtcbiAgICBsZXQgZHN0Q2VydENvbnRlbnQgPSBzdGRvdXQ7XG4gICAgKHtzdGRvdXR9ID0gYXdhaXQgZXhlYyhvcGVuU3NsLCBbJ3g1MDknLFxuICAgICAgJy1pbicsIHNyY0NlcnQsXG4gICAgICAnLXRleHQnLFxuICAgICAgJy1maW5nZXJwcmludCcsXG4gICAgICAnLW5vb3V0J10sIHtpc0J1ZmZlcjogdHJ1ZX0pKTtcbiAgICBkc3RDZXJ0Q29udGVudCA9IEJ1ZmZlci5jb25jYXQoW2RzdENlcnRDb250ZW50LCBzdGRvdXRdKTtcbiAgICBjb25zdCBkc3RDZXJ0ID0gcGF0aC5yZXNvbHZlKHRtcFJvb3QsIGAke2NlcnRIYXNofS4wYCk7XG4gICAgYXdhaXQgZnMud3JpdGVGaWxlKGRzdENlcnQsIGRzdENlcnRDb250ZW50KTtcbiAgICBsb2cuZGVidWcoJ1JlbW91bnRpbmcgL3N5c3RlbSBpbiBydyBtb2RlJyk7XG4gICAgLy8gU29tZXRpbWVzIGVtdWxhdG9yIHJlYm9vdCBpcyBzdGlsbCBub3QgZnVsbHkgZmluaXNoZWQgb24gdGhpcyBzdGFnZSwgc28gcmV0cnlcbiAgICBhd2FpdCByZXRyeUludGVydmFsKDUsIDIwMDAsIGFzeW5jICgpID0+IGF3YWl0IHRoaXMuYWRiRXhlYyhbJ3JlbW91bnQnXSkpO1xuICAgIGxvZy5kZWJ1ZyhgVXBsb2FkaW5nIHRoZSBnZW5lcmF0ZWQgY2VydGlmaWNhdGUgZnJvbSAnJHtkc3RDZXJ0fScgdG8gJyR7Q0VSVFNfUk9PVH0nYCk7XG4gICAgYXdhaXQgdGhpcy5wdXNoKGRzdENlcnQsIENFUlRTX1JPT1QpO1xuICAgIGxvZy5kZWJ1ZygnUmVtb3VudGluZyAvc3lzdGVtIHRvIGNvbmZpcm0gY2hhbmdlcycpO1xuICAgIGF3YWl0IHRoaXMuYWRiRXhlYyhbJ3JlbW91bnQnXSk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IGluamVjdCB0aGUgY3VzdG9tIGNlcnRpZmljYXRlLiBgICtcbiAgICAgICAgICAgICAgICAgICAgYElzIHRoZSBjZXJ0aWZpY2F0ZSBwcm9wZXJseSBlbmNvZGVkIGludG8gYmFzZTY0LXN0cmluZz8gYCArXG4gICAgICAgICAgICAgICAgICAgIGBEbyB5b3UgaGF2ZSByb290IHBlcm1pc3Npb25zIG9uIHRoZSBkZXZpY2U/IGAgK1xuICAgICAgICAgICAgICAgICAgICBgT3JpZ2luYWwgZXJyb3I6ICR7ZXJyLm1lc3NhZ2V9YCk7XG4gIH0gZmluYWxseSB7XG4gICAgYXdhaXQgZnMucmltcmFmKHRtcFJvb3QpO1xuICB9XG59O1xuXG4vKipcbiAqIFZlcmlmaWVzIGlmIHRoZSBnaXZlbiByb290IGNlcnRpZmljYXRlIGlzIGFscmVhZHkgaW5zdGFsbGVkIG9uIHRoZSBkZXZpY2UuXG4gKlxuICogQHBhcmFtIHtCdWZmZXJ8c3RyaW5nfSBjZXJ0IC0gYmFzZTY0LWRlY29kZWQgY29udGVudCBvZiB0aGUgYWN0dWFsIGNlcnRpZmljYXRlXG4gKiByZXByZXNlbnRlZCBhcyBhIHN0cmluZyBvciBhIGJ1ZmZlclxuICogQHRocm93cyB7RXJyb3J9IElmIG9wZW5zc2wgdG9vbCBpcyBub3QgYXZhaWxhYmxlIG9uIHRoZSBkZXN0aW5hdGlvbiBzeXN0ZW1cbiAqIG9yIGlmIHRoZXJlIHdhcyBhbiBlcnJvciB3aGlsZSBjaGVja2luZyB0aGUgY2VydGlmaWNhdGVcbiAqIEByZXR1cm5zIHtib29sZWFufSB0cnVlIGlmIHRoZSBnaXZlbiBjZXJ0aWZpY2F0ZSBpcyBhbHJlYWR5IGluc3RhbGxlZFxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5pc01pdG1DZXJ0aWZpY2F0ZUluc3RhbGxlZCA9IGFzeW5jIGZ1bmN0aW9uIGlzTWl0bUNlcnRpZmljYXRlSW5zdGFsbGVkIChjZXJ0KSB7XG4gIGNvbnN0IG9wZW5Tc2wgPSBhd2FpdCBnZXRPcGVuU3NsRm9yT3MoKTtcblxuICBpZiAoIV8uaXNCdWZmZXIoY2VydCkpIHtcbiAgICBjZXJ0ID0gQnVmZmVyLmZyb20oY2VydCwgJ2Jhc2U2NCcpO1xuICB9XG5cbiAgY29uc3QgdG1wUm9vdCA9IGF3YWl0IHRlbXBEaXIub3BlbkRpcigpO1xuICBsZXQgY2VydEhhc2g7XG4gIHRyeSB7XG4gICAgY29uc3QgdG1wQ2VydCA9IHBhdGgucmVzb2x2ZSh0bXBSb290LCAnc291cmNlLmNlcicpO1xuICAgIGF3YWl0IGZzLndyaXRlRmlsZSh0bXBDZXJ0LCBjZXJ0KTtcbiAgICBjb25zdCB7c3Rkb3V0fSA9IGF3YWl0IGV4ZWMob3BlblNzbCwgWyd4NTA5JywgJy1ub291dCcsICctaGFzaCcsICctaW4nLCB0bXBDZXJ0XSk7XG4gICAgY2VydEhhc2ggPSBzdGRvdXQudHJpbSgpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCByZXRyaWV2ZSB0aGUgY2VydGlmaWNhdGUgaGFzaC4gYCArXG4gICAgICAgICAgICAgICAgICAgIGBJcyB0aGUgY2VydGlmaWNhdGUgcHJvcGVybHkgZW5jb2RlZCBpbnRvIGJhc2U2NC1zdHJpbmc/IGAgK1xuICAgICAgICAgICAgICAgICAgICBgT3JpZ2luYWwgZXJyb3I6ICR7ZXJyLm1lc3NhZ2V9YCk7XG4gIH0gZmluYWxseSB7XG4gICAgYXdhaXQgZnMucmltcmFmKHRtcFJvb3QpO1xuICB9XG4gIGNvbnN0IGRzdFBhdGggPSBwYXRoLnBvc2l4LnJlc29sdmUoQ0VSVFNfUk9PVCwgYCR7Y2VydEhhc2h9LjBgKTtcbiAgbG9nLmRlYnVnKGBDaGVja2luZyBpZiB0aGUgY2VydGlmaWNhdGUgaXMgYWxyZWFkeSBpbnN0YWxsZWQgYXQgJyR7ZHN0UGF0aH0nYCk7XG4gIHJldHVybiBhd2FpdCB0aGlzLmZpbGVFeGlzdHMoZHN0UGF0aCk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBzeXN0ZW1DYWxsTWV0aG9kcztcbmV4cG9ydCB7IERFRkFVTFRfQURCX0VYRUNfVElNRU9VVCwgZ2V0QW5kcm9pZEJpbmFyeVBhdGggfTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBQUEsS0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsT0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsU0FBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsUUFBQSxHQUFBSCxPQUFBO0FBQ0EsSUFBQUksUUFBQSxHQUFBSixPQUFBO0FBSUEsSUFBQUssYUFBQSxHQUFBTCxPQUFBO0FBQ0EsSUFBQU0sU0FBQSxHQUFBTixPQUFBO0FBQ0EsSUFBQU8sT0FBQSxHQUFBUixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQVEsT0FBQSxHQUFBVCxzQkFBQSxDQUFBQyxPQUFBO0FBR0EsSUFBSVMsaUJBQWlCLEdBQUcsQ0FBQyxDQUFDO0FBRTFCLE1BQU1DLDBCQUEwQixHQUFHLEVBQUU7QUFDckMsTUFBTUMscUJBQXFCLEdBQUcsc0JBQXNCO0FBQ3BELE1BQU1DLHdCQUF3QixHQUFHLENBQy9CLCtCQUErQixFQUMvQixrQ0FBa0MsRUFDbEMsaUNBQWlDLENBQ2xDO0FBQ0QsTUFBTUMsc0JBQXNCLEdBQUcsMEJBQTBCO0FBQ3pELE1BQU1DLHNCQUFzQixHQUFHLHlDQUF5QztBQUN4RSxNQUFNQyxVQUFVLEdBQUcsOEJBQThCO0FBQ2pELE1BQU1DLGdCQUFnQixHQUFHLENBQ3ZCLGdCQUFnQixFQUNoQixVQUFVLEVBQ1YsQ0FBQyxlQUFlLEVBQUUsUUFBUSxFQUFFLEtBQUssQ0FBQyxFQUNsQyxPQUFPLEVBQ1AsQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLEVBQ2hCLEdBQUcsQ0FDSjtBQUNELE1BQU1DLHVCQUF1QixHQUFHLEVBQUU7QUFDbEMsTUFB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