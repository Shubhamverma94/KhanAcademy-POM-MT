"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.REMOTE_CACHE_ROOT = void 0;
require("source-map-support/register");
var _helpers = require("../helpers.js");
var _teen_process = require("teen_process");
var _logger = _interopRequireDefault(require("../logger.js"));
var _path = _interopRequireDefault(require("path"));
var _lodash = _interopRequireDefault(require("lodash"));
var _asyncbox = require("asyncbox");
var _support = require("@appium/support");
var _semver = _interopRequireDefault(require("semver"));
var _os = _interopRequireDefault(require("os"));
var _lruCache = _interopRequireDefault(require("lru-cache"));
var _adbkitApkreader = _interopRequireDefault(require("adbkit-apkreader"));
const apkUtilsMethods = {};
apkUtilsMethods.APP_INSTALL_STATE = {
  UNKNOWN: 'unknown',
  NOT_INSTALLED: 'notInstalled',
  NEWER_VERSION_INSTALLED: 'newerVersionInstalled',
  SAME_VERSION_INSTALLED: 'sameVersionInstalled',
  OLDER_VERSION_INSTALLED: 'olderVersionInstalled'
};
const REMOTE_CACHE_ROOT = '/data/local/tmp/appium_cache';
exports.REMOTE_CACHE_ROOT = REMOTE_CACHE_ROOT;
const RESOLVER_ACTIVITY_NAME = 'android/com.android.internal.app.ResolverActivity';
apkUtilsMethods.isAppInstalled = async function isAppInstalled(pkg) {
  _logger.default.debug(`Getting install status for ${pkg}`);
  const installedPattern = new RegExp(`^\\s*Package\\s+\\[${_lodash.default.escapeRegExp(pkg)}\\][^:]+:$`, 'm');
  try {
    const stdout = await this.shell(['dumpsys', 'package', pkg]);
    const isInstalled = installedPattern.test(stdout);
    _logger.default.debug(`'${pkg}' is${!isInstalled ? ' not' : ''} installed`);
    return isInstalled;
  } catch (e) {
    throw new Error(`Error finding if '${pkg}' is installed. Original error: ${e.message}`);
  }
};
apkUtilsMethods.startUri = async function startUri(uri, pkg, opts = {}) {
  const {
    waitForLaunch = true
  } = opts;
  if (!uri || !pkg) {
    throw new Error('URI and package arguments are required');
  }
  const args = ['am', 'start'];
  if (waitForLaunch) {
    args.push('-W');
  }
  args.push('-a', 'android.intent.action.VIEW', '-d', (0, _helpers.escapeShellArg)(uri), pkg);
  try {
    const res = await this.shell(args);
    if (res.toLowerCase().includes('unable to resolve intent')) {
      throw new Error(res);
    }
  } catch (e) {
    throw new Error(`Error attempting to start URI. Original error: ${e}`);
  }
};
apkUtilsMethods.startApp = async function startApp(startAppOptions = {}) {
  if (!startAppOptions.pkg || !(startAppOptions.activity || startAppOptions.action)) {
    throw new Error('pkg, and activity or intent action, are required to start an application');
  }
  startAppOptions = _lodash.default.clone(startAppOptions);
  if (startAppOptions.activity) {
    startAppOptions.activity = startAppOptions.activity.replace('$', '\\$');
  }
  _lodash.default.defaults(startAppOptions, {
    waitPkg: startAppOptions.pkg,
    waitForLaunch: true,
    waitActivity: false,
    retry: true,
    stopApp: true
  });
  startAppOptions.waitPkg = startAppOptions.waitPkg || startAppOptions.pkg;
  const apiLevel = await this.getApiLevel();
  const cmd = (0, _helpers.buildStartCmd)(startAppOptions, apiLevel);
  const intentName = `${startAppOptions.action}${startAppOptions.optionalIntentArguments ? ' ' + startAppOptions.optionalIntentArguments : ''}`;
  try {
    const shellOpts = {};
    if (_lodash.default.isInteger(startAppOptions.waitDuration) && startAppOptions.waitDuration >= 0) {
      shellOpts.timeout = startAppOptions.waitDuration;
    }
    const stdout = await this.shell(cmd, shellOpts);
    if (stdout.includes('Error: Activity class') && stdout.includes('does not exist')) {
      if (startAppOptions.retry && !startAppOptions.activity.startsWith('.')) {
        _logger.default.debug(`We tried to start an activity that doesn't exist, ` + `retrying with '.${startAppOptions.activity}' activity name`);
        startAppOptions.activity = `.${startAppOptions.activity}`;
        startAppOptions.retry = false;
        return await this.startApp(startAppOptions);
      }
      throw new Error(`Activity name '${startAppOptions.activity}' used to start the app doesn't ` + `exist or cannot be launched! Make sure it exists and is a launchable activity`);
    } else if (stdout.includes('Error: Intent does not match any activities') || stdout.includes('Error: Activity not started, unable to resolve Intent')) {
      throw new Error(`Activity for intent '${intentName}' used to start the app doesn't ` + `exist or cannot be launched! Make sure it exists and is a launchable activity`);
    } else if (stdout.includes('java.lang.SecurityException')) {
      throw new Error(`The permission to start '${startAppOptions.activity}' activity has been denied.` + `Make sure the activity/package names are correct.`);
    }
    if (startAppOptions.waitActivity) {
      await this.waitForActivity(startAppOptions.waitPkg, startAppOptions.waitActivity, startAppOptions.waitDuration);
    }
    return stdout;
  } catch (e) {
    const appDescriptor = startAppOptions.pkg || intentName;
    throw new Error(`Cannot start the '${appDescriptor}' application. ` + `Consider checking the driver's troubleshooting documentation. ` + `Original error: ${e.message}`);
  }
};
apkUtilsMethods.dumpWindows = async function dumpWindows() {
  const apiLevel = await this.getApiLevel();
  const dumpsysArg = apiLevel >= 29 ? 'displays' : 'windows';
  const cmd = ['dumpsys', 'window', dumpsysArg];
  return await this.shell(cmd);
};
apkUtilsMethods.getFocusedPackageAndActivity = async function getFocusedPackageAndActivity() {
  _logger.default.debug('Getting focused package and activity');
  let stdout;
  try {
    stdout = await this.dumpWindows();
  } catch (e) {
    throw new Error(`Could not retrieve the currently focused package and activity. Original error: ${e.message}`);
  }
  const nullFocusedAppRe = /^\s*mFocusedApp=null/m;
  const focusedAppRe = new RegExp('^\\s*mFocusedApp.+Record\\{.*\\s([^\\s\\/\\}]+)\\/([^\\s\\/\\}\\,]+)\\,?(\\s[^\\s\\/\\}]+)*\\}', 'mg');
  const nullCurrentFocusRe = /^\s*mCurrentFocus=null/m;
  const currentFocusAppRe = new RegExp('^\\s*mCurrentFocus.+\\{.+\\s([^\\s\\/]+)\\/([^\\s]+)\\b', 'mg');
  const focusedAppCandidates = [];
  const currentFocusAppCandidates = [];
  for (const [candidates, pattern] of [[focusedAppCandidates, focusedAppRe], [currentFocusAppCandidates, currentFocusAppRe]]) {
    let match;
    while (match = pattern.exec(stdout)) {
      candidates.push({
        appPackage: match[1].trim(),
        appActivity: match[2].trim()
      });
    }
  }
  if (focusedAppCandidates.length > 1 && currentFocusAppCandidates.length > 0) {
    return _lodash.default.intersectionWith(focusedAppCandidates, currentFocusAppCandidates, _lodash.default.isEqual)[0] ?? focusedAppCandidates[0];
  }
  if (focusedAppCandidates.length > 0 || currentFocusAppCandidates.length > 0) {
    return focusedAppCandidates[0] ?? currentFocusAppCandidates[0];
  }
  for (const pattern of [nullFocusedAppRe, nullCurrentFocusRe]) {
    if (pattern.exec(stdout)) {
      return {
        appPackage: null,
        appActivity: null
      };
    }
  }
  _logger.default.debug(stdout);
  throw new Error('Could not retrieve the currently focused package and activity');
};
apkUtilsMethods.waitForActivityOrNot = async function waitForActivityOrNot(pkg, activity, waitForStop, waitMs = 20000) {
  if (!pkg || !activity) {
    throw new Error('Package and activity required.');
  }
  _logger.default.debug(`Waiting up to ${waitMs}ms for activity matching pkg: '${pkg}' and ` + `activity: '${activity}' to${waitForStop ? ' not' : ''} be focused`);
  const splitNames = names => names.split(',').map(name => name.trim());
  const allPackages = splitNames(pkg);
  const allActivities = splitNames(activity);
  const possibleActivityNames = [];
  for (const oneActivity of allActivities) {
    if (oneActivity.startsWith('.')) {
      for (const currentPkg of allPackages) {
        possibleActivityNames.push(`${currentPkg}${oneActivity}`.replace(/\.+/g, '.'));
      }
    } else {
      possibleActivityNames.push(oneActivity);
      possibleActivityNames.push(`${pkg}.${oneActivity}`);
    }
  }
  _logger.default.debug(`Possible activities, to be checked: ${possibleActivityNames.map(name => `'${name}'`).join(', ')}`);
  const possibleActivityPatterns = possibleActivityNames.map(actName => new RegExp(`^${actName.replace(/\./g, '\\.').replace(/\*/g, '.*?').replace(/\$/g, '\\$')}$`));
  const conditionFunc = async () => {
    let appPackage;
    let appActivity;
    try {
      ({
        appPackage,
        appActivity
      } = await this.getFocusedPackageAndActivity());
    } catch (e) {
      _logger.default.debug(e.message);
      return false;
    }
    if (appActivity && appPackage) {
      const fullyQualifiedActivity = appActivity.startsWith('.') ? `${appPackage}${appActivity}` : appActivity;
      _logger.default.debug(`Found package: '${appPackage}' and fully qualified activity name : '${fullyQualifiedActivity}'`);
      const isActivityFound = _lodash.default.includes(allPackages, appPackage) && possibleActivityPatterns.some(p => p.test(fullyQualifiedActivity));
      if (!waitForStop && isActivityFound || waitForStop && !isActivityFound) {
        return true;
      }
    }
    _logger.default.debug('Incorrect package and activity. Retrying.');
    return false;
  };
  try {
    await (0, _asyncbox.waitForCondition)(conditionFunc, {
      waitMs: parseInt(waitMs, 10),
      intervalMs: 500
    });
  } catch (e) {
    throw new Error(`${possibleActivityNames.map(name => `'${name}'`).join(' or ')} never ${waitForStop ? 'stopped' : 'started'}. ` + `Consider checking the driver's troubleshooting documentation.`);
  }
};
apkUtilsMethods.waitForActivity = async function waitForActivity(pkg, act, waitMs = 20000) {
  await this.waitForActivityOrNot(pkg, act, false, waitMs);
};
apkUtilsMethods.waitForNotActivity = async function waitForNotActivity(pkg, act, waitMs = 20000) {
  await this.waitForActivityOrNot(pkg, act, true, waitMs);
};
apkUtilsMethods.uninstallApk = async function uninstallApk(pkg, options = {}) {
  _logger.default.debug(`Uninstalling ${pkg}`);
  if (!(await this.isAppInstalled(pkg))) {
    _logger.default.info(`${pkg} was not uninstalled, because it was not present on the device`);
    return false;
  }
  const cmd = ['uninstall'];
  if (options.keepData) {
    cmd.push('-k');
  }
  cmd.push(pkg);
  let stdout;
  try {
    await this.forceStop(pkg);
    stdout = (await this.adbExec(cmd, {
      timeout: options.timeout
    })).trim();
  } catch (e) {
    throw new Error(`Unable to uninstall APK. Original error: ${e.message}`);
  }
  _logger.default.debug(`'adb ${cmd.join(' ')}' command output: ${stdout}`);
  if (stdout.includes('Success')) {
    _logger.default.info(`${pkg} was successfully uninstalled`);
    return true;
  }
  _logger.default.info(`${pkg} was not uninstalled`);
  return false;
};
apkUtilsMethods.installFromDevicePath = async function installFromDevicePath(apkPathOnDevice, opts = {}) {
  let stdout = await this.shell(['pm', 'install', '-r', apkPathOnDevice], opts);
  if (stdout.indexOf('Failure') !== -1) {
    throw new Error(`Remote install failed: ${stdout}`);
  }
};
apkUtilsMethods.cacheApk = async function cacheApk(apkPath, options = {}) {
  const appHash = await _support.fs.hash(apkPath);
  const remotePath = _path.default.posix.join(REMOTE_CACHE_ROOT, `${appHash}.apk`);
  const remoteCachedFiles = [];
  try {
    const errorMarker = '_ERROR_';
    let lsOutput = null;
    if (this._areExtendedLsOptionsSupported === true || !_lodash.default.isBoolean(this._areExtendedLsOptionsSupported)) {
      lsOutput = await this.shell([`ls -t -1 ${REMOTE_CACHE_ROOT} 2>&1 || echo ${errorMarker}`]);
    }
    if (!_lodash.default.isString(lsOutput) || lsOutput.includes(errorMarker) && !lsOutput.includes(REMOTE_CACHE_ROOT)) {
      if (!_lodash.default.isBoolean(this._areExtendedLsOptionsSupported)) {
        _logger.default.debug('The current Android API does not support extended ls options. ' + 'Defaulting to no-options call');
      }
      lsOutput = await this.shell([`ls ${REMOTE_CACHE_ROOT} 2>&1 || echo ${errorMarker}`]);
      this._areExtendedLsOptionsSupported = false;
    } else {
      this._areExtendedLsOptionsSupported = true;
    }
    if (lsOutput.includes(errorMarker)) {
      throw new Error(lsOutput.substring(0, lsOutput.indexOf(errorMarker)));
    }
    remoteCachedFiles.push(...lsOutput.split('\n').map(x => x.trim()).filter(Boolean));
  } catch (e) {
    _logger.default.debug(`Got an error '${e.message.trim()}' while getting the list of files in the cache. ` + `Assuming the cache does not exist yet`);
    await this.shell(['mkdir', '-p', REMOTE_CACHE_ROOT]);
  }
  _logger.default.debug(`The count of applications in the cache: ${remoteCachedFiles.length}`);
  const toHash = remotePath => _path.default.posix.parse(remotePath).name;
  if (remoteCachedFiles.some(x => toHash(x) === appHash)) {
    _logger.default.info(`The application at '${apkPath}' is already cached to '${remotePath}'`);
    this.shell(['touch', '-am', remotePath]).catch(() => {});
  } else {
    _logger.default.info(`Caching the application at '${apkPath}' to '${remotePath}'`);
    const timer = new _support.timing.Timer().start();
    await this.push(apkPath, remotePath, {
      timeout: options.timeout
    });
    const {
      size
    } = await _support.fs.stat(apkPath);
    _logger.default.info(`The upload of '${_path.default.basename(apkPath)}' (${_support.util.toReadableSizeString(size)}) ` + `took ${timer.getDuration().asMilliSeconds.toFixed(0)}ms`);
  }
  if (!this.remoteAppsCache) {
    this.remoteAppsCache = new _lruCache.default({
      max: this.remoteAppsCacheLimit
    });
  }
  _lodash.default.difference([...this.remoteAppsCache.keys()], remoteCachedFiles.map(toHash)).forEach(hash => this.remoteAppsCache.del(hash));
  this.remoteAppsCache.set(appHash, remotePath);
  const entriesToCleanup = remoteCachedFiles.map(x => _path.default.posix.join(REMOTE_CACHE_ROOT, x)).filter(x => !this.remoteAppsCache.has(toHash(x))).slice(this.remoteAppsCacheLimit - [...this.remoteAppsCache.keys()].length);
  if (!_lodash.default.isEmpty(entriesToCleanup)) {
    try {
      await this.shell(['rm', '-f', ...entriesToCleanup]);
      _logger.default.debug(`Deleted ${entriesToCleanup.length} expired application cache entries`);
    } catch (e) {
      _logger.default.warn(`Cannot delete ${entriesToCleanup.length} expired application cache entries. ` + `Original error: ${e.message}`);
    }
  }
  return remotePath;
};
apkUtilsMethods.install = async function install(appPath, options = {}) {
  if (appPath.endsWith(_helpers.APKS_EXTENSION)) {
    return await this.installApks(appPath, options);
  }
  options = _lodash.default.cloneDeep(options);
  _lodash.default.defaults(options, {
    replace: true,
    timeout: this.adbExecTimeout === _helpers.DEFAULT_ADB_EXEC_TIMEOUT ? _helpers.APK_INSTALL_TIMEOUT : this.adbExecTimeout,
    timeoutCapName: 'androidInstallTimeout'
  });
  const installArgs = (0, _helpers.buildInstallArgs)(await this.getApiLevel(), options);
  if (options.noIncremental && (await this.isIncrementalInstallSupported())) {
    installArgs.push('--no-incremental');
  }
  const installOpts = {
    timeout: options.timeout,
    timeoutCapName: options.timeoutCapName
  };
  const installCmd = ['install', ...installArgs, appPath];
  let performAppInstall = async () => await this.adbExec(installCmd, installOpts);
  let shouldCacheApp = this.remoteAppsCacheLimit > 0;
  if (shouldCacheApp) {
    shouldCacheApp = !(await this.isStreamedInstallSupported());
    if (!shouldCacheApp) {
      _logger.default.info(`The application at '${appPath}' will not be cached, because the device under test has ` + `confirmed the support of streamed installs`);
    }
  }
  if (shouldCacheApp) {
    const clearCache = async () => {
      _logger.default.info(`Clearing the cache at '${REMOTE_CACHE_ROOT}'`);
      await this.shell(['rm', '-rf', `${REMOTE_CACHE_ROOT}/*`]);
    };
    const cacheApp = async () => await this.cacheApk(appPath, {
      timeout: options.timeout
    });
    try {
      const cachedAppPath = await cacheApp();
      performAppInstall = async () => {
        const pmInstallCmdByRemotePath = remotePath => ['pm', 'install', ...installArgs, remotePath];
        const output = await this.shell(pmInstallCmdByRemotePath(cachedAppPath), installOpts);
        if (/\bINSTALL_FAILED_INSUFFICIENT_STORAGE\b/.test(output)) {
          _logger.default.warn(`There was a failure while installing '${appPath}' ` + `because of the insufficient device storage space`);
          await clearCache();
          _logger.default.info(`Consider decreasing the maximum amount of cached apps ` + `(currently ${this.remoteAppsCacheLimit}) to avoid such issues in the future`);
          const newCachedAppPath = await cacheApp();
          return await this.shell(pmInstallCmdByRemotePath(newCachedAppPath), installOpts);
        }
        return output;
      };
    } catch (e) {
      _logger.default.debug(e);
      _logger.default.warn(`There was a failure while caching '${appPath}': ${e.message}`);
      _logger.default.warn('Falling back to the default installation procedure');
      await clearCache();
    }
  }
  try {
    const timer = new _support.timing.Timer().start();
    const output = await performAppInstall();
    _logger.default.info(`The installation of '${_path.default.basename(appPath)}' took ${timer.getDuration().asMilliSeconds.toFixed(0)}ms`);
    const truncatedOutput = !_lodash.default.isString(output) || output.length <= 300 ? output : `${output.substr(0, 150)}...${output.substr(output.length - 150)}`;
    _logger.default.debug(`Install command stdout: ${truncatedOutput}`);
    if (/\[INSTALL[A-Z_]+FAILED[A-Z_]+\]/.test(output)) {
      if (this.isTestPackageOnlyError(output)) {
        const msg = `Set 'allowTestPackages' capability to true in order to allow test packages installation.`;
        _logger.default.warn(msg);
        throw new Error(`${output}\n${msg}`);
      }
      throw new Error(output);
    }
  } catch (err) {
    if (!err.message.includes('INSTALL_FAILED_ALREADY_EXISTS')) {
      throw err;
    }
    _logger.default.debug(`Application '${appPath}' already installed. Continuing.`);
  }
};
apkUtilsMethods.getApplicationInstallState = async function getApplicationInstallState(appPath, pkg = null) {
  let apkInfo = null;
  if (!pkg) {
    apkInfo = await this.getApkInfo(appPath);
    pkg = apkInfo.name;
  }
  if (!pkg) {
    _logger.default.warn(`Cannot read the package name of '${appPath}'`);
    return this.APP_INSTALL_STATE.UNKNOWN;
  }
  if (!(await this.isAppInstalled(pkg))) {
    _logger.default.debug(`App '${appPath}' is not installed`);
    return this.APP_INSTALL_STATE.NOT_INSTALLED;
  }
  const {
    versionCode: pkgVersionCode,
    versionName: pkgVersionNameStr
  } = await this.getPackageInfo(pkg);
  const pkgVersionName = _semver.default.valid(_semver.default.coerce(pkgVersionNameStr));
  if (!apkInfo) {
    apkInfo = await this.getApkInfo(appPath);
  }
  const {
    versionCode: apkVersionCode,
    versionName: apkVersionNameStr
  } = apkInfo;
  const apkVersionName = _semver.default.valid(_semver.default.coerce(apkVersionNameStr));
  if (!_lodash.default.isInteger(apkVersionCode) || !_lodash.default.isInteger(pkgVersionCode)) {
    _logger.default.warn(`Cannot read version codes of '${appPath}' and/or '${pkg}'`);
    if (!_lodash.default.isString(apkVersionName) || !_lodash.default.isString(pkgVersionName)) {
      _logger.default.warn(`Cannot read version names of '${appPath}' and/or '${pkg}'`);
      return this.APP_INSTALL_STATE.UNKNOWN;
    }
  }
  if (_lodash.default.isInteger(apkVersionCode) && _lodash.default.isInteger(pkgVersionCode)) {
    if (pkgVersionCode > apkVersionCode) {
      _logger.default.debug(`The version code of the installed '${pkg}' is greater than the application version code (${pkgVersionCode} > ${apkVersionCode})`);
      return this.APP_INSTALL_STATE.NEWER_VERSION_INSTALLED;
    }
    if (pkgVersionCode === apkVersionCode) {
      if (_lodash.default.isString(apkVersionName) && _lodash.default.isString(pkgVersionName) && _semver.default.satisfies(pkgVersionName, `>=${apkVersionName}`)) {
        _logger.default.debug(`The version name of the installed '${pkg}' is greater or equal to the application version name ('${pkgVersionName}' >= '${apkVersionName}')`);
        return _semver.default.satisfies(pkgVersionName, `>${apkVersionName}`) ? this.APP_INSTALL_STATE.NEWER_VERSION_INSTALLED : this.APP_INSTALL_STATE.SAME_VERSION_INSTALLED;
      }
      if (!_lodash.default.isString(apkVersionName) || !_lodash.default.isString(pkgVersionName)) {
        _logger.default.debug(`The version name of the installed '${pkg}' is equal to application version name (${pkgVersionCode} === ${apkVersionCode})`);
        return this.APP_INSTALL_STATE.SAME_VERSION_INSTALLED;
      }
    }
  } else if (_lodash.default.isString(apkVersionName) && _lodash.default.isString(pkgVersionName) && _semver.default.satisfies(pkgVersionName, `>=${apkVersionName}`)) {
    _logger.default.debug(`The version name of the installed '${pkg}' is greater or equal to the application version name ('${pkgVersionName}' >= '${apkVersionName}')`);
    return _semver.default.satisfies(pkgVersionName, `>${apkVersionName}`) ? this.APP_INSTALL_STATE.NEWER_VERSION_INSTALLED : this.APP_INSTALL_STATE.SAME_VERSION_INSTALLED;
  }
  _logger.default.debug(`The installed '${pkg}' package is older than '${appPath}' (${pkgVersionCode} < ${apkVersionCode} or '${pkgVersionName}' < '${apkVersionName}')'`);
  return this.APP_INSTALL_STATE.OLDER_VERSION_INSTALLED;
};
apkUtilsMethods.installOrUpgrade = async function installOrUpgrade(appPath, pkg = null, options = {}) {
  if (!pkg) {
    const apkInfo = await this.getApkInfo(appPath);
    pkg = apkInfo.name;
  }
  const {
    enforceCurrentBuild
  } = options;
  const appState = await this.getApplicationInstallState(appPath, pkg);
  let wasUninstalled = false;
  const uninstallPackage = async () => {
    if (!(await this.uninstallApk(pkg))) {
      throw new Error(`'${pkg}' package cannot be uninstalled`);
    }
    wasUninstalled = true;
  };
  switch (appState) {
    case this.APP_INSTALL_STATE.NOT_INSTALLED:
      _logger.default.debug(`Installing '${appPath}'`);
      await this.install(appPath, Object.assign({}, options, {
        replace: false
      }));
      return {
        appState,
        wasUninstalled
      };
    case this.APP_INSTALL_STATE.NEWER_VERSION_INSTALLED:
      if (enforceCurrentBuild) {
        _logger.default.info(`Downgrading '${pkg}' as requested`);
        await uninstallPackage();
        break;
      }
      _logger.default.debug(`There is no need to downgrade '${pkg}'`);
      return {
        appState,
        wasUninstalled
      };
    case this.APP_INSTALL_STATE.SAME_VERSION_INSTALLED:
      if (enforceCurrentBuild) {
        break;
      }
      _logger.default.debug(`There is no need to install/upgrade '${appPath}'`);
      return {
        appState,
        wasUninstalled
      };
    case this.APP_INSTALL_STATE.OLDER_VERSION_INSTALLED:
      _logger.default.debug(`Executing upgrade of '${appPath}'`);
      break;
    default:
      _logger.default.debug(`The current install state of '${appPath}' is unknown. Installing anyway`);
      break;
  }
  try {
    await this.install(appPath, Object.assign({}, options, {
      replace: true
    }));
  } catch (err) {
    _logger.default.warn(`Cannot install/upgrade '${pkg}' because of '${err.message}'. Trying full reinstall`);
    await uninstallPackage();
    await this.install(appPath, Object.assign({}, options, {
      replace: false
    }));
  }
  return {
    appState,
    wasUninstalled
  };
};
apkUtilsMethods.extractStringsFromApk = async function extractStringsFromApk(appPath, language, out) {
  _logger.default.debug(`Extracting strings from for language: ${language || 'default'}`);
  const originalAppPath = appPath;
  if (appPath.endsWith(_helpers.APKS_EXTENSION)) {
    appPath = await this.extractLanguageApk(appPath, language);
  }
  let apkStrings = {};
  let configMarker;
  try {
    await this.initAapt();
    configMarker = await (0, _helpers.formatConfigMarker)(async () => {
      const {
        stdout
      } = await (0, _teen_process.exec)(this.binaries.aapt, ['d', 'configurations', appPath]);
      return _lodash.default.uniq(stdout.split(_os.default.EOL));
    }, language, '(default)');
    const {
      stdout
    } = await (0, _teen_process.exec)(this.binaries.aapt, ['d', '--values', 'resources', appPath]);
    apkStrings = (0, _helpers.parseAaptStrings)(stdout, configMarker);
  } catch (e) {
    _logger.default.debug('Cannot extract resources using aapt. Trying aapt2. ' + `Original error: ${e.stderr || e.message}`);
    await this.initAapt2();
    configMarker = await (0, _helpers.formatConfigMarker)(async () => {
      const {
        stdout
      } = await (0, _teen_process.exec)(this.binaries.aapt2, ['d', 'configurations', appPath]);
      return _lodash.default.uniq(stdout.split(_os.default.EOL));
    }, language, '');
    try {
      const {
        stdout
      } = await (0, _teen_process.exec)(this.binaries.aapt2, ['d', 'resources', appPath]);
      apkStrings = (0, _helpers.parseAapt2Strings)(stdout, configMarker);
    } catch (e) {
      throw new Error(`Cannot extract resources from '${originalAppPath}'. ` + `Original error: ${e.message}`);
    }
  }
  if (_lodash.default.isEmpty(apkStrings)) {
    _logger.default.warn(`No strings have been found in '${originalAppPath}' resources ` + `for '${configMarker || 'default'}' configuration`);
  } else {
    _logger.default.info(`Successfully extracted ${_lodash.default.keys(apkStrings).length} strings from ` + `'${originalAppPath}' resources for '${configMarker || 'default'}' configuration`);
  }
  const localPath = _path.default.resolve(out, 'strings.json');
  await (0, _support.mkdirp)(out);
  await _support.fs.writeFile(localPath, JSON.stringify(apkStrings, null, 2), 'utf-8');
  return {
    apkStrings,
    localPath
  };
};
apkUtilsMethods.getDeviceLanguage = async function getDeviceLanguage() {
  let language;
  if ((await this.getApiLevel()) < 23) {
    language = await this.getDeviceSysLanguage();
    if (!language) {
      language = await this.getDeviceProductLanguage();
    }
  } else {
    language = (await this.getDeviceLocale()).split('-')[0];
  }
  return language;
};
apkUtilsMethods.getDeviceCountry = async function getDeviceCountry() {
  let country = await this.getDeviceSysCountry();
  if (!country) {
    country = await this.getDeviceProductCountry();
  }
  return country;
};
apkUtilsMethods.getDeviceLocale = async function getDeviceLocale() {
  let locale = await this.getDeviceSysLocale();
  if (!locale) {
    locale = await this.getDeviceProductLocale();
  }
  return locale;
};
apkUtilsMethods.setDeviceLocale = async function setDeviceLocale(locale) {
  const validateLocale = new RegExp(/[a-zA-Z]+-[a-zA-Z0-9]+/);
  if (!validateLocale.test(locale)) {
    _logger.default.warn(`setDeviceLocale requires the following format: en-US or ja-JP`);
    return;
  }
  let split_locale = locale.split('-');
  await this.setDeviceLanguageCountry(split_locale[0], split_locale[1]);
};
apkUtilsMethods.ensureCurrentLocale = async function ensureCurrentLocale(language, country, script = null) {
  const hasLanguage = _lodash.default.isString(language);
  const hasCountry = _lodash.default.isString(country);
  if (!hasLanguage && !hasCountry) {
    _logger.default.warn('ensureCurrentLocale requires language or country');
    return false;
  }
  language = (language || '').toLowerCase();
  country = (country || '').toLowerCase();
  const apiLevel = await this.getApiLevel();
  return await (0, _asyncbox.retryInterval)(5, 1000, async () => {
    try {
      if (apiLevel < 23) {
        let curLanguage, curCountry;
        if (hasLanguage) {
          curLanguage = (await this.getDeviceLanguage()).toLowerCase();
          if (!hasCountry && language === curLanguage) {
            return true;
          }
        }
        if (hasCountry) {
          curCountry = (await this.getDeviceCountry()).toLowerCase();
          if (!hasLanguage && country === curCountry) {
            return true;
          }
        }
        if (language === curLanguage && country === curCountry) {
          return true;
        }
      } else {
        const curLocale = (await this.getDeviceLocale()).toLowerCase();
        const localeCode = script ? `${language}-${script.toLowerCase()}-${country}` : `${language}-${country}`;
        if (localeCode === curLocale) {
          _logger.default.debug(`Requested locale is equal to current locale: '${curLocale}'`);
          return true;
        }
      }
      return false;
    } catch (err) {
      _logger.default.error(`Unable to check device localization: ${err.message}`);
      try {
        await this.reconnect();
      } catch (ign) {
        await this.restartAdb();
      }
      throw err;
    }
  });
};
apkUtilsMethods.setDeviceLanguageCountry = async function setDeviceLanguageCountry(language, country, script = null) {
  let hasLanguage = language && _lodash.default.isString(language);
  let hasCountry = country && _lodash.default.isString(country);
  if (!hasLanguage || !hasCountry) {
    _logger.default.warn(`setDeviceLanguageCountry requires language and country at least`);
    _logger.default.warn(`Got language: '${language}' and country: '${country}'`);
    return;
  }
  let apiLevel = await this.getApiLevel();
  language = (language || '').toLowerCase();
  country = (country || '').toUpperCase();
  if (apiLevel < 23) {
    let curLanguage = (await this.getDeviceLanguage()).toLowerCase();
    let curCountry = (await this.getDeviceCountry()).toUpperCase();
    if (language !== curLanguage || country !== curCountry) {
      await this.setDeviceSysLocaleViaSettingApp(language, country);
    }
  } else {
    let curLocale = await this.getDeviceLocale();
    const localeCode = script ? `${language}-${script}-${country}` : `${language}-${country}`;
    _logger.default.debug(`Current locale: '${curLocale}'; requested locale: '${localeCode}'`);
    if (localeCode.toLowerCase() !== curLocale.toLowerCase()) {
      await this.setDeviceSysLocaleViaSettingApp(language, country, script);
    }
  }
};
apkUtilsMethods.getApkInfo = async function getApkInfo(appPath) {
  if (!(await _support.fs.exists(appPath))) {
    throw new Error(`The file at path ${appPath} does not exist or is not accessible`);
  }
  if (appPath.endsWith(_helpers.APKS_EXTENSION)) {
    appPath = await this.extractBaseApk(appPath);
  }
  try {
    const apkReader = await _adbkitApkreader.default.open(appPath);
    const manifest = await apkReader.readManifest();
    const {
      pkg,
      versionName,
      versionCode
    } = (0, _helpers.parseManifest)(manifest);
    return {
      name: pkg,
      versionCode,
      versionName
    };
  } catch (e) {
    _logger.default.warn(`Error '${e.message}' while getting badging info`);
  }
  return {};
};
apkUtilsMethods.getPackageInfo = async function getPackageInfo(pkg) {
  _logger.default.debug(`Getting package info for '${pkg}'`);
  let result = {
    name: pkg
  };
  try {
    const stdout = await this.shell(['dumpsys', 'package', pkg]);
    const versionNameMatch = new RegExp(/versionName=([\d+.]+)/).exec(stdout);
    if (versionNameMatch) {
      result.versionName = versionNameMatch[1];
    }
    const versionCodeMatch = new RegExp(/versionCode=(\d+)/).exec(stdout);
    if (versionCodeMatch) {
      result.versionCode = parseInt(versionCodeMatch[1], 10);
    }
    return result;
  } catch (err) {
    _logger.default.warn(`Error '${err.message}' while dumping package info`);
  }
  return result;
};
apkUtilsMethods.pullApk = async function pullApk(pkg, tmpDir) {
  const stdout = _lodash.default.trim(await this.shell(['pm', 'path', pkg]));
  const packageMarker = 'package:';
  if (!_lodash.default.startsWith(stdout, packageMarker)) {
    throw new Error(`Cannot pull the .apk package for '${pkg}'. Original error: ${stdout}`);
  }
  const remotePath = stdout.replace(packageMarker, '');
  const tmpApp = _path.default.resolve(tmpDir, `${pkg}.apk`);
  await this.pull(remotePath, tmpApp);
  _logger.default.debug(`Pulled app for package '${pkg}' to '${tmpApp}'`);
  return tmpApp;
};
apkUtilsMethods.activateApp = async function activateApp(appId) {
  _logger.default.debug(`Activating '${appId}'`);
  const apiLevel = await this.getApiLevel();
  if (apiLevel < 24) {
    const cmd = ['monkey', '-p', appId, '-c', 'android.intent.category.LAUNCHER', '1'];
    let output = '';
    try {
      output = await this.shell(cmd);
      _logger.default.debug(`Command stdout: ${output}`);
    } catch (e) {
      _logger.default.errorAndThrow(`Cannot activate '${appId}'. Original error: ${e.message}`);
    }
    if (output.includes('monkey aborted')) {
      _logger.default.errorAndThrow(`Cannot activate '${appId}'. Are you sure it is installed?`);
    }
    return;
  }
  let activityName = await this.resolveLaunchableActivity(appId);
  if (activityName === RESOLVER_ACTIVITY_NAME) {
    _logger.default.debug(`The launchable activity name of '${appId}' was resolved to '${activityName}'. ` + `Switching the resolver to not use cmd`);
    activityName = await this.resolveLaunchableActivity(appId, {
      preferCmd: false
    });
  }
  const stdout = await this.shell(['am', apiLevel < 26 ? 'start' : 'start-activity', '-a', 'android.intent.action.MAIN', '-c', 'android.intent.category.LAUNCHER', '-f', '0x10200000', '-n', activityName]);
  _logger.default.debug(stdout);
  if (/^error:/mi.test(stdout)) {
    throw new Error(`Cannot activate '${appId}'. Original error: ${stdout}`);
  }
};
var _default = apkUtilsMethods;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaGVscGVycyIsInJlcXVpcmUiLCJfdGVlbl9wcm9jZXNzIiwiX2xvZ2dlciIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfcGF0aCIsIl9sb2Rhc2giLCJfYXN5bmNib3giLCJfc3VwcG9ydCIsIl9zZW12ZXIiLCJfb3MiLCJfbHJ1Q2FjaGUiLCJfYWRia2l0QXBrcmVhZGVyIiwiYXBrVXRpbHNNZXRob2RzIiwiQVBQX0lOU1RBTExfU1RBVEUiLCJVTktOT1dOIiwiTk9UX0lOU1RBTExFRCIsIk5FV0VSX1ZFUlNJT05fSU5TVEFMTEVEIiwiU0FNRV9WRVJTSU9OX0lOU1RBTExFRCIsIk9MREVSX1ZFUlNJT05fSU5TVEFMTEVEIiwiUkVNT1RFX0NBQ0hFX1JPT1QiLCJleHBvcnRzIiwiUkVTT0xWRVJfQUNUSVZJVFlfTkFNRSIsImlzQXBwSW5zdGFsbGVkIiwicGtnIiwibG9nIiwiZGVidWciLCJpbnN0YWxsZWRQYXR0ZXJuIiwiUmVnRXhwIiwiXyIsImVzY2FwZVJlZ0V4cCIsInN0ZG91dCIsInNoZWxsIiwiaXNJbnN0YWxsZWQiLCJ0ZXN0IiwiZSIsIkVycm9yIiwibWVzc2FnZSIsInN0YXJ0VXJpIiwidXJpIiwib3B0cyIsIndhaXRGb3JMYXVuY2giLCJhcmdzIiwicHVzaCIsImVzY2FwZVNoZWxsQXJnIiwicmVzIiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsInN0YXJ0QXBwIiwic3RhcnRBcHBPcHRpb25zIiwiYWN0aXZpdHkiLCJhY3Rpb24iLCJjbG9uZSIsInJlcGxhY2UiLCJkZWZhdWx0cyIsIndhaXRQa2ciLCJ3YWl0QWN0aXZpdHkiLCJyZXRyeSIsInN0b3BBcHAiLCJhcGlMZXZlbCIsImdldEFwaUxldmVsIiwiY21kIiwiYnVpbGRTdGFydENtZCIsImludGVudE5hbWUiLCJvcHRpb25hbEludGVudEFyZ3VtZW50cyIsInNoZWxsT3B0cyIsImlzSW50ZWdlciIsIndhaXREdXJhdGlvbiIsInRpbWVvdXQiLCJzdGFydHNXaXRoIiwid2FpdEZvckFjdGl2aXR5IiwiYXBwRGVzY3JpcHRvciIsImR1bXBXaW5kb3dzIiwiZHVtcHN5c0FyZyIsImdldEZvY3VzZWRQYWNrYWdlQW5kQWN0aXZpdHkiLCJudWxsRm9jdXNlZEFwcFJlIiwiZm9jdXNlZEFwcFJlIiwibnVsbEN1cnJlbnRGb2N1c1JlIiwiY3VycmVudEZvY3VzQXBwUmUiLCJmb2N1c2VkQXBwQ2FuZGlkYXRlcyIsImN1cnJlbnRGb2N1c0FwcENhbmRpZGF0ZXMiLCJjYW5kaWRhdGVzIiwicGF0dGVybiIsIm1hdGNoIiwiZXhlYyIsImFwcFBhY2thZ2UiLCJ0cmltIiwiYXBwQWN0aXZpdHkiLCJsZW5ndGgiLCJpbnRlcnNlY3Rpb25XaXRoIiwiaXNFcXVhbCIsIndhaXRGb3JBY3Rpdml0eU9yTm90Iiwid2FpdEZvclN0b3AiLCJ3YWl0TXMiLCJzcGxpdE5hbWVzIiwibmFtZXMiLCJzcGxpdCIsIm1hcCIsIm5hbWUiLCJhbGxQYWNrYWdlcyIsImFsbEFjdGl2aXRpZXMiLCJwb3NzaWJsZUFjdGl2aXR5TmFtZXMiLCJvbmVBY3Rpdml0eSIsImN1cnJlbnRQa2ciLCJqb2luIiwicG9zc2libGVBY3Rpdml0eVBhdHRlcm5zIiwiYWN0TmFtZSIsImNvbmRpdGlvbkZ1bmMiLCJmdWxseVF1YWxpZmllZEFjdGl2aXR5IiwiaXNBY3Rpdml0eUZvdW5kIiwic29tZSIsInAiLCJ3YWl0Rm9yQ29uZGl0aW9uIiwicGFyc2VJbnQiLCJpbnRlcnZhbE1zIiwiYWN0Iiwid2FpdEZvck5vdEFjdGl2aXR5IiwidW5pbnN0YWxsQXBrIiwib3B0aW9ucyIsImluZm8iLCJrZWVwRGF0YSIsImZvcmNlU3RvcCIsImFkYkV4ZWMiLCJpbnN0YWxsRnJvbURldmljZVBhdGgiLCJhcGtQYXRoT25EZXZpY2UiLCJpbmRleE9mIiwiY2FjaGVBcGsiLCJhcGtQYXRoIiwiYXBwSGFzaCIsImZzIiwiaGFzaCIsInJlbW90ZVBhdGgiLCJwYXRoIiwicG9zaXgiLCJyZW1vdGVDYWNoZWRGaWxlcyIsImVycm9yTWFya2VyIiwibHNPdXRwdXQiLCJfYXJlRXh0ZW5kZWRMc09wdGlvbnNTdXBwb3J0ZWQiLCJpc0Jvb2xlYW4iLCJpc1N0cmluZyIsInN1YnN0cmluZyIsIngiLCJmaWx0ZXIiLCJCb29sZWFuIiwidG9IYXNoIiwicGFyc2UiLCJjYXRjaCIsInRpbWVyIiwidGltaW5nIiwiVGltZXIiLCJzdGFydCIsInNpemUiLCJzdGF0IiwiYmFzZW5hbWUiLCJ1dGlsIiwidG9SZWFkYWJsZVNpemVTdHJpbmciLCJnZXREdXJhdGlvbiIsImFzTWlsbGlTZWNvbmRzIiwidG9GaXhlZCIsInJlbW90ZUFwcHNDYWNoZSIsIkxSVSIsIm1heCIsInJlbW90ZUFwcHNDYWNoZUxpbWl0IiwiZGlmZmVyZW5jZSIsImtleXMiLCJmb3JFYWNoIiwiZGVsIiwic2V0IiwiZW50cmllc1RvQ2xlYW51cCIsImhhcyIsInNsaWNlIiwiaXNFbXB0eSIsIndhcm4iLCJpbnN0YWxsIiwiYXBwUGF0aCIsImVuZHNXaXRoIiwiQVBLU19FWFRFTlNJT04iLCJpbnN0YWxsQXBrcyIsImNsb25lRGVlcCIsImFkYkV4ZWNUaW1lb3V0IiwiREVGQVVMVF9BREJfRVhFQ19USU1FT1VUIiwiQVBLX0lOU1RBTExfVElNRU9VVCIsInRpbWVvdXRDYXBOYW1lIiwiaW5zdGFsbEFyZ3MiLCJidWlsZEluc3RhbGxBcmdzIiwibm9JbmNyZW1lbnRhbCIsImlzSW5jcmVtZW50YWxJbnN0YWxsU3VwcG9ydGVkIiwiaW5zdGFsbE9wdHMiLCJpbnN0YWxsQ21kIiwicGVyZm9ybUFwcEluc3RhbGwiLCJzaG91bGRDYWNoZUFwcCIsImlzU3RyZWFtZWRJbnN0YWxsU3VwcG9ydGVkIiwiY2xlYXJDYWNoZSIsImNhY2hlQXBwIiwiY2FjaGVkQXBwUGF0aCIsInBtSW5zdGFsbENtZEJ5UmVtb3RlUGF0aCIsIm91dHB1dCIsIm5ld0NhY2hlZEFwcFBhdGgiLCJ0cnVuY2F0ZWRPdXRwdXQiLCJzdWJzdHIiLCJpc1Rlc3RQYWNrYWdlT25seUVycm9yIiwibXNnIiwiZXJyIiwiZ2V0QXBwbGljYXRpb25JbnN0YWxsU3RhdGUiLCJhcGtJbmZvIiwiZ2V0QXBrSW5mbyIsInZlcnNpb25Db2RlIiwicGtnVmVyc2lvbkNvZGUiLCJ2ZXJzaW9uTmFtZSIsInBrZ1ZlcnNpb25OYW1lU3RyIiwiZ2V0UGFja2FnZUluZm8iLCJwa2dWZXJzaW9uTmFtZSIsInNlbXZlciIsInZhbGlkIiwiY29lcmNlIiwiYXBrVmVyc2lvbkNvZGUiLCJhcGtWZXJzaW9uTmFtZVN0ciIsImFwa1ZlcnNpb25OYW1lIiwic2F0aXNmaWVzIiwiaW5zdGFsbE9yVXBncmFkZSIsImVuZm9yY2VDdXJyZW50QnVpbGQiLCJhcHBTdGF0ZSIsIndhc1VuaW5zdGFsbGVkIiwidW5pbnN0YWxsUGFja2FnZSIsIk9iamVjdCIsImFzc2lnbiIsImV4dHJhY3RTdHJpbmdzRnJvbUFwayIsImxhbmd1YWdlIiwib3V0Iiwib3JpZ2luYWxBcHBQYXRoIiwiZXh0cmFjdExhbmd1YWdlQXBrIiwiYXBrU3RyaW5ncyIsImNvbmZpZ01hcmtlciIsImluaXRBYXB0IiwiZm9ybWF0Q29uZmlnTWFya2VyIiwiYmluYXJpZXMiLCJhYXB0IiwidW5pcSIsIm9zIiwiRU9MIiwicGFyc2VBYXB0U3RyaW5ncyIsInN0ZGVyciIsImluaXRBYXB0MiIsImFhcHQyIiwicGFyc2VBYXB0MlN0cmluZ3MiLCJsb2NhbFBhdGgiLCJyZXNvbHZlIiwibWtkaXJwIiwid3JpdGVGaWxlIiwiSlNPTiIsInN0cmluZ2lmeSIsImdldERldmljZUxhbmd1YWdlIiwiZ2V0RGV2aWNlU3lzTGFuZ3VhZ2UiLCJnZXREZXZpY2VQcm9kdWN0TGFuZ3VhZ2UiLCJnZXREZXZpY2VMb2NhbGUiLCJnZXREZXZpY2VDb3VudHJ5IiwiY291bnRyeSIsImdldERldmljZVN5c0NvdW50cnkiLCJnZXREZXZpY2VQcm9kdWN0Q291bnRyeSIsImxvY2FsZSIsImdldERldmljZVN5c0xvY2FsZSIsImdldERldmljZVByb2R1Y3RMb2NhbGUiLCJzZXREZXZpY2VMb2NhbGUiLCJ2YWxpZGF0ZUxvY2FsZSIsInNwbGl0X2xvY2FsZSIsInNldERldmljZUxhbmd1YWdlQ291bnRyeSIsImVuc3VyZUN1cnJlbnRMb2NhbGUiLCJzY3JpcHQiLCJoYXNMYW5ndWFnZSIsImhhc0NvdW50cnkiLCJyZXRyeUludGVydmFsIiwiY3VyTGFuZ3VhZ2UiLCJjdXJDb3VudHJ5IiwiY3VyTG9jYWxlIiwibG9jYWxlQ29kZSIsImVycm9yIiwicmVjb25uZWN0IiwiaWduIiwicmVzdGFydEFkYiIsInRvVXBwZXJDYXNlIiwic2V0RGV2aWNlU3lzTG9jYWxlVmlhU2V0dGluZ0FwcCIsImV4aXN0cyIsImV4dHJhY3RCYXNlQXBrIiwiYXBrUmVhZGVyIiwiQXBrUmVhZGVyIiwib3BlbiIsIm1hbmlmZXN0IiwicmVhZE1hbmlmZXN0IiwicGFyc2VNYW5pZmVzdCIsInJlc3VsdCIsInZlcnNpb25OYW1lTWF0Y2giLCJ2ZXJzaW9uQ29kZU1hdGNoIiwicHVsbEFwayIsInRtcERpciIsInBhY2thZ2VNYXJrZXIiLCJ0bXBBcHAiLCJwdWxsIiwiYWN0aXZhdGVBcHAiLCJhcHBJZCIsImVycm9yQW5kVGhyb3ciLCJhY3Rpdml0eU5hbWUiLCJyZXNvbHZlTGF1bmNoYWJsZUFjdGl2aXR5IiwicHJlZmVyQ21kIiwiX2RlZmF1bHQiLCJkZWZhdWx0Il0sInNvdXJjZXMiOlsiLi4vLi4vLi4vbGliL3Rvb2xzL2Fway11dGlscy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBidWlsZFN0YXJ0Q21kLCBBUEtTX0VYVEVOU0lPTiwgYnVpbGRJbnN0YWxsQXJncyxcbiAgQVBLX0lOU1RBTExfVElNRU9VVCwgREVGQVVMVF9BREJfRVhFQ19USU1FT1VULFxuICBwYXJzZU1hbmlmZXN0LCBwYXJzZUFhcHRTdHJpbmdzLCBwYXJzZUFhcHQyU3RyaW5ncywgZm9ybWF0Q29uZmlnTWFya2VyLFxuICBlc2NhcGVTaGVsbEFyZyxcbn0gZnJvbSAnLi4vaGVscGVycy5qcyc7XG5pbXBvcnQgeyBleGVjIH0gZnJvbSAndGVlbl9wcm9jZXNzJztcbmltcG9ydCBsb2cgZnJvbSAnLi4vbG9nZ2VyLmpzJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7IHJldHJ5SW50ZXJ2YWwsIHdhaXRGb3JDb25kaXRpb24gfSBmcm9tICdhc3luY2JveCc7XG5pbXBvcnQgeyBmcywgdXRpbCwgbWtkaXJwLCB0aW1pbmcgfSBmcm9tICdAYXBwaXVtL3N1cHBvcnQnO1xuaW1wb3J0IHNlbXZlciBmcm9tICdzZW12ZXInO1xuaW1wb3J0IG9zIGZyb20gJ29zJztcbmltcG9ydCBMUlUgZnJvbSAnbHJ1LWNhY2hlJztcbmltcG9ydCBBcGtSZWFkZXIgZnJvbSAnYWRia2l0LWFwa3JlYWRlcic7XG5cbmNvbnN0IGFwa1V0aWxzTWV0aG9kcyA9IHt9O1xuXG5hcGtVdGlsc01ldGhvZHMuQVBQX0lOU1RBTExfU1RBVEUgPSB7XG4gIFVOS05PV046ICd1bmtub3duJyxcbiAgTk9UX0lOU1RBTExFRDogJ25vdEluc3RhbGxlZCcsXG4gIE5FV0VSX1ZFUlNJT05fSU5TVEFMTEVEOiAnbmV3ZXJWZXJzaW9uSW5zdGFsbGVkJyxcbiAgU0FNRV9WRVJTSU9OX0lOU1RBTExFRDogJ3NhbWVWZXJzaW9uSW5zdGFsbGVkJyxcbiAgT0xERVJfVkVSU0lPTl9JTlNUQUxMRUQ6ICdvbGRlclZlcnNpb25JbnN0YWxsZWQnLFxufTtcbmNvbnN0IFJFTU9URV9DQUNIRV9ST09UID0gJy9kYXRhL2xvY2FsL3RtcC9hcHBpdW1fY2FjaGUnO1xuY29uc3QgUkVTT0xWRVJfQUNUSVZJVFlfTkFNRSA9ICdhbmRyb2lkL2NvbS5hbmRyb2lkLmludGVybmFsLmFwcC5SZXNvbHZlckFjdGl2aXR5JztcblxuXG4vKipcbiAqIENoZWNrIHdoZXRoZXIgdGhlIHBhcnRpY3VsYXIgcGFja2FnZSBpcyBwcmVzZW50IG9uIHRoZSBkZXZpY2UgdW5kZXIgdGVzdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcGtnIC0gVGhlIG5hbWUgb2YgdGhlIHBhY2thZ2UgdG8gY2hlY2suXG4gKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIHRoZSBwYWNrYWdlIGlzIGluc3RhbGxlZC5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGVyZSB3YXMgYW4gZXJyb3Igd2hpbGUgZGV0ZWN0aW5nIGFwcGxpY2F0aW9uIHN0YXRlXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5pc0FwcEluc3RhbGxlZCA9IGFzeW5jIGZ1bmN0aW9uIGlzQXBwSW5zdGFsbGVkIChwa2cpIHtcbiAgbG9nLmRlYnVnKGBHZXR0aW5nIGluc3RhbGwgc3RhdHVzIGZvciAke3BrZ31gKTtcbiAgY29uc3QgaW5zdGFsbGVkUGF0dGVybiA9IG5ldyBSZWdFeHAoYF5cXFxccypQYWNrYWdlXFxcXHMrXFxcXFske18uZXNjYXBlUmVnRXhwKHBrZyl9XFxcXF1bXjpdKzokYCwgJ20nKTtcbiAgdHJ5IHtcbiAgICBjb25zdCBzdGRvdXQgPSBhd2FpdCB0aGlzLnNoZWxsKFsnZHVtcHN5cycsICdwYWNrYWdlJywgcGtnXSk7XG4gICAgY29uc3QgaXNJbnN0YWxsZWQgPSBpbnN0YWxsZWRQYXR0ZXJuLnRlc3Qoc3Rkb3V0KTtcbiAgICBsb2cuZGVidWcoYCcke3BrZ30nIGlzJHshaXNJbnN0YWxsZWQgPyAnIG5vdCcgOiAnJ30gaW5zdGFsbGVkYCk7XG4gICAgcmV0dXJuIGlzSW5zdGFsbGVkO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBmaW5kaW5nIGlmICcke3BrZ30nIGlzIGluc3RhbGxlZC4gT3JpZ2luYWwgZXJyb3I6ICR7ZS5tZXNzYWdlfWApO1xuICB9XG59O1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IFN0YXJ0VXJpT3B0aW9uc1xuICogQHByb3BlcnR5IHs/Ym9vbGVhbn0gd2FpdEZvckxhdW5jaCBbdHJ1ZV0gLSBpZiBgZmFsc2VgIHRoZW4gYWRiIHdvbid0IHdhaXRcbiAqIGZvciB0aGUgc3RhcnRlZCBhY3Rpdml0eSB0byByZXR1cm4gdGhlIGNvbnRyb2xcbiAqL1xuXG4vKipcbiAqIFN0YXJ0IHRoZSBwYXJ0aWN1bGFyIFVSSSBvbiB0aGUgZGV2aWNlIHVuZGVyIHRlc3QuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVyaSAtIFRoZSBuYW1lIG9mIFVSSSB0byBzdGFydC5cbiAqIEBwYXJhbSB7c3RyaW5nfSBwa2cgLSBUaGUgbmFtZSBvZiB0aGUgcGFja2FnZSB0byBzdGFydCB0aGUgVVJJIHdpdGguXG4gKiBAcGFyYW0ge1N0YXJ0VXJpT3B0aW9uc30gb3B0c1xuICovXG5hcGtVdGlsc01ldGhvZHMuc3RhcnRVcmkgPSBhc3luYyBmdW5jdGlvbiBzdGFydFVyaSAodXJpLCBwa2csIG9wdHMgPSB7fSkge1xuICBjb25zdCB7XG4gICAgd2FpdEZvckxhdW5jaCA9IHRydWUsXG4gIH0gPSBvcHRzO1xuXG4gIGlmICghdXJpIHx8ICFwa2cpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VSSSBhbmQgcGFja2FnZSBhcmd1bWVudHMgYXJlIHJlcXVpcmVkJyk7XG4gIH1cblxuICBjb25zdCBhcmdzID0gWydhbScsICdzdGFydCddO1xuICBpZiAod2FpdEZvckxhdW5jaCkge1xuICAgIGFyZ3MucHVzaCgnLVcnKTtcbiAgfVxuICBhcmdzLnB1c2goJy1hJywgJ2FuZHJvaWQuaW50ZW50LmFjdGlvbi5WSUVXJyxcbiAgICAnLWQnLCBlc2NhcGVTaGVsbEFyZyh1cmkpLFxuICAgIHBrZyk7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLnNoZWxsKGFyZ3MpO1xuICAgIGlmIChyZXMudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygndW5hYmxlIHRvIHJlc29sdmUgaW50ZW50JykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihyZXMpO1xuICAgIH1cbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3IgYXR0ZW1wdGluZyB0byBzdGFydCBVUkkuIE9yaWdpbmFsIGVycm9yOiAke2V9YCk7XG4gIH1cbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gU3RhcnRBcHBPcHRpb25zXG4gKiBAcHJvcGVydHkgeyFzdHJpbmd9IHBrZyAtIFRoZSBuYW1lIG9mIHRoZSBhcHBsaWNhdGlvbiBwYWNrYWdlXG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IGFjdGl2aXR5IC0gVGhlIG5hbWUgb2YgdGhlIG1haW4gYXBwbGljYXRpb24gYWN0aXZpdHkuXG4gKiBUaGlzIG9yIGFjdGlvbiBpcyByZXF1aXJlZCBpbiBvcmRlciB0byBiZSBhYmxlIHRvIGxhdW5jaCBhbiBhcHAuXG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IGFjdGlvbiAtIFRoZSBuYW1lIG9mIHRoZSBpbnRlbnQgYWN0aW9uIHRoYXQgd2lsbCBsYXVuY2ggdGhlIHJlcXVpcmVkIGFwcC5cbiAqIFRoaXMgb3IgYWN0aXZpdHkgaXMgcmVxdWlyZWQgaW4gb3JkZXIgdG8gYmUgYWJsZSB0byBsYXVuY2ggYW4gYXBwLlxuICogQHByb3BlcnR5IHs/Ym9vbGVhbn0gcmV0cnkgW3RydWVdIC0gSWYgdGhpcyBwcm9wZXJ0eSBpcyBzZXQgdG8gYHRydWVgXG4gKiBhbmQgdGhlIGFjdGl2aXR5IG5hbWUgZG9lcyBub3Qgc3RhcnQgd2l0aCAnLicgdGhlbiB0aGUgbWV0aG9kXG4gKiB3aWxsIHRyeSB0byBhZGQgdGhlIG1pc3NpbmcgZG90IGFuZCBzdGFydCB0aGUgYWN0aXZpdHkgb25jZSBtb3JlXG4gKiBpZiB0aGUgZmlyc3Qgc3RhcnR1cCB0cnkgZmFpbHMuXG4gKiBAcHJvcGVydHkgez9ib29sZWFufSBzdG9wQXBwIFt0cnVlXSAtIFNldCBpdCB0byBgdHJ1ZWAgaW4gb3JkZXIgdG8gZm9yY2VmdWxseVxuICogc3RvcCB0aGUgYWN0aXZpdHkgaWYgaXQgaXMgYWxyZWFkeSBydW5uaW5nLlxuICogQHByb3BlcnR5IHs/c3RyaW5nfSB3YWl0UGtnIC0gVGhlIG5hbWUgb2YgdGhlIHBhY2thZ2UgdG8gd2FpdCB0byBvblxuICogc3RhcnR1cCAodGhpcyBvbmx5IG1ha2VzIHNlbnNlIGlmIHRoaXMgbmFtZSBpcyBkaWZmZXJlbnQgZnJvbSB0aGUgb25lLCB3aGljaCBpcyBzZXQgYXMgYHBrZ2ApXG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IHdhaXRBY3Rpdml0eSAtIFRoZSBuYW1lIG9mIHRoZSBhY3Rpdml0eSB0byB3YWl0IHRvIG9uXG4gKiBzdGFydHVwICh0aGlzIG9ubHkgbWFrZXMgc2Vuc2UgaWYgdGhpcyBuYW1lIGlzIGRpZmZlcmVudCBmcm9tIHRoZSBvbmUsIHdoaWNoIGlzIHNldCBhcyBgYWN0aXZpdHlgKVxuICogQHByb3BlcnR5IHs/bnVtYmVyfSB3YWl0RHVyYXRpb24gLSBUaGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0IHVudGlsIHRoZVxuICogYHdhaXRBY3Rpdml0eWAgaXMgZm9jdXNlZFxuICogQHByb3BlcnR5IHs/c3RyaW5nfG51bWJlcn0gdXNlciAtIFRoZSBudW1iZXIgb2YgdGhlIHVzZXIgcHJvZmlsZSB0byBzdGFydFxuICogdGhlIGdpdmVuIGFjdGl2aXR5IHdpdGguIFRoZSBkZWZhdWx0IE9TIHVzZXIgcHJvZmlsZSAodXN1YWxseSB6ZXJvKSBpcyB1c2VkXG4gKiB3aGVuIHRoaXMgcHJvcGVydHkgaXMgdW5zZXRcbiAqIEBwcm9wZXJ0eSB7P2Jvb2xlYW59IHdhaXRGb3JMYXVuY2ggW3RydWVdIC0gaWYgYGZhbHNlYCB0aGVuIGFkYiB3b24ndCB3YWl0XG4gKiBmb3IgdGhlIHN0YXJ0ZWQgYWN0aXZpdHkgdG8gcmV0dXJuIHRoZSBjb250cm9sXG4gKi9cblxuLyoqXG4gKiBTdGFydCB0aGUgcGFydGljdWxhciBwYWNrYWdlL2FjdGl2aXR5IG9uIHRoZSBkZXZpY2UgdW5kZXIgdGVzdC5cbiAqXG4gKiBAcGFyYW0ge1N0YXJ0QXBwT3B0aW9uc30gc3RhcnRBcHBPcHRpb25zIFt7fV0gLSBTdGFydHVwIG9wdGlvbnMgbWFwcGluZy5cbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIG91dHB1dCBvZiB0aGUgY29ycmVzcG9uZGluZyBhZGIgY29tbWFuZC5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGVyZSBpcyBhbiBlcnJvciB3aGlsZSBleGVjdXRpbmcgdGhlIGFjdGl2aXR5XG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5zdGFydEFwcCA9IGFzeW5jIGZ1bmN0aW9uIHN0YXJ0QXBwIChzdGFydEFwcE9wdGlvbnMgPSB7fSkge1xuICBpZiAoIXN0YXJ0QXBwT3B0aW9ucy5wa2cgfHwgIShzdGFydEFwcE9wdGlvbnMuYWN0aXZpdHkgfHwgc3RhcnRBcHBPcHRpb25zLmFjdGlvbikpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3BrZywgYW5kIGFjdGl2aXR5IG9yIGludGVudCBhY3Rpb24sIGFyZSByZXF1aXJlZCB0byBzdGFydCBhbiBhcHBsaWNhdGlvbicpO1xuICB9XG5cbiAgc3RhcnRBcHBPcHRpb25zID0gXy5jbG9uZShzdGFydEFwcE9wdGlvbnMpO1xuICBpZiAoc3RhcnRBcHBPcHRpb25zLmFjdGl2aXR5KSB7XG4gICAgc3RhcnRBcHBPcHRpb25zLmFjdGl2aXR5ID0gc3RhcnRBcHBPcHRpb25zLmFjdGl2aXR5LnJlcGxhY2UoJyQnLCAnXFxcXCQnKTtcbiAgfVxuICAvLyBpbml0aWFsaXppbmcgZGVmYXVsdHNcbiAgXy5kZWZhdWx0cyhzdGFydEFwcE9wdGlvbnMsIHtcbiAgICB3YWl0UGtnOiBzdGFydEFwcE9wdGlvbnMucGtnLFxuICAgIHdhaXRGb3JMYXVuY2g6IHRydWUsXG4gICAgd2FpdEFjdGl2aXR5OiBmYWxzZSxcbiAgICByZXRyeTogdHJ1ZSxcbiAgICBzdG9wQXBwOiB0cnVlXG4gIH0pO1xuICAvLyBwcmV2ZW50aW5nIG51bGwgd2FpdHBrZ1xuICBzdGFydEFwcE9wdGlvbnMud2FpdFBrZyA9IHN0YXJ0QXBwT3B0aW9ucy53YWl0UGtnIHx8IHN0YXJ0QXBwT3B0aW9ucy5wa2c7XG5cbiAgY29uc3QgYXBpTGV2ZWwgPSBhd2FpdCB0aGlzLmdldEFwaUxldmVsKCk7XG4gIGNvbnN0IGNtZCA9IGJ1aWxkU3RhcnRDbWQoc3RhcnRBcHBPcHRpb25zLCBhcGlMZXZlbCk7XG4gIGNvbnN0IGludGVudE5hbWUgPSBgJHtzdGFydEFwcE9wdGlvbnMuYWN0aW9ufSR7c3RhcnRBcHBPcHRpb25zLm9wdGlvbmFsSW50ZW50QXJndW1lbnRzID8gJyAnICsgc3RhcnRBcHBPcHRpb25zLm9wdGlvbmFsSW50ZW50QXJndW1lbnRzIDogJyd9YDtcbiAgdHJ5IHtcbiAgICBjb25zdCBzaGVsbE9wdHMgPSB7fTtcbiAgICBpZiAoXy5pc0ludGVnZXIoc3RhcnRBcHBPcHRpb25zLndhaXREdXJhdGlvbikgJiYgc3RhcnRBcHBPcHRpb25zLndhaXREdXJhdGlvbiA+PSAwKSB7XG4gICAgICBzaGVsbE9wdHMudGltZW91dCA9IHN0YXJ0QXBwT3B0aW9ucy53YWl0RHVyYXRpb247XG4gICAgfVxuICAgIGNvbnN0IHN0ZG91dCA9IGF3YWl0IHRoaXMuc2hlbGwoY21kLCBzaGVsbE9wdHMpO1xuICAgIGlmIChzdGRvdXQuaW5jbHVkZXMoJ0Vycm9yOiBBY3Rpdml0eSBjbGFzcycpICYmIHN0ZG91dC5pbmNsdWRlcygnZG9lcyBub3QgZXhpc3QnKSkge1xuICAgICAgaWYgKHN0YXJ0QXBwT3B0aW9ucy5yZXRyeSAmJiAhc3RhcnRBcHBPcHRpb25zLmFjdGl2aXR5LnN0YXJ0c1dpdGgoJy4nKSkge1xuICAgICAgICBsb2cuZGVidWcoYFdlIHRyaWVkIHRvIHN0YXJ0IGFuIGFjdGl2aXR5IHRoYXQgZG9lc24ndCBleGlzdCwgYCArXG4gICAgICAgICAgICAgICAgICBgcmV0cnlpbmcgd2l0aCAnLiR7c3RhcnRBcHBPcHRpb25zLmFjdGl2aXR5fScgYWN0aXZpdHkgbmFtZWApO1xuICAgICAgICBzdGFydEFwcE9wdGlvbnMuYWN0aXZpdHkgPSBgLiR7c3RhcnRBcHBPcHRpb25zLmFjdGl2aXR5fWA7XG4gICAgICAgIHN0YXJ0QXBwT3B0aW9ucy5yZXRyeSA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5zdGFydEFwcChzdGFydEFwcE9wdGlvbnMpO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBBY3Rpdml0eSBuYW1lICcke3N0YXJ0QXBwT3B0aW9ucy5hY3Rpdml0eX0nIHVzZWQgdG8gc3RhcnQgdGhlIGFwcCBkb2Vzbid0IGAgK1xuICAgICAgICAgICAgICAgICAgICAgIGBleGlzdCBvciBjYW5ub3QgYmUgbGF1bmNoZWQhIE1ha2Ugc3VyZSBpdCBleGlzdHMgYW5kIGlzIGEgbGF1bmNoYWJsZSBhY3Rpdml0eWApO1xuICAgIH0gZWxzZSBpZiAoc3Rkb3V0LmluY2x1ZGVzKCdFcnJvcjogSW50ZW50IGRvZXMgbm90IG1hdGNoIGFueSBhY3Rpdml0aWVzJykgfHwgc3Rkb3V0LmluY2x1ZGVzKCdFcnJvcjogQWN0aXZpdHkgbm90IHN0YXJ0ZWQsIHVuYWJsZSB0byByZXNvbHZlIEludGVudCcpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEFjdGl2aXR5IGZvciBpbnRlbnQgJyR7aW50ZW50TmFtZX0nIHVzZWQgdG8gc3RhcnQgdGhlIGFwcCBkb2Vzbid0IGAgK1xuICAgICAgICAgICAgICAgICAgICAgIGBleGlzdCBvciBjYW5ub3QgYmUgbGF1bmNoZWQhIE1ha2Ugc3VyZSBpdCBleGlzdHMgYW5kIGlzIGEgbGF1bmNoYWJsZSBhY3Rpdml0eWApO1xuICAgIH0gZWxzZSBpZiAoc3Rkb3V0LmluY2x1ZGVzKCdqYXZhLmxhbmcuU2VjdXJpdHlFeGNlcHRpb24nKSkge1xuICAgICAgLy8gaWYgdGhlIGFwcCBpcyBkaXNhYmxlZCBvbiBhIHJlYWwgZGV2aWNlIGl0IHdpbGwgdGhyb3cgYSBzZWN1cml0eSBleGNlcHRpb25cbiAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlIHBlcm1pc3Npb24gdG8gc3RhcnQgJyR7c3RhcnRBcHBPcHRpb25zLmFjdGl2aXR5fScgYWN0aXZpdHkgaGFzIGJlZW4gZGVuaWVkLmAgK1xuICAgICAgICAgICAgICAgICAgICAgIGBNYWtlIHN1cmUgdGhlIGFjdGl2aXR5L3BhY2thZ2UgbmFtZXMgYXJlIGNvcnJlY3QuYCk7XG4gICAgfVxuICAgIGlmIChzdGFydEFwcE9wdGlvbnMud2FpdEFjdGl2aXR5KSB7XG4gICAgICBhd2FpdCB0aGlzLndhaXRGb3JBY3Rpdml0eShzdGFydEFwcE9wdGlvbnMud2FpdFBrZywgc3RhcnRBcHBPcHRpb25zLndhaXRBY3Rpdml0eSwgc3RhcnRBcHBPcHRpb25zLndhaXREdXJhdGlvbik7XG4gICAgfVxuICAgIHJldHVybiBzdGRvdXQ7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zdCBhcHBEZXNjcmlwdG9yID0gc3RhcnRBcHBPcHRpb25zLnBrZyB8fCBpbnRlbnROYW1lO1xuICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IHN0YXJ0IHRoZSAnJHthcHBEZXNjcmlwdG9yfScgYXBwbGljYXRpb24uIGAgK1xuICAgICAgYENvbnNpZGVyIGNoZWNraW5nIHRoZSBkcml2ZXIncyB0cm91Ymxlc2hvb3RpbmcgZG9jdW1lbnRhdGlvbi4gYCArXG4gICAgICBgT3JpZ2luYWwgZXJyb3I6ICR7ZS5tZXNzYWdlfWApO1xuICB9XG59O1xuXG4vKipcbiAqIEhlbHBlciBtZXRob2QgdG8gY2FsbCBgYWRiIGR1bXBzeXMgd2luZG93IHdpbmRvd3MvZGlzcGxheXNgXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5kdW1wV2luZG93cyA9IGFzeW5jIGZ1bmN0aW9uIGR1bXBXaW5kb3dzICgpIHtcbiAgY29uc3QgYXBpTGV2ZWwgPSBhd2FpdCB0aGlzLmdldEFwaUxldmVsKCk7XG5cbiAgLy8gV2l0aCB2ZXJzaW9uIDI5LCBBbmRyb2lkIGNoYW5nZWQgdGhlIGR1bXBzeXMgc3ludGF4XG4gIGNvbnN0IGR1bXBzeXNBcmcgPSBhcGlMZXZlbCA+PSAyOSA/ICdkaXNwbGF5cycgOiAnd2luZG93cyc7XG4gIGNvbnN0IGNtZCA9IFsnZHVtcHN5cycsICd3aW5kb3cnLCBkdW1wc3lzQXJnXTtcblxuICByZXR1cm4gYXdhaXQgdGhpcy5zaGVsbChjbWQpO1xufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBQYWNrYWdlQWN0aXZpdHlJbmZvXG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IGFwcFBhY2thZ2UgLSBUaGUgbmFtZSBvZiBhcHBsaWNhdGlvbiBwYWNrYWdlLFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGV4YW1wbGUgJ2NvbS5hY21lLmFwcCcuXG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IGFwcEFjdGl2aXR5IC0gVGhlIG5hbWUgb2YgbWFpbiBhcHBsaWNhdGlvbiBhY3Rpdml0eS5cbiAqL1xuXG4vKipcbiAqIEdldCB0aGUgbmFtZSBvZiBjdXJyZW50bHkgZm9jdXNlZCBwYWNrYWdlIGFuZCBhY3Rpdml0eS5cbiAqXG4gKiBAcmV0dXJuIHtQYWNrYWdlQWN0aXZpdHlJbmZvfSBUaGUgbWFwcGluZywgd2hlcmUgcHJvcGVydHkgbmFtZXMgYXJlICdhcHBQYWNrYWdlJyBhbmQgJ2FwcEFjdGl2aXR5Jy5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGVyZSBpcyBhbiBlcnJvciB3aGlsZSBwYXJzaW5nIHRoZSBkYXRhLlxuICovXG5hcGtVdGlsc01ldGhvZHMuZ2V0Rm9jdXNlZFBhY2thZ2VBbmRBY3Rpdml0eSA9IGFzeW5jIGZ1bmN0aW9uIGdldEZvY3VzZWRQYWNrYWdlQW5kQWN0aXZpdHkgKCkge1xuICBsb2cuZGVidWcoJ0dldHRpbmcgZm9jdXNlZCBwYWNrYWdlIGFuZCBhY3Rpdml0eScpO1xuICBsZXQgc3Rkb3V0O1xuICB0cnkge1xuICAgIHN0ZG91dCA9IGF3YWl0IHRoaXMuZHVtcFdpbmRvd3MoKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBDb3VsZCBub3QgcmV0cmlldmUgdGhlIGN1cnJlbnRseSBmb2N1c2VkIHBhY2thZ2UgYW5kIGFjdGl2aXR5LiBPcmlnaW5hbCBlcnJvcjogJHtlLm1lc3NhZ2V9YFxuICAgICk7XG4gIH1cblxuICBjb25zdCBudWxsRm9jdXNlZEFwcFJlID0gL15cXHMqbUZvY3VzZWRBcHA9bnVsbC9tO1xuICAvLyBodHRwczovL3JlZ2V4MTAxLmNvbS9yL3haOHZGNy8xXG4gIGNvbnN0IGZvY3VzZWRBcHBSZSA9IG5ldyBSZWdFeHAoXG4gICAgJ15cXFxccyptRm9jdXNlZEFwcC4rUmVjb3JkXFxcXHsuKlxcXFxzKFteXFxcXHNcXFxcL1xcXFx9XSspXFxcXC8oW15cXFxcc1xcXFwvXFxcXH1cXFxcLF0rKVxcXFwsPyhcXFxcc1teXFxcXHNcXFxcL1xcXFx9XSspKlxcXFx9JyxcbiAgICAnbWcnXG4gICk7XG4gIGNvbnN0IG51bGxDdXJyZW50Rm9jdXNSZSA9IC9eXFxzKm1DdXJyZW50Rm9jdXM9bnVsbC9tO1xuICBjb25zdCBjdXJyZW50Rm9jdXNBcHBSZSA9IG5ldyBSZWdFeHAoJ15cXFxccyptQ3VycmVudEZvY3VzLitcXFxcey4rXFxcXHMoW15cXFxcc1xcXFwvXSspXFxcXC8oW15cXFxcc10rKVxcXFxiJywgJ21nJyk7XG5cbiAgY29uc3QgZm9jdXNlZEFwcENhbmRpZGF0ZXMgPSBbXTtcbiAgY29uc3QgY3VycmVudEZvY3VzQXBwQ2FuZGlkYXRlcyA9IFtdO1xuICBmb3IgKGNvbnN0IFtjYW5kaWRhdGVzLCBwYXR0ZXJuXSBvZiBbXG4gICAgW2ZvY3VzZWRBcHBDYW5kaWRhdGVzLCBmb2N1c2VkQXBwUmVdLFxuICAgIFtjdXJyZW50Rm9jdXNBcHBDYW5kaWRhdGVzLCBjdXJyZW50Rm9jdXNBcHBSZV1cbiAgXSkge1xuICAgIGxldCBtYXRjaDtcbiAgICB3aGlsZSAoKG1hdGNoID0gcGF0dGVybi5leGVjKHN0ZG91dCkpKSB7XG4gICAgICBjYW5kaWRhdGVzLnB1c2goe1xuICAgICAgICBhcHBQYWNrYWdlOiBtYXRjaFsxXS50cmltKCksXG4gICAgICAgIGFwcEFjdGl2aXR5OiBtYXRjaFsyXS50cmltKClcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBpZiAoZm9jdXNlZEFwcENhbmRpZGF0ZXMubGVuZ3RoID4gMSAmJiBjdXJyZW50Rm9jdXNBcHBDYW5kaWRhdGVzLmxlbmd0aCA+IDApIHtcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vYXBwaXVtL2FwcGl1bS9pc3N1ZXMvMTcxMDZcbiAgICByZXR1cm4gXy5pbnRlcnNlY3Rpb25XaXRoKGZvY3VzZWRBcHBDYW5kaWRhdGVzLCBjdXJyZW50Rm9jdXNBcHBDYW5kaWRhdGVzLCBfLmlzRXF1YWwpWzBdXG4gICAgICA/PyBmb2N1c2VkQXBwQ2FuZGlkYXRlc1swXTtcbiAgfVxuICBpZiAoZm9jdXNlZEFwcENhbmRpZGF0ZXMubGVuZ3RoID4gMCB8fCBjdXJyZW50Rm9jdXNBcHBDYW5kaWRhdGVzLmxlbmd0aCA+IDApIHtcbiAgICByZXR1cm4gZm9jdXNlZEFwcENhbmRpZGF0ZXNbMF0gPz8gY3VycmVudEZvY3VzQXBwQ2FuZGlkYXRlc1swXTtcbiAgfVxuXG4gIGZvciAoY29uc3QgcGF0dGVybiBvZiBbbnVsbEZvY3VzZWRBcHBSZSwgbnVsbEN1cnJlbnRGb2N1c1JlXSkge1xuICAgIGlmIChwYXR0ZXJuLmV4ZWMoc3Rkb3V0KSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYXBwUGFja2FnZTogbnVsbCxcbiAgICAgICAgYXBwQWN0aXZpdHk6IG51bGxcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgbG9nLmRlYnVnKHN0ZG91dCk7XG4gIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IHJldHJpZXZlIHRoZSBjdXJyZW50bHkgZm9jdXNlZCBwYWNrYWdlIGFuZCBhY3Rpdml0eScpO1xufTtcblxuLyoqXG4gKiBXYWl0IGZvciB0aGUgZ2l2ZW4gYWN0aXZpdHkgdG8gYmUgZm9jdXNlZC9ub24tZm9jdXNlZC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcGtnIC0gVGhlIG5hbWUgb2YgdGhlIHBhY2thZ2UgdG8gd2FpdCBmb3IuXG4gKiBAcGFyYW0ge3N0cmluZ30gYWN0aXZpdHkgLSBUaGUgbmFtZSBvZiB0aGUgYWN0aXZpdHksIGJlbG9uZ2luZyB0byB0aGF0IHBhY2thZ2UsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0byB3YWl0IGZvci5cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gd2FpdEZvclN0b3AgLSBXaGV0aGVyIHRvIHdhaXQgdW50aWwgdGhlIGFjdGl2aXR5IGlzIGZvY3VzZWQgKHRydWUpXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3IgaXMgbm90IGZvY3VzZWQgKGZhbHNlKS5cbiAqIEBwYXJhbSB7bnVtYmVyfSB3YWl0TXMgWzIwMDAwXSAtIE51bWJlciBvZiBtaWxsaXNlY29uZHMgdG8gd2FpdCBiZWZvcmUgdGltZW91dCBvY2N1cnMuXG4gKiBAdGhyb3dzIHtlcnJvcn0gSWYgdGltZW91dCBoYXBwZW5zLlxuICovXG5hcGtVdGlsc01ldGhvZHMud2FpdEZvckFjdGl2aXR5T3JOb3QgPSBhc3luYyBmdW5jdGlvbiB3YWl0Rm9yQWN0aXZpdHlPck5vdCAocGtnLCBhY3Rpdml0eSwgd2FpdEZvclN0b3AsIHdhaXRNcyA9IDIwMDAwKSB7XG4gIGlmICghcGtnIHx8ICFhY3Rpdml0eSkge1xuICAgIHRocm93IG5ldyBFcnJvcignUGFja2FnZSBhbmQgYWN0aXZpdHkgcmVxdWlyZWQuJyk7XG4gIH1cbiAgbG9nLmRlYnVnKGBXYWl0aW5nIHVwIHRvICR7d2FpdE1zfW1zIGZvciBhY3Rpdml0eSBtYXRjaGluZyBwa2c6ICcke3BrZ30nIGFuZCBgICtcbiAgICAgICAgICAgIGBhY3Rpdml0eTogJyR7YWN0aXZpdHl9JyB0byR7d2FpdEZvclN0b3AgPyAnIG5vdCcgOiAnJ30gYmUgZm9jdXNlZGApO1xuXG4gIGNvbnN0IHNwbGl0TmFtZXMgPSAobmFtZXMpID0+IG5hbWVzLnNwbGl0KCcsJykubWFwKChuYW1lKSA9PiBuYW1lLnRyaW0oKSk7XG4gIGNvbnN0IGFsbFBhY2thZ2VzID0gc3BsaXROYW1lcyhwa2cpO1xuICBjb25zdCBhbGxBY3Rpdml0aWVzID0gc3BsaXROYW1lcyhhY3Rpdml0eSk7XG5cbiAgY29uc3QgcG9zc2libGVBY3Rpdml0eU5hbWVzID0gW107XG4gIGZvciAoY29uc3Qgb25lQWN0aXZpdHkgb2YgYWxsQWN0aXZpdGllcykge1xuICAgIGlmIChvbmVBY3Rpdml0eS5zdGFydHNXaXRoKCcuJykpIHtcbiAgICAgIC8vIGFkZCB0aGUgcGFja2FnZSBuYW1lIGlmIGFjdGl2aXR5IGlzIG5vdCBmdWxsIHF1YWxpZmllZFxuICAgICAgZm9yIChjb25zdCBjdXJyZW50UGtnIG9mIGFsbFBhY2thZ2VzKSB7XG4gICAgICAgIHBvc3NpYmxlQWN0aXZpdHlOYW1lcy5wdXNoKGAke2N1cnJlbnRQa2d9JHtvbmVBY3Rpdml0eX1gLnJlcGxhY2UoL1xcLisvZywgJy4nKSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGFjY2VwdCBmdWxseSBxdWFsaWZpZWQgYWN0aXZpdHkgbmFtZS5cbiAgICAgIHBvc3NpYmxlQWN0aXZpdHlOYW1lcy5wdXNoKG9uZUFjdGl2aXR5KTtcbiAgICAgIHBvc3NpYmxlQWN0aXZpdHlOYW1lcy5wdXNoKGAke3BrZ30uJHtvbmVBY3Rpdml0eX1gKTtcbiAgICB9XG4gIH1cbiAgbG9nLmRlYnVnKGBQb3NzaWJsZSBhY3Rpdml0aWVzLCB0byBiZSBjaGVja2VkOiAke3Bvc3NpYmxlQWN0aXZpdHlOYW1lcy5tYXAoKG5hbWUpID0+IGAnJHtuYW1lfSdgKS5qb2luKCcsICcpfWApO1xuXG4gIGNvbnN0IHBvc3NpYmxlQWN0aXZpdHlQYXR0ZXJucyA9IHBvc3NpYmxlQWN0aXZpdHlOYW1lcy5tYXAoXG4gICAgKGFjdE5hbWUpID0+IG5ldyBSZWdFeHAoYF4ke2FjdE5hbWUucmVwbGFjZSgvXFwuL2csICdcXFxcLicpLnJlcGxhY2UoL1xcKi9nLCAnLio/JykucmVwbGFjZSgvXFwkL2csICdcXFxcJCcpfSRgKVxuICApO1xuXG4gIGNvbnN0IGNvbmRpdGlvbkZ1bmMgPSBhc3luYyAoKSA9PiB7XG4gICAgbGV0IGFwcFBhY2thZ2U7XG4gICAgbGV0IGFwcEFjdGl2aXR5O1xuICAgIHRyeSB7XG4gICAgICAoe2FwcFBhY2thZ2UsIGFwcEFjdGl2aXR5fSA9IGF3YWl0IHRoaXMuZ2V0Rm9jdXNlZFBhY2thZ2VBbmRBY3Rpdml0eSgpKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2cuZGVidWcoZS5tZXNzYWdlKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKGFwcEFjdGl2aXR5ICYmIGFwcFBhY2thZ2UpIHtcbiAgICAgIGNvbnN0IGZ1bGx5UXVhbGlmaWVkQWN0aXZpdHkgPSBhcHBBY3Rpdml0eS5zdGFydHNXaXRoKCcuJykgPyBgJHthcHBQYWNrYWdlfSR7YXBwQWN0aXZpdHl9YCA6IGFwcEFjdGl2aXR5O1xuICAgICAgbG9nLmRlYnVnKGBGb3VuZCBwYWNrYWdlOiAnJHthcHBQYWNrYWdlfScgYW5kIGZ1bGx5IHF1YWxpZmllZCBhY3Rpdml0eSBuYW1lIDogJyR7ZnVsbHlRdWFsaWZpZWRBY3Rpdml0eX0nYCk7XG4gICAgICBjb25zdCBpc0FjdGl2aXR5Rm91bmQgPSBfLmluY2x1ZGVzKGFsbFBhY2thZ2VzLCBhcHBQYWNrYWdlKVxuICAgICAgICAmJiBwb3NzaWJsZUFjdGl2aXR5UGF0dGVybnMuc29tZSgocCkgPT4gcC50ZXN0KGZ1bGx5UXVhbGlmaWVkQWN0aXZpdHkpKTtcbiAgICAgIGlmICgoIXdhaXRGb3JTdG9wICYmIGlzQWN0aXZpdHlGb3VuZCkgfHwgKHdhaXRGb3JTdG9wICYmICFpc0FjdGl2aXR5Rm91bmQpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICBsb2cuZGVidWcoJ0luY29ycmVjdCBwYWNrYWdlIGFuZCBhY3Rpdml0eS4gUmV0cnlpbmcuJyk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIHRyeSB7XG4gICAgYXdhaXQgd2FpdEZvckNvbmRpdGlvbihjb25kaXRpb25GdW5jLCB7XG4gICAgICB3YWl0TXM6IHBhcnNlSW50KHdhaXRNcywgMTApLFxuICAgICAgaW50ZXJ2YWxNczogNTAwLFxuICAgIH0pO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGAke3Bvc3NpYmxlQWN0aXZpdHlOYW1lcy5tYXAoKG5hbWUpID0+IGAnJHtuYW1lfSdgKS5qb2luKCcgb3IgJyl9IG5ldmVyICR7d2FpdEZvclN0b3AgPyAnc3RvcHBlZCcgOiAnc3RhcnRlZCd9LiBgICtcbiAgICAgIGBDb25zaWRlciBjaGVja2luZyB0aGUgZHJpdmVyJ3MgdHJvdWJsZXNob290aW5nIGRvY3VtZW50YXRpb24uYCk7XG4gIH1cbn07XG5cbi8qKlxuICogV2FpdCBmb3IgdGhlIGdpdmVuIGFjdGl2aXR5IHRvIGJlIGZvY3VzZWRcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcGtnIC0gVGhlIG5hbWUgb2YgdGhlIHBhY2thZ2UgdG8gd2FpdCBmb3IuXG4gKiBAcGFyYW0ge3N0cmluZ30gYWN0aXZpdHkgLSBUaGUgbmFtZSBvZiB0aGUgYWN0aXZpdHksIGJlbG9uZ2luZyB0byB0aGF0IHBhY2thZ2UsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0byB3YWl0IGZvci5cbiAqIEBwYXJhbSB7bnVtYmVyfSB3YWl0TXMgWzIwMDAwXSAtIE51bWJlciBvZiBtaWxsaXNlY29uZHMgdG8gd2FpdCBiZWZvcmUgdGltZW91dCBvY2N1cnMuXG4gKiBAdGhyb3dzIHtlcnJvcn0gSWYgdGltZW91dCBoYXBwZW5zLlxuICovXG5hcGtVdGlsc01ldGhvZHMud2FpdEZvckFjdGl2aXR5ID0gYXN5bmMgZnVuY3Rpb24gd2FpdEZvckFjdGl2aXR5IChwa2csIGFjdCwgd2FpdE1zID0gMjAwMDApIHtcbiAgYXdhaXQgdGhpcy53YWl0Rm9yQWN0aXZpdHlPck5vdChwa2csIGFjdCwgZmFsc2UsIHdhaXRNcyk7XG59O1xuXG4vKipcbiAqIFdhaXQgZm9yIHRoZSBnaXZlbiBhY3Rpdml0eSB0byBiZSBub24tZm9jdXNlZC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcGtnIC0gVGhlIG5hbWUgb2YgdGhlIHBhY2thZ2UgdG8gd2FpdCBmb3IuXG4gKiBAcGFyYW0ge3N0cmluZ30gYWN0aXZpdHkgLSBUaGUgbmFtZSBvZiB0aGUgYWN0aXZpdHksIGJlbG9uZ2luZyB0byB0aGF0IHBhY2thZ2UsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0byB3YWl0IGZvci5cbiAqIEBwYXJhbSB7bnVtYmVyfSB3YWl0TXMgWzIwMDAwXSAtIE51bWJlciBvZiBtaWxsaXNlY29uZHMgdG8gd2FpdCBiZWZvcmUgdGltZW91dCBvY2N1cnMuXG4gKiBAdGhyb3dzIHtlcnJvcn0gSWYgdGltZW91dCBoYXBwZW5zLlxuICovXG5hcGtVdGlsc01ldGhvZHMud2FpdEZvck5vdEFjdGl2aXR5ID0gYXN5bmMgZnVuY3Rpb24gd2FpdEZvck5vdEFjdGl2aXR5IChwa2csIGFjdCwgd2FpdE1zID0gMjAwMDApIHtcbiAgYXdhaXQgdGhpcy53YWl0Rm9yQWN0aXZpdHlPck5vdChwa2csIGFjdCwgdHJ1ZSwgd2FpdE1zKTtcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gVW5pbnN0YWxsT3B0aW9uc1xuICogQHByb3BlcnR5IHtudW1iZXJ9IHRpbWVvdXQgW2FkYkV4ZWNUaW1lb3V0XSAtIFRoZSBjb3VudCBvZiBtaWxsaXNlY29uZHMgdG8gd2FpdCB1bnRpbCB0aGVcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHAgaXMgdW5pbnN0YWxsZWQuXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IGtlZXBEYXRhIFtmYWxzZV0gLSBTZXQgdG8gdHJ1ZSBpbiBvcmRlciB0byBrZWVwIHRoZVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGljYXRpb24gZGF0YSBhbmQgY2FjaGUgZm9sZGVycyBhZnRlciB1bmluc3RhbGwuXG4gKi9cblxuLyoqXG4gKiBVbmluc3RhbGwgdGhlIGdpdmVuIHBhY2thZ2UgZnJvbSB0aGUgZGV2aWNlIHVuZGVyIHRlc3QuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHBrZyAtIFRoZSBuYW1lIG9mIHRoZSBwYWNrYWdlIHRvIGJlIHVuaW5zdGFsbGVkLlxuICogQHBhcmFtIHs/VW5pbnN0YWxsT3B0aW9uc30gb3B0aW9ucyAtIFRoZSBzZXQgb2YgdW5pbnN0YWxsIG9wdGlvbnMuXG4gKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIHRoZSBwYWNrYWdlIHdhcyBmb3VuZCBvbiB0aGUgZGV2aWNlIGFuZFxuICogICAgICAgICAgICAgICAgICAgc3VjY2Vzc2Z1bGx5IHVuaW5zdGFsbGVkLlxuICovXG5hcGtVdGlsc01ldGhvZHMudW5pbnN0YWxsQXBrID0gYXN5bmMgZnVuY3Rpb24gdW5pbnN0YWxsQXBrIChwa2csIG9wdGlvbnMgPSB7fSkge1xuICBsb2cuZGVidWcoYFVuaW5zdGFsbGluZyAke3BrZ31gKTtcbiAgaWYgKCFhd2FpdCB0aGlzLmlzQXBwSW5zdGFsbGVkKHBrZykpIHtcbiAgICBsb2cuaW5mbyhgJHtwa2d9IHdhcyBub3QgdW5pbnN0YWxsZWQsIGJlY2F1c2UgaXQgd2FzIG5vdCBwcmVzZW50IG9uIHRoZSBkZXZpY2VgKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBjb25zdCBjbWQgPSBbJ3VuaW5zdGFsbCddO1xuICBpZiAob3B0aW9ucy5rZWVwRGF0YSkge1xuICAgIGNtZC5wdXNoKCctaycpO1xuICB9XG4gIGNtZC5wdXNoKHBrZyk7XG5cbiAgbGV0IHN0ZG91dDtcbiAgdHJ5IHtcbiAgICBhd2FpdCB0aGlzLmZvcmNlU3RvcChwa2cpO1xuICAgIHN0ZG91dCA9IChhd2FpdCB0aGlzLmFkYkV4ZWMoY21kLCB7dGltZW91dDogb3B0aW9ucy50aW1lb3V0fSkpLnRyaW0oKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgVW5hYmxlIHRvIHVuaW5zdGFsbCBBUEsuIE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgfVxuICBsb2cuZGVidWcoYCdhZGIgJHtjbWQuam9pbignICcpfScgY29tbWFuZCBvdXRwdXQ6ICR7c3Rkb3V0fWApO1xuICBpZiAoc3Rkb3V0LmluY2x1ZGVzKCdTdWNjZXNzJykpIHtcbiAgICBsb2cuaW5mbyhgJHtwa2d9IHdhcyBzdWNjZXNzZnVsbHkgdW5pbnN0YWxsZWRgKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBsb2cuaW5mbyhgJHtwa2d9IHdhcyBub3QgdW5pbnN0YWxsZWRgKTtcbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuLyoqXG4gKiBJbnN0YWxsIHRoZSBwYWNrYWdlIGFmdGVyIGl0IHdhcyBwdXNoZWQgdG8gdGhlIGRldmljZSB1bmRlciB0ZXN0LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBhcGtQYXRoT25EZXZpY2UgLSBUaGUgZnVsbCBwYXRoIHRvIHRoZSBwYWNrYWdlIG9uIHRoZSBkZXZpY2UgZmlsZSBzeXN0ZW0uXG4gKiBAcGFyYW0ge29iamVjdH0gb3B0cyBbe31dIC0gQWRkaXRpb25hbCBleGVjIG9wdGlvbnMuIFNlZSB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL2FwcGl1bS9ub2RlLXRlZW5fcHJvY2Vzc31cbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgbW9yZSBkZXRhaWxzIG9uIHRoaXMgcGFyYW1ldGVyLlxuICogQHRocm93cyB7ZXJyb3J9IElmIHRoZXJlIHdhcyBhIGZhaWx1cmUgZHVyaW5nIGFwcGxpY2F0aW9uIGluc3RhbGwuXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5pbnN0YWxsRnJvbURldmljZVBhdGggPSBhc3luYyBmdW5jdGlvbiBpbnN0YWxsRnJvbURldmljZVBhdGggKGFwa1BhdGhPbkRldmljZSwgb3B0cyA9IHt9KSB7XG4gIGxldCBzdGRvdXQgPSBhd2FpdCB0aGlzLnNoZWxsKFsncG0nLCAnaW5zdGFsbCcsICctcicsIGFwa1BhdGhPbkRldmljZV0sIG9wdHMpO1xuICBpZiAoc3Rkb3V0LmluZGV4T2YoJ0ZhaWx1cmUnKSAhPT0gLTEpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFJlbW90ZSBpbnN0YWxsIGZhaWxlZDogJHtzdGRvdXR9YCk7XG4gIH1cbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gQ2FjaGluZ09wdGlvbnNcbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0gdGltZW91dCBbYWRiRXhlY1RpbWVvdXRdIC0gVGhlIGNvdW50IG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0IHVudGlsIHRoZVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHAgaXMgdXBsb2FkZWQgdG8gdGhlIHJlbW90ZSBsb2NhdGlvbi5cbiAqL1xuXG4vKipcbiAqIENhY2hlcyB0aGUgZ2l2ZW4gQVBLIGF0IGEgcmVtb3RlIGxvY2F0aW9uIHRvIHNwZWVkIHVwIGZ1cnRoZXIgQVBLIGRlcGxveW1lbnRzLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBhcGtQYXRoIC0gRnVsbCBwYXRoIHRvIHRoZSBhcGsgb24gdGhlIGxvY2FsIEZTXG4gKiBAcGFyYW0gez9DYWNoaW5nT3B0aW9uc30gb3B0aW9ucyAtIENhY2hpbmcgb3B0aW9uc1xuICogQHJldHVybnMge3N0cmluZ30gLSBGdWxsIHBhdGggdG8gdGhlIGNhY2hlZCBhcGsgb24gdGhlIHJlbW90ZSBmaWxlIHN5c3RlbVxuICogQHRocm93cyB7RXJyb3J9IGlmIHRoZXJlIHdhcyBhIGZhaWx1cmUgd2hpbGUgY2FjaGluZyB0aGUgYXBwXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5jYWNoZUFwayA9IGFzeW5jIGZ1bmN0aW9uIGNhY2hlQXBrIChhcGtQYXRoLCBvcHRpb25zID0ge30pIHtcbiAgY29uc3QgYXBwSGFzaCA9IGF3YWl0IGZzLmhhc2goYXBrUGF0aCk7XG4gIGNvbnN0IHJlbW90ZVBhdGggPSBwYXRoLnBvc2l4LmpvaW4oUkVNT1RFX0NBQ0hFX1JPT1QsIGAke2FwcEhhc2h9LmFwa2ApO1xuICBjb25zdCByZW1vdGVDYWNoZWRGaWxlcyA9IFtdO1xuICAvLyBHZXQgY3VycmVudCBjb250ZW50cyBvZiB0aGUgcmVtb3RlIGNhY2hlIG9yIGNyZWF0ZSBpdCBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgdHJ5IHtcbiAgICBjb25zdCBlcnJvck1hcmtlciA9ICdfRVJST1JfJztcbiAgICBsZXQgbHNPdXRwdXQgPSBudWxsO1xuICAgIGlmICh0aGlzLl9hcmVFeHRlbmRlZExzT3B0aW9uc1N1cHBvcnRlZCA9PT0gdHJ1ZSB8fCAhXy5pc0Jvb2xlYW4odGhpcy5fYXJlRXh0ZW5kZWRMc09wdGlvbnNTdXBwb3J0ZWQpKSB7XG4gICAgICBsc091dHB1dCA9IGF3YWl0IHRoaXMuc2hlbGwoW2BscyAtdCAtMSAke1JFTU9URV9DQUNIRV9ST09UfSAyPiYxIHx8IGVjaG8gJHtlcnJvck1hcmtlcn1gXSk7XG4gICAgfVxuICAgIGlmICghXy5pc1N0cmluZyhsc091dHB1dCkgfHwgKGxzT3V0cHV0LmluY2x1ZGVzKGVycm9yTWFya2VyKSAmJiAhbHNPdXRwdXQuaW5jbHVkZXMoUkVNT1RFX0NBQ0hFX1JPT1QpKSkge1xuICAgICAgaWYgKCFfLmlzQm9vbGVhbih0aGlzLl9hcmVFeHRlbmRlZExzT3B0aW9uc1N1cHBvcnRlZCkpIHtcbiAgICAgICAgbG9nLmRlYnVnKCdUaGUgY3VycmVudCBBbmRyb2lkIEFQSSBkb2VzIG5vdCBzdXBwb3J0IGV4dGVuZGVkIGxzIG9wdGlvbnMuICcgK1xuICAgICAgICAgICdEZWZhdWx0aW5nIHRvIG5vLW9wdGlvbnMgY2FsbCcpO1xuICAgICAgfVxuICAgICAgbHNPdXRwdXQgPSBhd2FpdCB0aGlzLnNoZWxsKFtgbHMgJHtSRU1PVEVfQ0FDSEVfUk9PVH0gMj4mMSB8fCBlY2hvICR7ZXJyb3JNYXJrZXJ9YF0pO1xuICAgICAgdGhpcy5fYXJlRXh0ZW5kZWRMc09wdGlvbnNTdXBwb3J0ZWQgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYXJlRXh0ZW5kZWRMc09wdGlvbnNTdXBwb3J0ZWQgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAobHNPdXRwdXQuaW5jbHVkZXMoZXJyb3JNYXJrZXIpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IobHNPdXRwdXQuc3Vic3RyaW5nKDAsIGxzT3V0cHV0LmluZGV4T2YoZXJyb3JNYXJrZXIpKSk7XG4gICAgfVxuICAgIHJlbW90ZUNhY2hlZEZpbGVzLnB1c2goLi4uKFxuICAgICAgbHNPdXRwdXQuc3BsaXQoJ1xcbicpXG4gICAgICAgIC5tYXAoKHgpID0+IHgudHJpbSgpKVxuICAgICAgICAuZmlsdGVyKEJvb2xlYW4pXG4gICAgKSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBsb2cuZGVidWcoYEdvdCBhbiBlcnJvciAnJHtlLm1lc3NhZ2UudHJpbSgpfScgd2hpbGUgZ2V0dGluZyB0aGUgbGlzdCBvZiBmaWxlcyBpbiB0aGUgY2FjaGUuIGAgK1xuICAgICAgYEFzc3VtaW5nIHRoZSBjYWNoZSBkb2VzIG5vdCBleGlzdCB5ZXRgKTtcbiAgICBhd2FpdCB0aGlzLnNoZWxsKFsnbWtkaXInLCAnLXAnLCBSRU1PVEVfQ0FDSEVfUk9PVF0pO1xuICB9XG4gIGxvZy5kZWJ1ZyhgVGhlIGNvdW50IG9mIGFwcGxpY2F0aW9ucyBpbiB0aGUgY2FjaGU6ICR7cmVtb3RlQ2FjaGVkRmlsZXMubGVuZ3RofWApO1xuICBjb25zdCB0b0hhc2ggPSAocmVtb3RlUGF0aCkgPT4gcGF0aC5wb3NpeC5wYXJzZShyZW1vdGVQYXRoKS5uYW1lO1xuICAvLyBQdXNoIHRoZSBhcGsgdG8gdGhlIHJlbW90ZSBjYWNoZSBpZiBuZWVkZWRcbiAgaWYgKHJlbW90ZUNhY2hlZEZpbGVzLnNvbWUoKHgpID0+IHRvSGFzaCh4KSA9PT0gYXBwSGFzaCkpIHtcbiAgICBsb2cuaW5mbyhgVGhlIGFwcGxpY2F0aW9uIGF0ICcke2Fwa1BhdGh9JyBpcyBhbHJlYWR5IGNhY2hlZCB0byAnJHtyZW1vdGVQYXRofSdgKTtcbiAgICAvLyBVcGRhdGUgdGhlIGFwcGxpY2F0aW9uIHRpbWVzdGFtcCBhc3luY2hyb25vdXNseSBpbiBvcmRlciB0byBidW1wIGl0cyBwb3NpdGlvblxuICAgIC8vIGluIHRoZSBzb3J0ZWQgbHMgb3V0cHV0XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByb21pc2UvcHJlZmVyLWF3YWl0LXRvLXRoZW5cbiAgICB0aGlzLnNoZWxsKFsndG91Y2gnLCAnLWFtJywgcmVtb3RlUGF0aF0pLmNhdGNoKCgpID0+IHt9KTtcbiAgfSBlbHNlIHtcbiAgICBsb2cuaW5mbyhgQ2FjaGluZyB0aGUgYXBwbGljYXRpb24gYXQgJyR7YXBrUGF0aH0nIHRvICcke3JlbW90ZVBhdGh9J2ApO1xuICAgIGNvbnN0IHRpbWVyID0gbmV3IHRpbWluZy5UaW1lcigpLnN0YXJ0KCk7XG4gICAgYXdhaXQgdGhpcy5wdXNoKGFwa1BhdGgsIHJlbW90ZVBhdGgsIHt0aW1lb3V0OiBvcHRpb25zLnRpbWVvdXR9KTtcbiAgICBjb25zdCB7c2l6ZX0gPSBhd2FpdCBmcy5zdGF0KGFwa1BhdGgpO1xuICAgIGxvZy5pbmZvKGBUaGUgdXBsb2FkIG9mICcke3BhdGguYmFzZW5hbWUoYXBrUGF0aCl9JyAoJHt1dGlsLnRvUmVhZGFibGVTaXplU3RyaW5nKHNpemUpfSkgYCArXG4gICAgICBgdG9vayAke3RpbWVyLmdldER1cmF0aW9uKCkuYXNNaWxsaVNlY29uZHMudG9GaXhlZCgwKX1tc2ApO1xuICB9XG4gIGlmICghdGhpcy5yZW1vdGVBcHBzQ2FjaGUpIHtcbiAgICB0aGlzLnJlbW90ZUFwcHNDYWNoZSA9IG5ldyBMUlUoe1xuICAgICAgbWF4OiB0aGlzLnJlbW90ZUFwcHNDYWNoZUxpbWl0LFxuICAgIH0pO1xuICB9XG4gIC8vIENsZWFudXAgdGhlIGludmFsaWQgZW50cmllcyBmcm9tIHRoZSBjYWNoZVxuICBfLmRpZmZlcmVuY2UoWy4uLnRoaXMucmVtb3RlQXBwc0NhY2hlLmtleXMoKV0sIHJlbW90ZUNhY2hlZEZpbGVzLm1hcCh0b0hhc2gpKVxuICAgIC5mb3JFYWNoKChoYXNoKSA9PiB0aGlzLnJlbW90ZUFwcHNDYWNoZS5kZWwoaGFzaCkpO1xuICAvLyBCdW1wIHRoZSBjYWNoZSByZWNvcmQgZm9yIHRoZSByZWNlbnRseSBjYWNoZWQgaXRlbVxuICB0aGlzLnJlbW90ZUFwcHNDYWNoZS5zZXQoYXBwSGFzaCwgcmVtb3RlUGF0aCk7XG4gIC8vIElmIHRoZSByZW1vdGUgY2FjaGUgZXhjZWVkcyB0aGlzLnJlbW90ZUFwcHNDYWNoZUxpbWl0LCByZW1vdmUgdGhlIGxlYXN0IHJlY2VudGx5IHVzZWQgZW50cmllc1xuICBjb25zdCBlbnRyaWVzVG9DbGVhbnVwID0gcmVtb3RlQ2FjaGVkRmlsZXNcbiAgICAubWFwKCh4KSA9PiBwYXRoLnBvc2l4LmpvaW4oUkVNT1RFX0NBQ0hFX1JPT1QsIHgpKVxuICAgIC5maWx0ZXIoKHgpID0+ICF0aGlzLnJlbW90ZUFwcHNDYWNoZS5oYXModG9IYXNoKHgpKSlcbiAgICAuc2xpY2UodGhpcy5yZW1vdGVBcHBzQ2FjaGVMaW1pdCAtIFsuLi50aGlzLnJlbW90ZUFwcHNDYWNoZS5rZXlzKCldLmxlbmd0aCk7XG4gIGlmICghXy5pc0VtcHR5KGVudHJpZXNUb0NsZWFudXApKSB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuc2hlbGwoWydybScsICctZicsIC4uLmVudHJpZXNUb0NsZWFudXBdKTtcbiAgICAgIGxvZy5kZWJ1ZyhgRGVsZXRlZCAke2VudHJpZXNUb0NsZWFudXAubGVuZ3RofSBleHBpcmVkIGFwcGxpY2F0aW9uIGNhY2hlIGVudHJpZXNgKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2cud2FybihgQ2Fubm90IGRlbGV0ZSAke2VudHJpZXNUb0NsZWFudXAubGVuZ3RofSBleHBpcmVkIGFwcGxpY2F0aW9uIGNhY2hlIGVudHJpZXMuIGAgK1xuICAgICAgICBgT3JpZ2luYWwgZXJyb3I6ICR7ZS5tZXNzYWdlfWApO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVtb3RlUGF0aDtcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gSW5zdGFsbE9wdGlvbnNcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSB0aW1lb3V0IFs2MDAwMF0gLSBUaGUgY291bnQgb2YgbWlsbGlzZWNvbmRzIHRvIHdhaXQgdW50aWwgdGhlXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwIGlzIGluc3RhbGxlZC5cbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSB0aW1lb3V0Q2FwTmFtZSBbYW5kcm9pZEluc3RhbGxUaW1lb3V0XSAtIFRoZSB0aW1lb3V0IG9wdGlvbiBuYW1lXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VycyBjYW4gaW5jcmVhc2UgdGhlIHRpbWVvdXQuXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IGFsbG93VGVzdFBhY2thZ2VzIFtmYWxzZV0gLSBTZXQgdG8gdHJ1ZSBpbiBvcmRlciB0byBhbGxvdyB0ZXN0XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWNrYWdlcyBpbnN0YWxsYXRpb24uXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IHVzZVNkY2FyZCBbZmFsc2VdIC0gU2V0IHRvIHRydWUgdG8gaW5zdGFsbCB0aGUgYXBwIG9uIHNkY2FyZFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RlYWQgb2YgdGhlIGRldmljZSBtZW1vcnkuXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IGdyYW50UGVybWlzc2lvbnMgW2ZhbHNlXSAtIFNldCB0byB0cnVlIGluIG9yZGVyIHRvIGdyYW50IGFsbCB0aGVcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVybWlzc2lvbnMgcmVxdWVzdGVkIGluIHRoZSBhcHBsaWNhdGlvbidzIG1hbmlmZXN0XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9tYXRpY2FsbHkgYWZ0ZXIgdGhlIGluc3RhbGxhdGlvbiBpcyBjb21wbGV0ZWRcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5kZXIgQW5kcm9pZCA2Ky5cbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gcmVwbGFjZSBbdHJ1ZV0gLSBTZXQgaXQgdG8gZmFsc2UgaWYgeW91IGRvbid0IHdhbnRcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGUgYXBwbGljYXRpb24gdG8gYmUgdXBncmFkZWQvcmVpbnN0YWxsZWRcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpdCBpcyBhbHJlYWR5IHByZXNlbnQgb24gdGhlIGRldmljZS5cbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gbm9JbmNyZW1lbnRhbCBbZmFsc2VdIC0gRm9yY2VmdWxseSBkaXNhYmxlcyBpbmNyZW1lbnRhbCBpbnN0YWxscyBpZiBzZXQgdG8gYHRydWVgLlxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFkIGh0dHBzOi8vZGV2ZWxvcGVyLmFuZHJvaWQuY29tL3ByZXZpZXcvZmVhdHVyZXMjaW5jcmVtZW50YWxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIG1vcmUgZGV0YWlscy5cbiAqL1xuXG4vKipcbiAqIEluc3RhbGwgdGhlIHBhY2thZ2UgZnJvbSB0aGUgbG9jYWwgZmlsZSBzeXN0ZW0uXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGFwcFBhdGggLSBUaGUgZnVsbCBwYXRoIHRvIHRoZSBsb2NhbCBwYWNrYWdlLlxuICogQHBhcmFtIHs/SW5zdGFsbE9wdGlvbnN9IG9wdGlvbnMgLSBUaGUgc2V0IG9mIGluc3RhbGxhdGlvbiBvcHRpb25zLlxuICogQHRocm93cyB7RXJyb3J9IElmIGFuIHVuZXhwZWN0ZWQgZXJyb3IgaGFwcGVucyBkdXJpbmcgaW5zdGFsbC5cbiAqL1xuYXBrVXRpbHNNZXRob2RzLmluc3RhbGwgPSBhc3luYyBmdW5jdGlvbiBpbnN0YWxsIChhcHBQYXRoLCBvcHRpb25zID0ge30pIHtcbiAgaWYgKGFwcFBhdGguZW5kc1dpdGgoQVBLU19FWFRFTlNJT04pKSB7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuaW5zdGFsbEFwa3MoYXBwUGF0aCwgb3B0aW9ucyk7XG4gIH1cblxuICBvcHRpb25zID0gXy5jbG9uZURlZXAob3B0aW9ucyk7XG4gIF8uZGVmYXVsdHMob3B0aW9ucywge1xuICAgIHJlcGxhY2U6IHRydWUsXG4gICAgdGltZW91dDogdGhpcy5hZGJFeGVjVGltZW91dCA9PT0gREVGQVVMVF9BREJfRVhFQ19USU1FT1VUID8gQVBLX0lOU1RBTExfVElNRU9VVCA6IHRoaXMuYWRiRXhlY1RpbWVvdXQsXG4gICAgdGltZW91dENhcE5hbWU6ICdhbmRyb2lkSW5zdGFsbFRpbWVvdXQnLFxuICB9KTtcblxuICBjb25zdCBpbnN0YWxsQXJncyA9IGJ1aWxkSW5zdGFsbEFyZ3MoYXdhaXQgdGhpcy5nZXRBcGlMZXZlbCgpLCBvcHRpb25zKTtcbiAgaWYgKG9wdGlvbnMubm9JbmNyZW1lbnRhbCAmJiBhd2FpdCB0aGlzLmlzSW5jcmVtZW50YWxJbnN0YWxsU3VwcG9ydGVkKCkpIHtcbiAgICAvLyBBZGIgdGhyb3dzIGFuIGVycm9yIGlmIGl0IGRvZXMgbm90IGtub3cgYWJvdXQgYW4gYXJnLFxuICAgIC8vIHdoaWNoIGlzIHRoZSBjYXNlIGhlcmUgZm9yIG9sZGVyIGFkYiB2ZXJzaW9ucy5cbiAgICBpbnN0YWxsQXJncy5wdXNoKCctLW5vLWluY3JlbWVudGFsJyk7XG4gIH1cbiAgY29uc3QgaW5zdGFsbE9wdHMgPSB7XG4gICAgdGltZW91dDogb3B0aW9ucy50aW1lb3V0LFxuICAgIHRpbWVvdXRDYXBOYW1lOiBvcHRpb25zLnRpbWVvdXRDYXBOYW1lLFxuICB9O1xuICBjb25zdCBpbnN0YWxsQ21kID0gW1xuICAgICdpbnN0YWxsJyxcbiAgICAuLi5pbnN0YWxsQXJncyxcbiAgICBhcHBQYXRoLFxuICBdO1xuICBsZXQgcGVyZm9ybUFwcEluc3RhbGwgPSBhc3luYyAoKSA9PiBhd2FpdCB0aGlzLmFkYkV4ZWMoaW5zdGFsbENtZCwgaW5zdGFsbE9wdHMpO1xuICAvLyB0aGlzLnJlbW90ZUFwcHNDYWNoZUxpbWl0IDw9IDAgbWVhbnMgbm8gY2FjaGluZyBzaG91bGQgYmUgYXBwbGllZFxuICBsZXQgc2hvdWxkQ2FjaGVBcHAgPSB0aGlzLnJlbW90ZUFwcHNDYWNoZUxpbWl0ID4gMDtcbiAgaWYgKHNob3VsZENhY2hlQXBwKSB7XG4gICAgc2hvdWxkQ2FjaGVBcHAgPSAhKGF3YWl0IHRoaXMuaXNTdHJlYW1lZEluc3RhbGxTdXBwb3J0ZWQoKSk7XG4gICAgaWYgKCFzaG91bGRDYWNoZUFwcCkge1xuICAgICAgbG9nLmluZm8oYFRoZSBhcHBsaWNhdGlvbiBhdCAnJHthcHBQYXRofScgd2lsbCBub3QgYmUgY2FjaGVkLCBiZWNhdXNlIHRoZSBkZXZpY2UgdW5kZXIgdGVzdCBoYXMgYCArXG4gICAgICAgIGBjb25maXJtZWQgdGhlIHN1cHBvcnQgb2Ygc3RyZWFtZWQgaW5zdGFsbHNgKTtcbiAgICB9XG4gIH1cbiAgaWYgKHNob3VsZENhY2hlQXBwKSB7XG4gICAgY29uc3QgY2xlYXJDYWNoZSA9IGFzeW5jICgpID0+IHtcbiAgICAgIGxvZy5pbmZvKGBDbGVhcmluZyB0aGUgY2FjaGUgYXQgJyR7UkVNT1RFX0NBQ0hFX1JPT1R9J2ApO1xuICAgICAgYXdhaXQgdGhpcy5zaGVsbChbJ3JtJywgJy1yZicsIGAke1JFTU9URV9DQUNIRV9ST09UfS8qYF0pO1xuICAgIH07XG4gICAgY29uc3QgY2FjaGVBcHAgPSBhc3luYyAoKSA9PiBhd2FpdCB0aGlzLmNhY2hlQXBrKGFwcFBhdGgsIHtcbiAgICAgIHRpbWVvdXQ6IG9wdGlvbnMudGltZW91dCxcbiAgICB9KTtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY2FjaGVkQXBwUGF0aCA9IGF3YWl0IGNhY2hlQXBwKCk7XG4gICAgICBwZXJmb3JtQXBwSW5zdGFsbCA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgcG1JbnN0YWxsQ21kQnlSZW1vdGVQYXRoID0gKHJlbW90ZVBhdGgpID0+IFtcbiAgICAgICAgICAncG0nLCAnaW5zdGFsbCcsXG4gICAgICAgICAgLi4uaW5zdGFsbEFyZ3MsXG4gICAgICAgICAgcmVtb3RlUGF0aCxcbiAgICAgICAgXTtcbiAgICAgICAgY29uc3Qgb3V0cHV0ID0gYXdhaXQgdGhpcy5zaGVsbChwbUluc3RhbGxDbWRCeVJlbW90ZVBhdGgoY2FjaGVkQXBwUGF0aCksIGluc3RhbGxPcHRzKTtcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FwcGl1bS9hcHBpdW0vaXNzdWVzLzEzOTcwXG4gICAgICAgIGlmICgvXFxiSU5TVEFMTF9GQUlMRURfSU5TVUZGSUNJRU5UX1NUT1JBR0VcXGIvLnRlc3Qob3V0cHV0KSkge1xuICAgICAgICAgIGxvZy53YXJuKGBUaGVyZSB3YXMgYSBmYWlsdXJlIHdoaWxlIGluc3RhbGxpbmcgJyR7YXBwUGF0aH0nIGAgK1xuICAgICAgICAgICAgYGJlY2F1c2Ugb2YgdGhlIGluc3VmZmljaWVudCBkZXZpY2Ugc3RvcmFnZSBzcGFjZWApO1xuICAgICAgICAgIGF3YWl0IGNsZWFyQ2FjaGUoKTtcbiAgICAgICAgICBsb2cuaW5mbyhgQ29uc2lkZXIgZGVjcmVhc2luZyB0aGUgbWF4aW11bSBhbW91bnQgb2YgY2FjaGVkIGFwcHMgYCArXG4gICAgICAgICAgICBgKGN1cnJlbnRseSAke3RoaXMucmVtb3RlQXBwc0NhY2hlTGltaXR9KSB0byBhdm9pZCBzdWNoIGlzc3VlcyBpbiB0aGUgZnV0dXJlYCk7XG4gICAgICAgICAgY29uc3QgbmV3Q2FjaGVkQXBwUGF0aCA9IGF3YWl0IGNhY2hlQXBwKCk7XG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuc2hlbGwocG1JbnN0YWxsQ21kQnlSZW1vdGVQYXRoKG5ld0NhY2hlZEFwcFBhdGgpLCBpbnN0YWxsT3B0cyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgbG9nLmRlYnVnKGUpO1xuICAgICAgbG9nLndhcm4oYFRoZXJlIHdhcyBhIGZhaWx1cmUgd2hpbGUgY2FjaGluZyAnJHthcHBQYXRofSc6ICR7ZS5tZXNzYWdlfWApO1xuICAgICAgbG9nLndhcm4oJ0ZhbGxpbmcgYmFjayB0byB0aGUgZGVmYXVsdCBpbnN0YWxsYXRpb24gcHJvY2VkdXJlJyk7XG4gICAgICBhd2FpdCBjbGVhckNhY2hlKCk7XG4gICAgfVxuICB9XG4gIHRyeSB7XG4gICAgY29uc3QgdGltZXIgPSBuZXcgdGltaW5nLlRpbWVyKCkuc3RhcnQoKTtcbiAgICBjb25zdCBvdXRwdXQgPSBhd2FpdCBwZXJmb3JtQXBwSW5zdGFsbCgpO1xuICAgIGxvZy5pbmZvKGBUaGUgaW5zdGFsbGF0aW9uIG9mICcke3BhdGguYmFzZW5hbWUoYXBwUGF0aCl9JyB0b29rICR7dGltZXIuZ2V0RHVyYXRpb24oKS5hc01pbGxpU2Vjb25kcy50b0ZpeGVkKDApfW1zYCk7XG4gICAgY29uc3QgdHJ1bmNhdGVkT3V0cHV0ID0gKCFfLmlzU3RyaW5nKG91dHB1dCkgfHwgb3V0cHV0Lmxlbmd0aCA8PSAzMDApID9cbiAgICAgIG91dHB1dCA6IGAke291dHB1dC5zdWJzdHIoMCwgMTUwKX0uLi4ke291dHB1dC5zdWJzdHIob3V0cHV0Lmxlbmd0aCAtIDE1MCl9YDtcbiAgICBsb2cuZGVidWcoYEluc3RhbGwgY29tbWFuZCBzdGRvdXQ6ICR7dHJ1bmNhdGVkT3V0cHV0fWApO1xuICAgIGlmICgvXFxbSU5TVEFMTFtBLVpfXStGQUlMRURbQS1aX10rXFxdLy50ZXN0KG91dHB1dCkpIHtcbiAgICAgIGlmICh0aGlzLmlzVGVzdFBhY2thZ2VPbmx5RXJyb3Iob3V0cHV0KSkge1xuICAgICAgICBjb25zdCBtc2cgPSBgU2V0ICdhbGxvd1Rlc3RQYWNrYWdlcycgY2FwYWJpbGl0eSB0byB0cnVlIGluIG9yZGVyIHRvIGFsbG93IHRlc3QgcGFja2FnZXMgaW5zdGFsbGF0aW9uLmA7XG4gICAgICAgIGxvZy53YXJuKG1zZyk7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgJHtvdXRwdXR9XFxuJHttc2d9YCk7XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgRXJyb3Iob3V0cHV0KTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIC8vIG9uIHNvbWUgc3lzdGVtcyB0aGlzIHdpbGwgdGhyb3cgYW4gZXJyb3IgaWYgdGhlIGFwcCBhbHJlYWR5XG4gICAgLy8gZXhpc3RzXG4gICAgaWYgKCFlcnIubWVzc2FnZS5pbmNsdWRlcygnSU5TVEFMTF9GQUlMRURfQUxSRUFEWV9FWElTVFMnKSkge1xuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgICBsb2cuZGVidWcoYEFwcGxpY2F0aW9uICcke2FwcFBhdGh9JyBhbHJlYWR5IGluc3RhbGxlZC4gQ29udGludWluZy5gKTtcbiAgfVxufTtcblxuLyoqXG4gKiBSZXRyaWV2ZXMgdGhlIGN1cnJlbnQgaW5zdGFsbGF0aW9uIHN0YXRlIG9mIHRoZSBwYXJ0aWN1bGFyIGFwcGxpY2F0aW9uXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGFwcFBhdGggLSBGdWxsIHBhdGggdG8gdGhlIGFwcGxpY2F0aW9uXG4gKiBAcGFyYW0gez9zdHJpbmd9IHBrZyAtIFBhY2thZ2UgaWRlbnRpZmllci4gSWYgb21pdHRlZCB0aGVuIHRoZSBzY3JpcHQgd2lsbFxuICogICAgICAgICAgICAgICAgICAgICAgICB0cnkgdG8gZXh0cmFjdCBpdCBvbiBpdHMgb3duXG4gKiBAcmV0dXJucyB7c3RyaW5nfV1PbmUgb2YgYEFQUF9JTlNUQUxMX1NUQVRFYCBjb25zdGFudHNcbiAqL1xuYXBrVXRpbHNNZXRob2RzLmdldEFwcGxpY2F0aW9uSW5zdGFsbFN0YXRlID0gYXN5bmMgZnVuY3Rpb24gZ2V0QXBwbGljYXRpb25JbnN0YWxsU3RhdGUgKGFwcFBhdGgsIHBrZyA9IG51bGwpIHtcbiAgbGV0IGFwa0luZm8gPSBudWxsO1xuICBpZiAoIXBrZykge1xuICAgIGFwa0luZm8gPSBhd2FpdCB0aGlzLmdldEFwa0luZm8oYXBwUGF0aCk7XG4gICAgcGtnID0gYXBrSW5mby5uYW1lO1xuICB9XG4gIGlmICghcGtnKSB7XG4gICAgbG9nLndhcm4oYENhbm5vdCByZWFkIHRoZSBwYWNrYWdlIG5hbWUgb2YgJyR7YXBwUGF0aH0nYCk7XG4gICAgcmV0dXJuIHRoaXMuQVBQX0lOU1RBTExfU1RBVEUuVU5LTk9XTjtcbiAgfVxuXG4gIGlmICghYXdhaXQgdGhpcy5pc0FwcEluc3RhbGxlZChwa2cpKSB7XG4gICAgbG9nLmRlYnVnKGBBcHAgJyR7YXBwUGF0aH0nIGlzIG5vdCBpbnN0YWxsZWRgKTtcbiAgICByZXR1cm4gdGhpcy5BUFBfSU5TVEFMTF9TVEFURS5OT1RfSU5TVEFMTEVEO1xuICB9XG5cbiAgY29uc3Qge3ZlcnNpb25Db2RlOiBwa2dWZXJzaW9uQ29kZSwgdmVyc2lvbk5hbWU6IHBrZ1ZlcnNpb25OYW1lU3RyfSA9IGF3YWl0IHRoaXMuZ2V0UGFja2FnZUluZm8ocGtnKTtcbiAgY29uc3QgcGtnVmVyc2lvbk5hbWUgPSBzZW12ZXIudmFsaWQoc2VtdmVyLmNvZXJjZShwa2dWZXJzaW9uTmFtZVN0cikpO1xuICBpZiAoIWFwa0luZm8pIHtcbiAgICBhcGtJbmZvID0gYXdhaXQgdGhpcy5nZXRBcGtJbmZvKGFwcFBhdGgpO1xuICB9XG4gIGNvbnN0IHt2ZXJzaW9uQ29kZTogYXBrVmVyc2lvbkNvZGUsIHZlcnNpb25OYW1lOiBhcGtWZXJzaW9uTmFtZVN0cn0gPSBhcGtJbmZvO1xuICBjb25zdCBhcGtWZXJzaW9uTmFtZSA9IHNlbXZlci52YWxpZChzZW12ZXIuY29lcmNlKGFwa1ZlcnNpb25OYW1lU3RyKSk7XG5cbiAgaWYgKCFfLmlzSW50ZWdlcihhcGtWZXJzaW9uQ29kZSkgfHwgIV8uaXNJbnRlZ2VyKHBrZ1ZlcnNpb25Db2RlKSkge1xuICAgIGxvZy53YXJuKGBDYW5ub3QgcmVhZCB2ZXJzaW9uIGNvZGVzIG9mICcke2FwcFBhdGh9JyBhbmQvb3IgJyR7cGtnfSdgKTtcbiAgICBpZiAoIV8uaXNTdHJpbmcoYXBrVmVyc2lvbk5hbWUpIHx8ICFfLmlzU3RyaW5nKHBrZ1ZlcnNpb25OYW1lKSkge1xuICAgICAgbG9nLndhcm4oYENhbm5vdCByZWFkIHZlcnNpb24gbmFtZXMgb2YgJyR7YXBwUGF0aH0nIGFuZC9vciAnJHtwa2d9J2ApO1xuICAgICAgcmV0dXJuIHRoaXMuQVBQX0lOU1RBTExfU1RBVEUuVU5LTk9XTjtcbiAgICB9XG4gIH1cbiAgaWYgKF8uaXNJbnRlZ2VyKGFwa1ZlcnNpb25Db2RlKSAmJiBfLmlzSW50ZWdlcihwa2dWZXJzaW9uQ29kZSkpIHtcbiAgICBpZiAocGtnVmVyc2lvbkNvZGUgPiBhcGtWZXJzaW9uQ29kZSkge1xuICAgICAgbG9nLmRlYnVnKGBUaGUgdmVyc2lvbiBjb2RlIG9mIHRoZSBpbnN0YWxsZWQgJyR7cGtnfScgaXMgZ3JlYXRlciB0aGFuIHRoZSBhcHBsaWNhdGlvbiB2ZXJzaW9uIGNvZGUgKCR7cGtnVmVyc2lvbkNvZGV9ID4gJHthcGtWZXJzaW9uQ29kZX0pYCk7XG4gICAgICByZXR1cm4gdGhpcy5BUFBfSU5TVEFMTF9TVEFURS5ORVdFUl9WRVJTSU9OX0lOU1RBTExFRDtcbiAgICB9XG4gICAgLy8gVmVyc2lvbiBjb2RlcyBtaWdodCBub3QgYmUgbWFpbnRhaW5lZC4gQ2hlY2sgdmVyc2lvbiBuYW1lcy5cbiAgICBpZiAocGtnVmVyc2lvbkNvZGUgPT09IGFwa1ZlcnNpb25Db2RlKSB7XG4gICAgICBpZiAoXy5pc1N0cmluZyhhcGtWZXJzaW9uTmFtZSkgJiYgXy5pc1N0cmluZyhwa2dWZXJzaW9uTmFtZSkgJiYgc2VtdmVyLnNhdGlzZmllcyhwa2dWZXJzaW9uTmFtZSwgYD49JHthcGtWZXJzaW9uTmFtZX1gKSkge1xuICAgICAgICBsb2cuZGVidWcoYFRoZSB2ZXJzaW9uIG5hbWUgb2YgdGhlIGluc3RhbGxlZCAnJHtwa2d9JyBpcyBncmVhdGVyIG9yIGVxdWFsIHRvIHRoZSBhcHBsaWNhdGlvbiB2ZXJzaW9uIG5hbWUgKCcke3BrZ1ZlcnNpb25OYW1lfScgPj0gJyR7YXBrVmVyc2lvbk5hbWV9JylgKTtcbiAgICAgICAgcmV0dXJuIHNlbXZlci5zYXRpc2ZpZXMocGtnVmVyc2lvbk5hbWUsIGA+JHthcGtWZXJzaW9uTmFtZX1gKVxuICAgICAgICAgID8gdGhpcy5BUFBfSU5TVEFMTF9TVEFURS5ORVdFUl9WRVJTSU9OX0lOU1RBTExFRFxuICAgICAgICAgIDogdGhpcy5BUFBfSU5TVEFMTF9TVEFURS5TQU1FX1ZFUlNJT05fSU5TVEFMTEVEO1xuICAgICAgfVxuICAgICAgaWYgKCFfLmlzU3RyaW5nKGFwa1ZlcnNpb25OYW1lKSB8fCAhXy5pc1N0cmluZyhwa2dWZXJzaW9uTmFtZSkpIHtcbiAgICAgICAgbG9nLmRlYnVnKGBUaGUgdmVyc2lvbiBuYW1lIG9mIHRoZSBpbnN0YWxsZWQgJyR7cGtnfScgaXMgZXF1YWwgdG8gYXBwbGljYXRpb24gdmVyc2lvbiBuYW1lICgke3BrZ1ZlcnNpb25Db2RlfSA9PT0gJHthcGtWZXJzaW9uQ29kZX0pYCk7XG4gICAgICAgIHJldHVybiB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLlNBTUVfVkVSU0lPTl9JTlNUQUxMRUQ7XG4gICAgICB9XG4gICAgfVxuICB9IGVsc2UgaWYgKF8uaXNTdHJpbmcoYXBrVmVyc2lvbk5hbWUpICYmIF8uaXNTdHJpbmcocGtnVmVyc2lvbk5hbWUpICYmIHNlbXZlci5zYXRpc2ZpZXMocGtnVmVyc2lvbk5hbWUsIGA+PSR7YXBrVmVyc2lvbk5hbWV9YCkpIHtcbiAgICBsb2cuZGVidWcoYFRoZSB2ZXJzaW9uIG5hbWUgb2YgdGhlIGluc3RhbGxlZCAnJHtwa2d9JyBpcyBncmVhdGVyIG9yIGVxdWFsIHRvIHRoZSBhcHBsaWNhdGlvbiB2ZXJzaW9uIG5hbWUgKCcke3BrZ1ZlcnNpb25OYW1lfScgPj0gJyR7YXBrVmVyc2lvbk5hbWV9JylgKTtcbiAgICByZXR1cm4gc2VtdmVyLnNhdGlzZmllcyhwa2dWZXJzaW9uTmFtZSwgYD4ke2Fwa1ZlcnNpb25OYW1lfWApXG4gICAgICA/IHRoaXMuQVBQX0lOU1RBTExfU1RBVEUuTkVXRVJfVkVSU0lPTl9JTlNUQUxMRURcbiAgICAgIDogdGhpcy5BUFBfSU5TVEFMTF9TVEFURS5TQU1FX1ZFUlNJT05fSU5TVEFMTEVEO1xuICB9XG5cbiAgbG9nLmRlYnVnKGBUaGUgaW5zdGFsbGVkICcke3BrZ30nIHBhY2thZ2UgaXMgb2xkZXIgdGhhbiAnJHthcHBQYXRofScgKCR7cGtnVmVyc2lvbkNvZGV9IDwgJHthcGtWZXJzaW9uQ29kZX0gb3IgJyR7cGtnVmVyc2lvbk5hbWV9JyA8ICcke2Fwa1ZlcnNpb25OYW1lfScpJ2ApO1xuICByZXR1cm4gdGhpcy5BUFBfSU5TVEFMTF9TVEFURS5PTERFUl9WRVJTSU9OX0lOU1RBTExFRDtcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gSW5zdGFsbE9yVXBncmFkZU9wdGlvbnNcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSB0aW1lb3V0IFs2MDAwMF0gLSBUaGUgY291bnQgb2YgbWlsbGlzZWNvbmRzIHRvIHdhaXQgdW50aWwgdGhlXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwIGlzIGluc3RhbGxlZC5cbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gYWxsb3dUZXN0UGFja2FnZXMgW2ZhbHNlXSAtIFNldCB0byB0cnVlIGluIG9yZGVyIHRvIGFsbG93IHRlc3RcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhY2thZ2VzIGluc3RhbGxhdGlvbi5cbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gdXNlU2RjYXJkIFtmYWxzZV0gLSBTZXQgdG8gdHJ1ZSB0byBpbnN0YWxsIHRoZSBhcHAgb24gU0RDYXJkXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGVhZCBvZiB0aGUgZGV2aWNlIG1lbW9yeS5cbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gZ3JhbnRQZXJtaXNzaW9ucyBbZmFsc2VdIC0gU2V0IHRvIHRydWUgaW4gb3JkZXIgdG8gZ3JhbnQgYWxsIHRoZVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJtaXNzaW9ucyByZXF1ZXN0ZWQgaW4gdGhlIGFwcGxpY2F0aW9uJ3MgbWFuaWZlc3RcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0b21hdGljYWxseSBhZnRlciB0aGUgaW5zdGFsbGF0aW9uIGlzIGNvbXBsZXRlZFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmRlciBBbmRyb2lkIDYrLlxuICogQHByb3BlcnR5IHtib29sZWFufSBlbmZvcmNlQ3VycmVudEJ1aWxkIFtmYWxzZV0gLSBTZXQgdG8gYHRydWVgIGluIG9yZGVyIHRvIGFsd2F5cyBwcmVmZXJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlIGN1cnJlbnQgYnVpbGQgb3ZlciBhbnkgaW5zdGFsbGVkIHBhY2thZ2VzIGhhdmluZ1xuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGUgc2FtZSBpZGVudGlmaWVyXG4gKi9cblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBJbnN0YWxsT3JVcGdyYWRlUmVzdWx0XG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IHdhc1VuaW5zdGFsbGVkIC0gRXF1YWxzIHRvIGB0cnVlYCBpZiB0aGUgdGFyZ2V0IGFwcCBoYXMgYmVlbiB1bmluc3RhbGxlZFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlZm9yZSBiZWluZyBpbnN0YWxsZWRcbiAqIEBwcm9wZXJ0eSB7QVBQX0lOU1RBTExfU1RBVEV9IGFwcFN0YXRlIC0gT25lIG9mIGBhZGIuQVBQX0lOU1RBTExfU1RBVEVgIHN0YXRlcywgd2hpY2ggcmVmbGVjdHNcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlIHN0YXRlIG9mIHRoZSBhcHBsaWNhdGlvbiBiZWZvcmUgYmVpbmcgaW5zdGFsbGVkLlxuICovXG5cbi8qKlxuICogSW5zdGFsbCB0aGUgcGFja2FnZSBmcm9tIHRoZSBsb2NhbCBmaWxlIHN5c3RlbSBvciB1cGdyYWRlIGl0IGlmIGFuIG9sZGVyXG4gKiB2ZXJzaW9uIG9mIHRoZSBzYW1lIHBhY2thZ2UgaXMgYWxyZWFkeSBpbnN0YWxsZWQuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGFwcFBhdGggLSBUaGUgZnVsbCBwYXRoIHRvIHRoZSBsb2NhbCBwYWNrYWdlLlxuICogQHBhcmFtIHs/c3RyaW5nfSBwa2cgLSBUaGUgbmFtZSBvZiB0aGUgaW5zdGFsbGVkIHBhY2thZ2UuIFRoZSBtZXRob2Qgd2lsbFxuICogICAgICAgICAgICAgICAgICAgICAgICBwZXJmb3JtIGZhc3RlciBpZiBpdCBpcyBzZXQuXG4gKiBAcGFyYW0gez9JbnN0YWxsT3JVcGdyYWRlT3B0aW9uc30gb3B0aW9ucyAtIFNldCBvZiBpbnN0YWxsIG9wdGlvbnMuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgYW4gdW5leHBlY3RlZCBlcnJvciBoYXBwZW5zIGR1cmluZyBpbnN0YWxsLlxuICogQHJldHVybnMge0luc3RhbGxPclVwZ3JhZGVSZXN1bHR9XG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5pbnN0YWxsT3JVcGdyYWRlID0gYXN5bmMgZnVuY3Rpb24gaW5zdGFsbE9yVXBncmFkZSAoYXBwUGF0aCwgcGtnID0gbnVsbCwgb3B0aW9ucyA9IHt9KSB7XG4gIGlmICghcGtnKSB7XG4gICAgY29uc3QgYXBrSW5mbyA9IGF3YWl0IHRoaXMuZ2V0QXBrSW5mbyhhcHBQYXRoKTtcbiAgICBwa2cgPSBhcGtJbmZvLm5hbWU7XG4gIH1cblxuICBjb25zdCB7XG4gICAgZW5mb3JjZUN1cnJlbnRCdWlsZCxcbiAgfSA9IG9wdGlvbnM7XG4gIGNvbnN0IGFwcFN0YXRlID0gYXdhaXQgdGhpcy5nZXRBcHBsaWNhdGlvbkluc3RhbGxTdGF0ZShhcHBQYXRoLCBwa2cpO1xuICBsZXQgd2FzVW5pbnN0YWxsZWQgPSBmYWxzZTtcbiAgY29uc3QgdW5pbnN0YWxsUGFja2FnZSA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoIWF3YWl0IHRoaXMudW5pbnN0YWxsQXBrKHBrZykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgJyR7cGtnfScgcGFja2FnZSBjYW5ub3QgYmUgdW5pbnN0YWxsZWRgKTtcbiAgICB9XG4gICAgd2FzVW5pbnN0YWxsZWQgPSB0cnVlO1xuICB9O1xuICBzd2l0Y2ggKGFwcFN0YXRlKSB7XG4gICAgY2FzZSB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLk5PVF9JTlNUQUxMRUQ6XG4gICAgICBsb2cuZGVidWcoYEluc3RhbGxpbmcgJyR7YXBwUGF0aH0nYCk7XG4gICAgICBhd2FpdCB0aGlzLmluc3RhbGwoYXBwUGF0aCwgT2JqZWN0LmFzc2lnbih7fSwgb3B0aW9ucywge3JlcGxhY2U6IGZhbHNlfSkpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYXBwU3RhdGUsXG4gICAgICAgIHdhc1VuaW5zdGFsbGVkLFxuICAgICAgfTtcbiAgICBjYXNlIHRoaXMuQVBQX0lOU1RBTExfU1RBVEUuTkVXRVJfVkVSU0lPTl9JTlNUQUxMRUQ6XG4gICAgICBpZiAoZW5mb3JjZUN1cnJlbnRCdWlsZCkge1xuICAgICAgICBsb2cuaW5mbyhgRG93bmdyYWRpbmcgJyR7cGtnfScgYXMgcmVxdWVzdGVkYCk7XG4gICAgICAgIGF3YWl0IHVuaW5zdGFsbFBhY2thZ2UoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBsb2cuZGVidWcoYFRoZXJlIGlzIG5vIG5lZWQgdG8gZG93bmdyYWRlICcke3BrZ30nYCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBhcHBTdGF0ZSxcbiAgICAgICAgd2FzVW5pbnN0YWxsZWQsXG4gICAgICB9O1xuICAgIGNhc2UgdGhpcy5BUFBfSU5TVEFMTF9TVEFURS5TQU1FX1ZFUlNJT05fSU5TVEFMTEVEOlxuICAgICAgaWYgKGVuZm9yY2VDdXJyZW50QnVpbGQpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBsb2cuZGVidWcoYFRoZXJlIGlzIG5vIG5lZWQgdG8gaW5zdGFsbC91cGdyYWRlICcke2FwcFBhdGh9J2ApO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYXBwU3RhdGUsXG4gICAgICAgIHdhc1VuaW5zdGFsbGVkLFxuICAgICAgfTtcbiAgICBjYXNlIHRoaXMuQVBQX0lOU1RBTExfU1RBVEUuT0xERVJfVkVSU0lPTl9JTlNUQUxMRUQ6XG4gICAgICBsb2cuZGVidWcoYEV4ZWN1dGluZyB1cGdyYWRlIG9mICcke2FwcFBhdGh9J2ApO1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIGxvZy5kZWJ1ZyhgVGhlIGN1cnJlbnQgaW5zdGFsbCBzdGF0ZSBvZiAnJHthcHBQYXRofScgaXMgdW5rbm93bi4gSW5zdGFsbGluZyBhbnl3YXlgKTtcbiAgICAgIGJyZWFrO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBhd2FpdCB0aGlzLmluc3RhbGwoYXBwUGF0aCwgT2JqZWN0LmFzc2lnbih7fSwgb3B0aW9ucywge3JlcGxhY2U6IHRydWV9KSk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGxvZy53YXJuKGBDYW5ub3QgaW5zdGFsbC91cGdyYWRlICcke3BrZ30nIGJlY2F1c2Ugb2YgJyR7ZXJyLm1lc3NhZ2V9Jy4gVHJ5aW5nIGZ1bGwgcmVpbnN0YWxsYCk7XG4gICAgYXdhaXQgdW5pbnN0YWxsUGFja2FnZSgpO1xuICAgIGF3YWl0IHRoaXMuaW5zdGFsbChhcHBQYXRoLCBPYmplY3QuYXNzaWduKHt9LCBvcHRpb25zLCB7cmVwbGFjZTogZmFsc2V9KSk7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBhcHBTdGF0ZSxcbiAgICB3YXNVbmluc3RhbGxlZCxcbiAgfTtcbn07XG5cbi8qKlxuICogRXh0cmFjdCBzdHJpbmcgcmVzb3VyY2VzIGZyb20gdGhlIGdpdmVuIHBhY2thZ2Ugb24gbG9jYWwgZmlsZSBzeXN0ZW0uXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGFwcFBhdGggLSBUaGUgZnVsbCBwYXRoIHRvIHRoZSAuYXBrKHMpIHBhY2thZ2UuXG4gKiBAcGFyYW0gez9zdHJpbmd9IGxhbmd1YWdlIC0gVGhlIG5hbWUgb2YgdGhlIGxhbmd1YWdlIHRvIGV4dHJhY3QgdGhlIHJlc291cmNlcyBmb3IuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGhlIGRlZmF1bHQgbGFuZ3VhZ2UgaXMgdXNlZCBpZiB0aGlzIGVxdWFscyB0byBgbnVsbGAvYHVuZGVmaW5lZGBcbiAqIEBwYXJhbSB7c3RyaW5nfSBvdXQgLSBUaGUgbmFtZSBvZiB0aGUgZGVzdGluYXRpb24gZm9sZGVyIG9uIHRoZSBsb2NhbCBmaWxlIHN5c3RlbSB0b1xuICogICAgICAgICAgICAgICAgICAgICAgIHN0b3JlIHRoZSBleHRyYWN0ZWQgZmlsZSB0by5cbiAqIEByZXR1cm4ge09iamVjdH0gQSBtYXBwaW5nIG9iamVjdCwgd2hlcmUgcHJvcGVydGllcyBhcmU6ICdhcGtTdHJpbmdzJywgY29udGFpbmluZ1xuICogICAgICAgICAgICAgICAgICBwYXJzZWQgcmVzb3VyY2UgZmlsZSByZXByZXNlbnRlZCBhcyBKU09OIG9iamVjdCwgYW5kICdsb2NhbFBhdGgnLFxuICogICAgICAgICAgICAgICAgICBjb250YWluaW5nIHRoZSBwYXRoIHRvIHRoZSBleHRyYWN0ZWQgZmlsZSBvbiB0aGUgbG9jYWwgZmlsZSBzeXN0ZW0uXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5leHRyYWN0U3RyaW5nc0Zyb21BcGsgPSBhc3luYyBmdW5jdGlvbiBleHRyYWN0U3RyaW5nc0Zyb21BcGsgKGFwcFBhdGgsIGxhbmd1YWdlLCBvdXQpIHtcbiAgbG9nLmRlYnVnKGBFeHRyYWN0aW5nIHN0cmluZ3MgZnJvbSBmb3IgbGFuZ3VhZ2U6ICR7bGFuZ3VhZ2UgfHwgJ2RlZmF1bHQnfWApO1xuICBjb25zdCBvcmlnaW5hbEFwcFBhdGggPSBhcHBQYXRoO1xuICBpZiAoYXBwUGF0aC5lbmRzV2l0aChBUEtTX0VYVEVOU0lPTikpIHtcbiAgICBhcHBQYXRoID0gYXdhaXQgdGhpcy5leHRyYWN0TGFuZ3VhZ2VBcGsoYXBwUGF0aCwgbGFuZ3VhZ2UpO1xuICB9XG5cbiAgbGV0IGFwa1N0cmluZ3MgPSB7fTtcbiAgbGV0IGNvbmZpZ01hcmtlcjtcbiAgdHJ5IHtcbiAgICBhd2FpdCB0aGlzLmluaXRBYXB0KCk7XG5cbiAgICBjb25maWdNYXJrZXIgPSBhd2FpdCBmb3JtYXRDb25maWdNYXJrZXIoYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qge3N0ZG91dH0gPSBhd2FpdCBleGVjKHRoaXMuYmluYXJpZXMuYWFwdCwgW1xuICAgICAgICAnZCcsICdjb25maWd1cmF0aW9ucycsIGFwcFBhdGgsXG4gICAgICBdKTtcbiAgICAgIHJldHVybiBfLnVuaXEoc3Rkb3V0LnNwbGl0KG9zLkVPTCkpO1xuICAgIH0sIGxhbmd1YWdlLCAnKGRlZmF1bHQpJyk7XG5cbiAgICBjb25zdCB7c3Rkb3V0fSA9IGF3YWl0IGV4ZWModGhpcy5iaW5hcmllcy5hYXB0LCBbXG4gICAgICAnZCcsICctLXZhbHVlcycsICdyZXNvdXJjZXMnLCBhcHBQYXRoLFxuICAgIF0pO1xuICAgIGFwa1N0cmluZ3MgPSBwYXJzZUFhcHRTdHJpbmdzKHN0ZG91dCwgY29uZmlnTWFya2VyKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGxvZy5kZWJ1ZygnQ2Fubm90IGV4dHJhY3QgcmVzb3VyY2VzIHVzaW5nIGFhcHQuIFRyeWluZyBhYXB0Mi4gJyArXG4gICAgICBgT3JpZ2luYWwgZXJyb3I6ICR7ZS5zdGRlcnIgfHwgZS5tZXNzYWdlfWApO1xuXG4gICAgYXdhaXQgdGhpcy5pbml0QWFwdDIoKTtcblxuICAgIGNvbmZpZ01hcmtlciA9IGF3YWl0IGZvcm1hdENvbmZpZ01hcmtlcihhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB7c3Rkb3V0fSA9IGF3YWl0IGV4ZWModGhpcy5iaW5hcmllcy5hYXB0MiwgW1xuICAgICAgICAnZCcsICdjb25maWd1cmF0aW9ucycsIGFwcFBhdGgsXG4gICAgICBdKTtcbiAgICAgIHJldHVybiBfLnVuaXEoc3Rkb3V0LnNwbGl0KG9zLkVPTCkpO1xuICAgIH0sIGxhbmd1YWdlLCAnJyk7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3Qge3N0ZG91dH0gPSBhd2FpdCBleGVjKHRoaXMuYmluYXJpZXMuYWFwdDIsIFtcbiAgICAgICAgJ2QnLCAncmVzb3VyY2VzJywgYXBwUGF0aCxcbiAgICAgIF0pO1xuICAgICAgYXBrU3RyaW5ncyA9IHBhcnNlQWFwdDJTdHJpbmdzKHN0ZG91dCwgY29uZmlnTWFya2VyKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCBleHRyYWN0IHJlc291cmNlcyBmcm9tICcke29yaWdpbmFsQXBwUGF0aH0nLiBgICtcbiAgICAgICAgYE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cblxuICBpZiAoXy5pc0VtcHR5KGFwa1N0cmluZ3MpKSB7XG4gICAgbG9nLndhcm4oYE5vIHN0cmluZ3MgaGF2ZSBiZWVuIGZvdW5kIGluICcke29yaWdpbmFsQXBwUGF0aH0nIHJlc291cmNlcyBgICtcbiAgICAgIGBmb3IgJyR7Y29uZmlnTWFya2VyIHx8ICdkZWZhdWx0J30nIGNvbmZpZ3VyYXRpb25gKTtcbiAgfSBlbHNlIHtcbiAgICBsb2cuaW5mbyhgU3VjY2Vzc2Z1bGx5IGV4dHJhY3RlZCAke18ua2V5cyhhcGtTdHJpbmdzKS5sZW5ndGh9IHN0cmluZ3MgZnJvbSBgICtcbiAgICAgIGAnJHtvcmlnaW5hbEFwcFBhdGh9JyByZXNvdXJjZXMgZm9yICcke2NvbmZpZ01hcmtlciB8fCAnZGVmYXVsdCd9JyBjb25maWd1cmF0aW9uYCk7XG4gIH1cblxuICBjb25zdCBsb2NhbFBhdGggPSBwYXRoLnJlc29sdmUob3V0LCAnc3RyaW5ncy5qc29uJyk7XG4gIGF3YWl0IG1rZGlycChvdXQpO1xuICBhd2FpdCBmcy53cml0ZUZpbGUobG9jYWxQYXRoLCBKU09OLnN0cmluZ2lmeShhcGtTdHJpbmdzLCBudWxsLCAyKSwgJ3V0Zi04Jyk7XG4gIHJldHVybiB7YXBrU3RyaW5ncywgbG9jYWxQYXRofTtcbn07XG5cbi8qKlxuICogR2V0IHRoZSBsYW5ndWFnZSBuYW1lIG9mIHRoZSBkZXZpY2UgdW5kZXIgdGVzdC5cbiAqXG4gKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBuYW1lIG9mIGRldmljZSBsYW5ndWFnZS5cbiAqL1xuYXBrVXRpbHNNZXRob2RzLmdldERldmljZUxhbmd1YWdlID0gYXN5bmMgZnVuY3Rpb24gZ2V0RGV2aWNlTGFuZ3VhZ2UgKCkge1xuICBsZXQgbGFuZ3VhZ2U7XG4gIGlmIChhd2FpdCB0aGlzLmdldEFwaUxldmVsKCkgPCAyMykge1xuICAgIGxhbmd1YWdlID0gYXdhaXQgdGhpcy5nZXREZXZpY2VTeXNMYW5ndWFnZSgpO1xuICAgIGlmICghbGFuZ3VhZ2UpIHtcbiAgICAgIGxhbmd1YWdlID0gYXdhaXQgdGhpcy5nZXREZXZpY2VQcm9kdWN0TGFuZ3VhZ2UoKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgbGFuZ3VhZ2UgPSAoYXdhaXQgdGhpcy5nZXREZXZpY2VMb2NhbGUoKSkuc3BsaXQoJy0nKVswXTtcbiAgfVxuICByZXR1cm4gbGFuZ3VhZ2U7XG59O1xuXG4vKipcbiAqIEdldCB0aGUgY291bnRyeSBuYW1lIG9mIHRoZSBkZXZpY2UgdW5kZXIgdGVzdC5cbiAqXG4gKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBuYW1lIG9mIGRldmljZSBjb3VudHJ5LlxuICovXG5hcGtVdGlsc01ldGhvZHMuZ2V0RGV2aWNlQ291bnRyeSA9IGFzeW5jIGZ1bmN0aW9uIGdldERldmljZUNvdW50cnkgKCkge1xuICAvLyB0aGlzIG1ldGhvZCBpcyBvbmx5IHVzZWQgaW4gQVBJIDwgMjNcbiAgbGV0IGNvdW50cnkgPSBhd2FpdCB0aGlzLmdldERldmljZVN5c0NvdW50cnkoKTtcbiAgaWYgKCFjb3VudHJ5KSB7XG4gICAgY291bnRyeSA9IGF3YWl0IHRoaXMuZ2V0RGV2aWNlUHJvZHVjdENvdW50cnkoKTtcbiAgfVxuICByZXR1cm4gY291bnRyeTtcbn07XG5cbi8qKlxuICogR2V0IHRoZSBsb2NhbGUgbmFtZSBvZiB0aGUgZGV2aWNlIHVuZGVyIHRlc3QuXG4gKlxuICogQHJldHVybiB7c3RyaW5nfSBUaGUgbmFtZSBvZiBkZXZpY2UgbG9jYWxlLlxuICovXG5hcGtVdGlsc01ldGhvZHMuZ2V0RGV2aWNlTG9jYWxlID0gYXN5bmMgZnVuY3Rpb24gZ2V0RGV2aWNlTG9jYWxlICgpIHtcbiAgLy8gdGhpcyBtZXRob2QgaXMgb25seSB1c2VkIGluIEFQSSA+PSAyM1xuICBsZXQgbG9jYWxlID0gYXdhaXQgdGhpcy5nZXREZXZpY2VTeXNMb2NhbGUoKTtcbiAgaWYgKCFsb2NhbGUpIHtcbiAgICBsb2NhbGUgPSBhd2FpdCB0aGlzLmdldERldmljZVByb2R1Y3RMb2NhbGUoKTtcbiAgfVxuICByZXR1cm4gbG9jYWxlO1xufTtcblxuLyoqXG4gKiBTZXQgdGhlIGxvY2FsZSBuYW1lIG9mIHRoZSBkZXZpY2UgdW5kZXIgdGVzdCBhbmQgdGhlIGZvcm1hdCBvZiB0aGUgbG9jYWxlIGlzIGVuLVVTLCBmb3IgZXhhbXBsZS5cbiAqIFRoaXMgbWV0aG9kIGNhbGwgc2V0RGV2aWNlTGFuZ3VhZ2VDb3VudHJ5LCBzbywgcGxlYXNlIHVzZSBzZXREZXZpY2VMYW5ndWFnZUNvdW50cnkgYXMgcG9zc2libGUuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGxvY2FsZSAtIE5hbWVzIG9mIHRoZSBkZXZpY2UgbGFuZ3VhZ2UgYW5kIHRoZSBjb3VudHJ5IGNvbm5lY3RlZCB3aXRoIGAtYC4gZS5nLiBlbi1VUy5cbiAqL1xuYXBrVXRpbHNNZXRob2RzLnNldERldmljZUxvY2FsZSA9IGFzeW5jIGZ1bmN0aW9uIHNldERldmljZUxvY2FsZSAobG9jYWxlKSB7XG4gIGNvbnN0IHZhbGlkYXRlTG9jYWxlID0gbmV3IFJlZ0V4cCgvW2EtekEtWl0rLVthLXpBLVowLTldKy8pO1xuICBpZiAoIXZhbGlkYXRlTG9jYWxlLnRlc3QobG9jYWxlKSkge1xuICAgIGxvZy53YXJuKGBzZXREZXZpY2VMb2NhbGUgcmVxdWlyZXMgdGhlIGZvbGxvd2luZyBmb3JtYXQ6IGVuLVVTIG9yIGphLUpQYCk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbGV0IHNwbGl0X2xvY2FsZSA9IGxvY2FsZS5zcGxpdCgnLScpO1xuICBhd2FpdCB0aGlzLnNldERldmljZUxhbmd1YWdlQ291bnRyeShzcGxpdF9sb2NhbGVbMF0sIHNwbGl0X2xvY2FsZVsxXSk7XG59O1xuXG4vKipcbiAqIE1ha2Ugc3VyZSBjdXJyZW50IGRldmljZSBsb2NhbGUgaXMgZXhwZWN0ZWQgb3Igbm90LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBsYW5ndWFnZSAtIExhbmd1YWdlLiBUaGUgbGFuZ3VhZ2UgZmllbGQgaXMgY2FzZSBpbnNlbnNpdGl2ZSwgYnV0IExvY2FsZSBhbHdheXMgY2Fub25pY2FsaXplcyB0byBsb3dlciBjYXNlLlxuICogQHBhcmFtIHtzdHJpbmd9IGNvdW50cnkgLSBDb3VudHJ5LiBUaGUgbGFuZ3VhZ2UgZmllbGQgaXMgY2FzZSBpbnNlbnNpdGl2ZSwgYnV0IExvY2FsZSBhbHdheXMgY2Fub25pY2FsaXplcyB0byBsb3dlciBjYXNlLlxuICogQHBhcmFtIHs/c3RyaW5nfSBzY3JpcHQgLSBTY3JpcHQuIFRoZSBzY3JpcHQgZmllbGQgaXMgY2FzZSBpbnNlbnNpdGl2ZSBidXQgTG9jYWxlIGFsd2F5cyBjYW5vbmljYWxpemVzIHRvIHRpdGxlIGNhc2UuXG4gKlxuICogQHJldHVybiB7Ym9vbGVhbn0gSWYgY3VycmVudCBsb2NhbGUgaXMgbGFuZ3VhZ2UgYW5kIGNvdW50cnkgYXMgYXJndW1lbnRzLCByZXR1cm4gdHJ1ZS5cbiAqL1xuYXBrVXRpbHNNZXRob2RzLmVuc3VyZUN1cnJlbnRMb2NhbGUgPSBhc3luYyBmdW5jdGlvbiBlbnN1cmVDdXJyZW50TG9jYWxlIChsYW5ndWFnZSwgY291bnRyeSwgc2NyaXB0ID0gbnVsbCkge1xuICBjb25zdCBoYXNMYW5ndWFnZSA9IF8uaXNTdHJpbmcobGFuZ3VhZ2UpO1xuICBjb25zdCBoYXNDb3VudHJ5ID0gXy5pc1N0cmluZyhjb3VudHJ5KTtcblxuICBpZiAoIWhhc0xhbmd1YWdlICYmICFoYXNDb3VudHJ5KSB7XG4gICAgbG9nLndhcm4oJ2Vuc3VyZUN1cnJlbnRMb2NhbGUgcmVxdWlyZXMgbGFuZ3VhZ2Ugb3IgY291bnRyeScpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8vIGdldCBsb3dlciBjYXNlIHZlcnNpb25zIG9mIHRoZSBzdHJpbmdzXG4gIGxhbmd1YWdlID0gKGxhbmd1YWdlIHx8ICcnKS50b0xvd2VyQ2FzZSgpO1xuICBjb3VudHJ5ID0gKGNvdW50cnkgfHwgJycpLnRvTG93ZXJDYXNlKCk7XG5cbiAgY29uc3QgYXBpTGV2ZWwgPSBhd2FpdCB0aGlzLmdldEFwaUxldmVsKCk7XG5cbiAgcmV0dXJuIGF3YWl0IHJldHJ5SW50ZXJ2YWwoNSwgMTAwMCwgYXN5bmMgKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAoYXBpTGV2ZWwgPCAyMykge1xuICAgICAgICBsZXQgY3VyTGFuZ3VhZ2UsIGN1ckNvdW50cnk7XG4gICAgICAgIGlmIChoYXNMYW5ndWFnZSkge1xuICAgICAgICAgIGN1ckxhbmd1YWdlID0gKGF3YWl0IHRoaXMuZ2V0RGV2aWNlTGFuZ3VhZ2UoKSkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICBpZiAoIWhhc0NvdW50cnkgJiYgbGFuZ3VhZ2UgPT09IGN1ckxhbmd1YWdlKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhhc0NvdW50cnkpIHtcbiAgICAgICAgICBjdXJDb3VudHJ5ID0gKGF3YWl0IHRoaXMuZ2V0RGV2aWNlQ291bnRyeSgpKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgIGlmICghaGFzTGFuZ3VhZ2UgJiYgY291bnRyeSA9PT0gY3VyQ291bnRyeSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChsYW5ndWFnZSA9PT0gY3VyTGFuZ3VhZ2UgJiYgY291bnRyeSA9PT0gY3VyQ291bnRyeSkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBjdXJMb2NhbGUgPSAoYXdhaXQgdGhpcy5nZXREZXZpY2VMb2NhbGUoKSkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgLy8gemgtaGFucy1jbiA6IHpoLWNuXG4gICAgICAgIGNvbnN0IGxvY2FsZUNvZGUgPSBzY3JpcHQgPyBgJHtsYW5ndWFnZX0tJHtzY3JpcHQudG9Mb3dlckNhc2UoKX0tJHtjb3VudHJ5fWAgOiBgJHtsYW5ndWFnZX0tJHtjb3VudHJ5fWA7XG5cbiAgICAgICAgaWYgKGxvY2FsZUNvZGUgPT09IGN1ckxvY2FsZSkge1xuICAgICAgICAgIGxvZy5kZWJ1ZyhgUmVxdWVzdGVkIGxvY2FsZSBpcyBlcXVhbCB0byBjdXJyZW50IGxvY2FsZTogJyR7Y3VyTG9jYWxlfSdgKTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgLy8gaWYgdGhlcmUgaGFzIGJlZW4gYW4gZXJyb3IsIHJlc3RhcnQgYWRiIGFuZCByZXRyeVxuICAgICAgbG9nLmVycm9yKGBVbmFibGUgdG8gY2hlY2sgZGV2aWNlIGxvY2FsaXphdGlvbjogJHtlcnIubWVzc2FnZX1gKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHRoaXMucmVjb25uZWN0KCk7XG4gICAgICB9IGNhdGNoIChpZ24pIHtcbiAgICAgICAgYXdhaXQgdGhpcy5yZXN0YXJ0QWRiKCk7XG4gICAgICB9XG4gICAgICB0aHJvdyBlcnI7XG4gICAgfVxuICB9KTtcbn07XG5cbi8qKlxuICogU2V0IHRoZSBsb2NhbGUgbmFtZSBvZiB0aGUgZGV2aWNlIHVuZGVyIHRlc3QuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGxhbmd1YWdlIC0gTGFuZ3VhZ2UuIFRoZSBsYW5ndWFnZSBmaWVsZCBpcyBjYXNlIGluc2Vuc2l0aXZlLCBidXQgTG9jYWxlIGFsd2F5cyBjYW5vbmljYWxpemVzIHRvIGxvd2VyIGNhc2UuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFthLXpBLVpdezIsOH0uIGUuZy4gZW4sIGphIDogaHR0cHM6Ly9kZXZlbG9wZXIuYW5kcm9pZC5jb20vcmVmZXJlbmNlL2phdmEvdXRpbC9Mb2NhbGUuaHRtbFxuICogQHBhcmFtIHtzdHJpbmd9IGNvdW50cnkgLSBDb3VudHJ5LiBUaGUgY291bnRyeSAocmVnaW9uKSBmaWVsZCBpcyBjYXNlIGluc2Vuc2l0aXZlLCBidXQgTG9jYWxlIGFsd2F5cyBjYW5vbmljYWxpemVzIHRvIHVwcGVyIGNhc2UuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFthLXpBLVpdezJ9IHwgWzAtOV17M30uIGUuZy4gVVMsIEpQIDogaHR0cHM6Ly9kZXZlbG9wZXIuYW5kcm9pZC5jb20vcmVmZXJlbmNlL2phdmEvdXRpbC9Mb2NhbGUuaHRtbFxuICogQHBhcmFtIHs/c3RyaW5nfSBzY3JpcHQgLSBTY3JpcHQuIFRoZSBzY3JpcHQgZmllbGQgaXMgY2FzZSBpbnNlbnNpdGl2ZSBidXQgTG9jYWxlIGFsd2F5cyBjYW5vbmljYWxpemVzIHRvIHRpdGxlIGNhc2UuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFthLXpBLVpdezR9LiBlLmcuIEhhbnMgaW4gemgtSGFucy1DTiA6IGh0dHBzOi8vZGV2ZWxvcGVyLmFuZHJvaWQuY29tL3JlZmVyZW5jZS9qYXZhL3V0aWwvTG9jYWxlLmh0bWxcbiAqL1xuYXBrVXRpbHNNZXRob2RzLnNldERldmljZUxhbmd1YWdlQ291bnRyeSA9IGFzeW5jIGZ1bmN0aW9uIHNldERldmljZUxhbmd1YWdlQ291bnRyeSAobGFuZ3VhZ2UsIGNvdW50cnksIHNjcmlwdCA9IG51bGwpIHtcbiAgbGV0IGhhc0xhbmd1YWdlID0gbGFuZ3VhZ2UgJiYgXy5pc1N0cmluZyhsYW5ndWFnZSk7XG4gIGxldCBoYXNDb3VudHJ5ID0gY291bnRyeSAmJiBfLmlzU3RyaW5nKGNvdW50cnkpO1xuICBpZiAoIWhhc0xhbmd1YWdlIHx8ICFoYXNDb3VudHJ5KSB7XG4gICAgbG9nLndhcm4oYHNldERldmljZUxhbmd1YWdlQ291bnRyeSByZXF1aXJlcyBsYW5ndWFnZSBhbmQgY291bnRyeSBhdCBsZWFzdGApO1xuICAgIGxvZy53YXJuKGBHb3QgbGFuZ3VhZ2U6ICcke2xhbmd1YWdlfScgYW5kIGNvdW50cnk6ICcke2NvdW50cnl9J2ApO1xuICAgIHJldHVybjtcbiAgfVxuICBsZXQgYXBpTGV2ZWwgPSBhd2FpdCB0aGlzLmdldEFwaUxldmVsKCk7XG5cbiAgbGFuZ3VhZ2UgPSAobGFuZ3VhZ2UgfHwgJycpLnRvTG93ZXJDYXNlKCk7XG4gIGNvdW50cnkgPSAoY291bnRyeSB8fCAnJykudG9VcHBlckNhc2UoKTtcblxuICBpZiAoYXBpTGV2ZWwgPCAyMykge1xuICAgIGxldCBjdXJMYW5ndWFnZSA9IChhd2FpdCB0aGlzLmdldERldmljZUxhbmd1YWdlKCkpLnRvTG93ZXJDYXNlKCk7XG4gICAgbGV0IGN1ckNvdW50cnkgPSAoYXdhaXQgdGhpcy5nZXREZXZpY2VDb3VudHJ5KCkpLnRvVXBwZXJDYXNlKCk7XG5cbiAgICBpZiAobGFuZ3VhZ2UgIT09IGN1ckxhbmd1YWdlIHx8IGNvdW50cnkgIT09IGN1ckNvdW50cnkpIHtcbiAgICAgIGF3YWl0IHRoaXMuc2V0RGV2aWNlU3lzTG9jYWxlVmlhU2V0dGluZ0FwcChsYW5ndWFnZSwgY291bnRyeSk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGxldCBjdXJMb2NhbGUgPSBhd2FpdCB0aGlzLmdldERldmljZUxvY2FsZSgpO1xuXG4gICAgLy8gemgtSGFucy1DTiA6IHpoLUNOXG4gICAgY29uc3QgbG9jYWxlQ29kZSA9IHNjcmlwdCA/IGAke2xhbmd1YWdlfS0ke3NjcmlwdH0tJHtjb3VudHJ5fWAgOiBgJHtsYW5ndWFnZX0tJHtjb3VudHJ5fWA7XG4gICAgbG9nLmRlYnVnKGBDdXJyZW50IGxvY2FsZTogJyR7Y3VyTG9jYWxlfSc7IHJlcXVlc3RlZCBsb2NhbGU6ICcke2xvY2FsZUNvZGV9J2ApO1xuICAgIGlmIChsb2NhbGVDb2RlLnRvTG93ZXJDYXNlKCkgIT09IGN1ckxvY2FsZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICBhd2FpdCB0aGlzLnNldERldmljZVN5c0xvY2FsZVZpYVNldHRpbmdBcHAobGFuZ3VhZ2UsIGNvdW50cnksIHNjcmlwdCk7XG4gICAgfVxuICB9XG59O1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IEFwcEluZm9cbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBuYW1lIC0gUGFja2FnZSBuYW1lLCBmb3IgZXhhbXBsZSAnY29tLmFjbWUuYXBwJy5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSB2ZXJzaW9uQ29kZSAtIFZlcnNpb24gY29kZS5cbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSB2ZXJzaW9uTmFtZSAtIFZlcnNpb24gbmFtZSwgZm9yIGV4YW1wbGUgJzEuMCcuXG4gKi9cblxuLyoqXG4gKiBHZXQgdGhlIHBhY2thZ2UgaW5mbyBmcm9tIGxvY2FsIGFwayBmaWxlLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBhcHBQYXRoIC0gVGhlIGZ1bGwgcGF0aCB0byBleGlzdGluZyAuYXBrKHMpIHBhY2thZ2Ugb24gdGhlIGxvY2FsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUgc3lzdGVtLlxuICogQHJldHVybiB7P0FwcEluZm99IFRoZSBwYXJzZWQgYXBwbGljYXRpb24gaW5mb3JtYXRpb24uXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5nZXRBcGtJbmZvID0gYXN5bmMgZnVuY3Rpb24gZ2V0QXBrSW5mbyAoYXBwUGF0aCkge1xuICBpZiAoIWF3YWl0IGZzLmV4aXN0cyhhcHBQYXRoKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgVGhlIGZpbGUgYXQgcGF0aCAke2FwcFBhdGh9IGRvZXMgbm90IGV4aXN0IG9yIGlzIG5vdCBhY2Nlc3NpYmxlYCk7XG4gIH1cblxuICBpZiAoYXBwUGF0aC5lbmRzV2l0aChBUEtTX0VYVEVOU0lPTikpIHtcbiAgICBhcHBQYXRoID0gYXdhaXQgdGhpcy5leHRyYWN0QmFzZUFwayhhcHBQYXRoKTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgYXBrUmVhZGVyID0gYXdhaXQgQXBrUmVhZGVyLm9wZW4oYXBwUGF0aCk7XG4gICAgY29uc3QgbWFuaWZlc3QgPSBhd2FpdCBhcGtSZWFkZXIucmVhZE1hbmlmZXN0KCk7XG4gICAgY29uc3Qge3BrZywgdmVyc2lvbk5hbWUsIHZlcnNpb25Db2RlfSA9IHBhcnNlTWFuaWZlc3QobWFuaWZlc3QpO1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiBwa2csXG4gICAgICB2ZXJzaW9uQ29kZSxcbiAgICAgIHZlcnNpb25OYW1lLFxuICAgIH07XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBsb2cud2FybihgRXJyb3IgJyR7ZS5tZXNzYWdlfScgd2hpbGUgZ2V0dGluZyBiYWRnaW5nIGluZm9gKTtcbiAgfVxuICByZXR1cm4ge307XG59O1xuXG4vKipcbiAqIEdldCB0aGUgcGFja2FnZSBpbmZvIGZyb20gdGhlIGluc3RhbGxlZCBhcHBsaWNhdGlvbi5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcGtnIC0gVGhlIG5hbWUgb2YgdGhlIGluc3RhbGxlZCBwYWNrYWdlLlxuICogQHJldHVybiB7P0FwcEluZm99IFRoZSBwYXJzZWQgYXBwbGljYXRpb24gaW5mb3JtYXRpb24uXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5nZXRQYWNrYWdlSW5mbyA9IGFzeW5jIGZ1bmN0aW9uIGdldFBhY2thZ2VJbmZvIChwa2cpIHtcbiAgbG9nLmRlYnVnKGBHZXR0aW5nIHBhY2thZ2UgaW5mbyBmb3IgJyR7cGtnfSdgKTtcbiAgbGV0IHJlc3VsdCA9IHtuYW1lOiBwa2d9O1xuICB0cnkge1xuICAgIGNvbnN0IHN0ZG91dCA9IGF3YWl0IHRoaXMuc2hlbGwoWydkdW1wc3lzJywgJ3BhY2thZ2UnLCBwa2ddKTtcbiAgICBjb25zdCB2ZXJzaW9uTmFtZU1hdGNoID0gbmV3IFJlZ0V4cCgvdmVyc2lvbk5hbWU9KFtcXGQrLl0rKS8pLmV4ZWMoc3Rkb3V0KTtcbiAgICBpZiAodmVyc2lvbk5hbWVNYXRjaCkge1xuICAgICAgcmVzdWx0LnZlcnNpb25OYW1lID0gdmVyc2lvbk5hbWVNYXRjaFsxXTtcbiAgICB9XG4gICAgY29uc3QgdmVyc2lvbkNvZGVNYXRjaCA9IG5ldyBSZWdFeHAoL3ZlcnNpb25Db2RlPShcXGQrKS8pLmV4ZWMoc3Rkb3V0KTtcbiAgICBpZiAodmVyc2lvbkNvZGVNYXRjaCkge1xuICAgICAgcmVzdWx0LnZlcnNpb25Db2RlID0gcGFyc2VJbnQodmVyc2lvbkNvZGVNYXRjaFsxXSwgMTApO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBsb2cud2FybihgRXJyb3IgJyR7ZXJyLm1lc3NhZ2V9JyB3aGlsZSBkdW1waW5nIHBhY2thZ2UgaW5mb2ApO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG4vKipcbiAqIEZldGNoZXMgYmFzZS5hcGsgb2YgdGhlIGdpdmVuIHBhY2thZ2UgdG8gdGhlIGxvY2FsIGZpbGUgc3lzdGVtXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHBrZyBUaGUgcGFja2FnZSBpZGVudGlmaWVyIChtdXN0IGJlIGFscmVhZHkgaW5zdGFsbGVkIG9uIHRoZSBkZXZpY2UpXG4gKiBAcGFyYW0ge3N0cmluZ30gdG1wRGlyIFRoZSBkZXN0aW5hdGlvbiBmb2xkZXIgcGF0aFxuICogQHJldHVybnMge3N0cmluZ30gRnVsbCBwYXRoIHRvIHRoZSBkb3dubG9hZGVkIGZpbGVcbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGVyZSB3YXMgYW4gZXJyb3Igd2hpbGUgZmV0Y2hpbmcgdGhlIC5hcGtcbiAqL1xuYXBrVXRpbHNNZXRob2RzLnB1bGxBcGsgPSBhc3luYyBmdW5jdGlvbiBwdWxsQXBrIChwa2csIHRtcERpcikge1xuICBjb25zdCBzdGRvdXQgPSBfLnRyaW0oYXdhaXQgdGhpcy5zaGVsbChbJ3BtJywgJ3BhdGgnLCBwa2ddKSk7XG4gIGNvbnN0IHBhY2thZ2VNYXJrZXIgPSAncGFja2FnZTonO1xuICBpZiAoIV8uc3RhcnRzV2l0aChzdGRvdXQsIHBhY2thZ2VNYXJrZXIpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBDYW5ub3QgcHVsbCB0aGUgLmFwayBwYWNrYWdlIGZvciAnJHtwa2d9Jy4gT3JpZ2luYWwgZXJyb3I6ICR7c3Rkb3V0fWApO1xuICB9XG5cbiAgY29uc3QgcmVtb3RlUGF0aCA9IHN0ZG91dC5yZXBsYWNlKHBhY2thZ2VNYXJrZXIsICcnKTtcbiAgY29uc3QgdG1wQXBwID0gcGF0aC5yZXNvbHZlKHRtcERpciwgYCR7cGtnfS5hcGtgKTtcbiAgYXdhaXQgdGhpcy5wdWxsKHJlbW90ZVBhdGgsIHRtcEFwcCk7XG4gIGxvZy5kZWJ1ZyhgUHVsbGVkIGFwcCBmb3IgcGFja2FnZSAnJHtwa2d9JyB0byAnJHt0bXBBcHB9J2ApO1xuICByZXR1cm4gdG1wQXBwO1xufTtcblxuLyoqXG4gKiBBY3RpdmF0ZXMgdGhlIGdpdmVuIGFwcGxpY2F0aW9uIG9yIGxhdW5jaGVzIGl0IGlmIG5lY2Vzc2FyeS5cbiAqIFRoZSBhY3Rpb24gbGl0ZXJhbGx5IHNpbXVsYXRlc1xuICogY2xpY2tpbmcgdGhlIGNvcnJlc3BvbmRpbmcgYXBwbGljYXRpb24gaWNvbiBvbiB0aGUgZGFzaGJvYXJkLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBhcHBJZCAtIEFwcGxpY2F0aW9uIHBhY2thZ2UgaWRlbnRpZmllclxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBhcHAgY2Fubm90IGJlIGFjdGl2YXRlZFxuICovXG5hcGtVdGlsc01ldGhvZHMuYWN0aXZhdGVBcHAgPSBhc3luYyBmdW5jdGlvbiBhY3RpdmF0ZUFwcCAoYXBwSWQpIHtcbiAgbG9nLmRlYnVnKGBBY3RpdmF0aW5nICcke2FwcElkfSdgKTtcbiAgY29uc3QgYXBpTGV2ZWwgPSBhd2FpdCB0aGlzLmdldEFwaUxldmVsKCk7XG4gIC8vIEZhbGxiYWNrIHRvIE1vbmtleSBpbiBvbGRlciBBUElzXG4gIGlmIChhcGlMZXZlbCA8IDI0KSB7XG4gICAgLy8gVGhlIG1vbmtleSBjb21tYW5kIGNvdWxkIHJhaXNlIGFuIGlzc3VlIGFzIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzQ0ODYwNDc1L2hvdy10by11c2UtdGhlLW1vbmtleS1jb21tYW5kLXdpdGgtYW4tYW5kcm9pZC1zeXN0ZW0tdGhhdC1kb2VzbnQtaGF2ZS1waHlzaWNhbFxuICAgIC8vIGJ1dCAnLS1wY3Qtc3lza2V5cyAwJyBjb3VsZCBjYXVzZSBhbm90aGVyIGJhY2tncm91bmQgcHJvY2VzcyBpc3N1ZS4gaHR0cHM6Ly9naXRodWIuY29tL2FwcGl1bS9hcHBpdW0vaXNzdWVzLzE2OTQxI2lzc3VlY29tbWVudC0xMTI5ODM3Mjg1XG4gICAgY29uc3QgY21kID0gWydtb25rZXknLFxuICAgICAgJy1wJywgYXBwSWQsXG4gICAgICAnLWMnLCAnYW5kcm9pZC5pbnRlbnQuY2F0ZWdvcnkuTEFVTkNIRVInLFxuICAgICAgJzEnXTtcbiAgICBsZXQgb3V0cHV0ID0gJyc7XG4gICAgdHJ5IHtcbiAgICAgIG91dHB1dCA9IGF3YWl0IHRoaXMuc2hlbGwoY21kKTtcbiAgICAgIGxvZy5kZWJ1ZyhgQ29tbWFuZCBzdGRvdXQ6ICR7b3V0cHV0fWApO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvZy5lcnJvckFuZFRocm93KGBDYW5ub3QgYWN0aXZhdGUgJyR7YXBwSWR9Jy4gT3JpZ2luYWwgZXJyb3I6ICR7ZS5tZXNzYWdlfWApO1xuICAgIH1cbiAgICBpZiAob3V0cHV0LmluY2x1ZGVzKCdtb25rZXkgYWJvcnRlZCcpKSB7XG4gICAgICBsb2cuZXJyb3JBbmRUaHJvdyhgQ2Fubm90IGFjdGl2YXRlICcke2FwcElkfScuIEFyZSB5b3Ugc3VyZSBpdCBpcyBpbnN0YWxsZWQ/YCk7XG4gICAgfVxuICAgIHJldHVybjtcbiAgfVxuXG4gIGxldCBhY3Rpdml0eU5hbWUgPSBhd2FpdCB0aGlzLnJlc29sdmVMYXVuY2hhYmxlQWN0aXZpdHkoYXBwSWQpO1xuICBpZiAoYWN0aXZpdHlOYW1lID09PSBSRVNPTFZFUl9BQ1RJVklUWV9OQU1FKSB7XG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FwcGl1bS9hcHBpdW0vaXNzdWVzLzE3MTI4XG4gICAgbG9nLmRlYnVnKFxuICAgICAgYFRoZSBsYXVuY2hhYmxlIGFjdGl2aXR5IG5hbWUgb2YgJyR7YXBwSWR9JyB3YXMgcmVzb2x2ZWQgdG8gJyR7YWN0aXZpdHlOYW1lfScuIGAgK1xuICAgICAgYFN3aXRjaGluZyB0aGUgcmVzb2x2ZXIgdG8gbm90IHVzZSBjbWRgXG4gICAgKTtcbiAgICBhY3Rpdml0eU5hbWUgPSBhd2FpdCB0aGlzLnJlc29sdmVMYXVuY2hhYmxlQWN0aXZpdHkoYXBwSWQsIHtwcmVmZXJDbWQ6IGZhbHNlfSk7XG4gIH1cblxuICBjb25zdCBzdGRvdXQgPSBhd2FpdCB0aGlzLnNoZWxsKFtcbiAgICAnYW0nLCAoYXBpTGV2ZWwgPCAyNikgPyAnc3RhcnQnIDogJ3N0YXJ0LWFjdGl2aXR5JyxcbiAgICAnLWEnLCAnYW5kcm9pZC5pbnRlbnQuYWN0aW9uLk1BSU4nLFxuICAgICctYycsICdhbmRyb2lkLmludGVudC5jYXRlZ29yeS5MQVVOQ0hFUicsXG4gICAgLy8gRkxBR19BQ1RJVklUWV9ORVdfVEFTSyB8IEZMQUdfQUNUSVZJVFlfUkVTRVRfVEFTS19JRl9ORUVERURcbiAgICAvLyBodHRwczovL2RldmVsb3Blci5hbmRyb2lkLmNvbS9yZWZlcmVuY2UvYW5kcm9pZC9jb250ZW50L0ludGVudCNGTEFHX0FDVElWSVRZX05FV19UQVNLXG4gICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIuYW5kcm9pZC5jb20vcmVmZXJlbmNlL2FuZHJvaWQvY29udGVudC9JbnRlbnQjRkxBR19BQ1RJVklUWV9SRVNFVF9UQVNLX0lGX05FRURFRFxuICAgICctZicsICcweDEwMjAwMDAwJyxcbiAgICAnLW4nLCBhY3Rpdml0eU5hbWUsXG4gIF0pO1xuICBsb2cuZGVidWcoc3Rkb3V0KTtcbiAgaWYgKC9eZXJyb3I6L21pLnRlc3Qoc3Rkb3V0KSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IGFjdGl2YXRlICcke2FwcElkfScuIE9yaWdpbmFsIGVycm9yOiAke3N0ZG91dH1gKTtcbiAgfVxufTtcblxuZXhwb3J0IHsgUkVNT1RFX0NBQ0hFX1JPT1QgfTtcbmV4cG9ydCBkZWZhdWx0IGFwa1V0aWxzTWV0aG9kcztcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQSxJQUFBQSxRQUFBLEdBQUFDLE9BQUE7QUFNQSxJQUFBQyxhQUFBLEdBQUFELE9BQUE7QUFDQSxJQUFBRSxPQUFBLEdBQUFDLHNCQUFBLENBQUFILE9BQUE7QUFDQSxJQUFBSSxLQUFBLEdBQUFELHNCQUFBLENBQUFILE9BQUE7QUFDQSxJQUFBSyxPQUFBLEdBQUFGLHNCQUFBLENBQUFILE9BQUE7QUFDQSxJQUFBTSxTQUFBLEdBQUFOLE9BQUE7QUFDQSxJQUFBTyxRQUFBLEdBQUFQLE9BQUE7QUFDQSxJQUFBUSxPQUFBLEdBQUFMLHNCQUFBLENBQUFILE9BQUE7QUFDQSxJQUFBUyxHQUFBLEdBQUFOLHNCQUFBLENBQUFILE9BQUE7QUFDQSxJQUFBVSxTQUFBLEdBQUFQLHNCQUFBLENBQUFILE9BQUE7QUFDQSxJQUFBVyxnQkFBQSxHQUFB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