{"version":3,"file":"driver.js","names":["_driver","require","_desiredCaps","_interopRequireDefault","_index","_methodMap","_androidHelpers","_lodash","_appiumAdb","_support","_asyncbox","_sharedPreferencesBuilder","_bluebird","APP_EXTENSION","DEVICE_PORT","NO_PROXY","RegExp","AndroidDriver","BaseDriver","newMethodMap","constructor","opts","shouldValidateCaps","locatorStrategies","desiredCapConstraints","desiredConstraints","sessionChromedrivers","jwpProxyActive","jwpProxyAvoid","_","clone","settings","DeviceSettings","ignoreUnimportantViews","onSettingsUpdate","bind","chromedriver","apkStrings","unlocker","helpers","cmd","fn","toPairs","commands","prototype","curContext","defaultContextName","createSession","args","sessionId","caps","serverDetails","platform","webStorageEnabled","takesScreenshot","javascriptEnabled","databaseEnabled","networkConnectionEnabled","locationContextEnabled","warnings","desired","Object","assign","defaultOpts","action","category","flags","disableAndroidWatchers","tmpDir","tempDir","staticDir","fullReset","autoLaunch","adbPort","DEFAULT_ADB_PORT","bootstrapPort","androidInstallTimeout","defaults","useUnlockHelperApp","isUndefined","unlockType","noReset","fastReset","skipUninstall","isChromeSession","adjustBrowserSessionCaps","nativeWebScreenshot","push","reboot","setAvdFromCapabilities","udid","emPort","getDeviceInfoFromCaps","adb","createADB","suppressKillServer","remoteAdbHost","clearDeviceLogsOnStart","adbExecTimeout","allowOfflineDevices","getApiLevel","log","warn","isPackageOrBundle","app","appPackage","configureApp","checkAppPresent","appOnDevice","info","checkPackagePresent","util","hasValue","networkSpeed","isEmulator","ensureNetworkSpeed","gpsEnabled","toggleGPSLocationProvider","startAndroidSession","e","deleteSession","ign","avd","deviceName","errorAndThrow","platformVersion","avdDevice","replace","isChromeBrowser","browserName","key","value","setCompressedLayoutHierarchy","defaultIME","initDevice","curDeviceId","deviceUDID","getPlatformVersion","deviceScreenSize","getScreenSize","deviceModel","getModel","deviceManufacturer","getManufacturer","disableWindowAnimation","isAnimationOn","setHiddenApiPolicy","ignoreHiddenApiPolicyError","setAnimationState","_wasWindowAnimationDisabled","initAUT","bootstrap","websocket","start","acceptSslCerts","onUnexpectedShutdown","err","ignoreUnexpectedShutdown","startUnexpectedShutdown","skipUnlock","unlock","update","startChromeSession","startAUT","orientation","debug","setOrientation","initAutoWebview","autoWebview","viewName","defaultWebviewName","timeout","autoWebviewTimeout","retryInterval","setContext","launchInfo","getLaunchInfo","uninstallOtherPackages","validateDesiredCaps","parseArray","SETTINGS_HELPER_PKG_ID","otherApps","message","B","all","map","installOtherApks","resetApp","uninstallApk","installApk","apkStringsForLanguage","pushStrings","language","sharedPreferences","setSharedPreferences","fs","exists","shell","compress","sendAction","compressLayout","_this$adb5","isEmpty","_screenRecordingProperties","stopRecordingScreen","removeAllSessionWebSocketHandlers","server","mobileStopScreenStreaming","_this$adb3","stopChromedriverProxies","unicodeKeyboard","resetKeyboard","_this$adb","setIME","dontStopAppOnReset","_this$adb2","forceStop","goToHome","_this$adb4","shutdown","stopLogcat","_this$adb6","_this$adb7","_this$adb8","_this$adb9","setDefaultHiddenApiPolicy","_this$adb10","avdName","killEmulator","sharedPrefs","name","JSON","stringify","remotePath","remoteFile","localPath","builder","getPrefsBuilder","build","prefs","toFile","unlink","SharedPrefsBuilder","proxyActive","getProxyAvoidList","canProxy","isFunction","proxyReqRes","exports","_default","default"],"sources":["../../lib/driver.js"],"sourcesContent":["import { BaseDriver, DeviceSettings } from 'appium/driver';\nimport desiredConstraints from './desired-caps';\nimport commands from './commands/index';\nimport { newMethodMap } from './method-map';\nimport {\n  helpers, ensureNetworkSpeed,\n  SETTINGS_HELPER_PKG_ID,\n} from './android-helpers';\nimport _ from 'lodash';\nimport { DEFAULT_ADB_PORT } from 'appium-adb';\nimport { fs, tempDir, util } from '@appium/support';\nimport { retryInterval } from 'asyncbox';\nimport { SharedPrefsBuilder } from 'shared-preferences-builder';\nimport B from 'bluebird';\n\nconst APP_EXTENSION = '.apk';\nconst DEVICE_PORT = 4724;\n\n// This is a set of methods and paths that we never want to proxy to\n// Chromedriver\nconst NO_PROXY = [\n  ['POST', new RegExp('^/session/[^/]+/context')],\n  ['GET', new RegExp('^/session/[^/]+/context')],\n  ['POST', new RegExp('^/session/[^/]+/appium')],\n  ['GET', new RegExp('^/session/[^/]+/appium')],\n  ['POST', new RegExp('^/session/[^/]+/touch/perform')],\n  ['POST', new RegExp('^/session/[^/]+/touch/multi/perform')],\n  ['POST', new RegExp('^/session/[^/]+/orientation')],\n  ['GET', new RegExp('^/session/[^/]+/orientation')],\n  ['POST', new RegExp('^/session/[^/]+/execute')],\n  ['POST', new RegExp('^/session/[^/]+/execute/sync')],\n  ['GET', new RegExp('^/session/[^/]+/network_connection')],\n  ['POST', new RegExp('^/session/[^/]+/network_connection')],\n];\n\nclass AndroidDriver extends BaseDriver {\n\n  static newMethodMap = newMethodMap;\n\n  constructor (opts = {}, shouldValidateCaps = true) {\n    super(opts, shouldValidateCaps);\n\n    this.locatorStrategies = [\n      'xpath',\n      'id',\n      'class name',\n      'accessibility id',\n      '-android uiautomator'\n    ];\n    this.desiredCapConstraints = desiredConstraints;\n    this.sessionChromedrivers = {};\n    this.jwpProxyActive = false;\n    this.jwpProxyAvoid = _.clone(NO_PROXY);\n    this.settings = new DeviceSettings({ignoreUnimportantViews: false},\n                                       this.onSettingsUpdate.bind(this));\n    this.chromedriver = null;\n    this.apkStrings = {};\n    this.unlocker = helpers.unlocker;\n\n    for (let [cmd, fn] of _.toPairs(commands)) {\n      AndroidDriver.prototype[cmd] = fn;\n    }\n\n    // needs to be after the line which assigns commands to AndroidDriver.prototype, so that `this.defaultContextName` is defined.\n    this.curContext = this.defaultContextName();\n  }\n\n  async createSession (...args) {\n    // the whole createSession flow is surrounded in a try-catch statement\n    // if creating a session fails at any point, we teardown everything we\n    // set up before throwing the error.\n    try {\n      let [sessionId, caps] = await super.createSession(...args);\n\n      let serverDetails = {\n        platform: 'LINUX',\n        webStorageEnabled: false,\n        takesScreenshot: true,\n        javascriptEnabled: true,\n        databaseEnabled: false,\n        networkConnectionEnabled: true,\n        locationContextEnabled: false,\n        warnings: {},\n        desired: this.caps\n      };\n\n      this.caps = Object.assign(serverDetails, this.caps);\n\n      // assigning defaults\n      let defaultOpts = {\n        action: 'android.intent.action.MAIN',\n        category: 'android.intent.category.LAUNCHER',\n        flags: '0x10200000',\n        disableAndroidWatchers: false,\n        tmpDir: await tempDir.staticDir(),\n        fullReset: false,\n        autoLaunch: true,\n        adbPort: DEFAULT_ADB_PORT,\n        bootstrapPort: DEVICE_PORT,\n        androidInstallTimeout: 90000,\n      };\n      _.defaults(this.opts, defaultOpts);\n      this.useUnlockHelperApp = _.isUndefined(this.caps.unlockType);\n\n      // not user visible via caps\n      if (this.opts.noReset === true) {\n        this.opts.fullReset = false;\n      }\n      if (this.opts.fullReset === true) {\n        this.opts.noReset = false;\n      }\n      this.opts.fastReset = !this.opts.fullReset && !this.opts.noReset;\n      this.opts.skipUninstall = this.opts.fastReset || this.opts.noReset;\n\n      if (this.isChromeSession) {\n        helpers.adjustBrowserSessionCaps(this.opts);\n      }\n\n      if (this.opts.nativeWebScreenshot) {\n        this.jwpProxyAvoid.push(['GET', new RegExp('^/session/[^/]+/screenshot')]);\n      }\n\n      if (this.opts.reboot) {\n        this.setAvdFromCapabilities(caps);\n      }\n\n      // get device udid for this session\n      let {udid, emPort} = await helpers.getDeviceInfoFromCaps(this.opts);\n      this.opts.udid = udid;\n      this.opts.emPort = emPort;\n\n      // set up an instance of ADB\n      this.adb = await helpers.createADB({\n        udid: this.opts.udid,\n        emPort: this.opts.emPort,\n        adbPort: this.opts.adbPort,\n        suppressKillServer: this.opts.suppressKillServer,\n        remoteAdbHost: this.opts.remoteAdbHost,\n        clearDeviceLogsOnStart: this.opts.clearDeviceLogsOnStart,\n        adbExecTimeout: this.opts.adbExecTimeout,\n        allowOfflineDevices: this.opts.allowOfflineDevices,\n      });\n\n      if (await this.adb.getApiLevel() >= 23) {\n        this.log.warn(\"Consider setting 'automationName' capability to \" +\n          \"'uiautomator2' on Android >= 6, since UIAutomator framework \" +\n          'is not maintained anymore by the OS vendor.');\n      }\n\n      if (this.helpers.isPackageOrBundle(this.opts.app)) {\n        // user provided package instead of app for 'app' capability, massage options\n        this.opts.appPackage = this.opts.app;\n        this.opts.app = null;\n      }\n\n      if (this.opts.app) {\n        // find and copy, or download and unzip an app url or path\n        this.opts.app = await this.helpers.configureApp(this.opts.app, APP_EXTENSION);\n        await this.checkAppPresent();\n      } else if (this.appOnDevice) {\n        // the app isn't an actual app file but rather something we want to\n        // assume is on the device and just launch via the appPackage\n        this.log.info(`App file was not listed, instead we're going to run ` +\n          `${this.opts.appPackage} directly on the device`);\n        await this.checkPackagePresent();\n      }\n\n      // Some cloud services using appium launch the avd themselves, so we ensure netspeed\n      // is set for emulators by calling adb.networkSpeed before running the app\n      if (util.hasValue(this.opts.networkSpeed)) {\n        if (!this.isEmulator()) {\n          this.log.warn('Sorry, networkSpeed capability is only available for emulators');\n        } else {\n          const networkSpeed = ensureNetworkSpeed(this.adb, this.opts.networkSpeed);\n          await this.adb.networkSpeed(networkSpeed);\n        }\n      }\n      // check if we have to enable/disable gps before running the application\n      if (util.hasValue(this.opts.gpsEnabled)) {\n        if (this.isEmulator()) {\n          this.log.info(`Trying to ${this.opts.gpsEnabled ? 'enable' : 'disable'} gps location provider`);\n          await this.adb.toggleGPSLocationProvider(this.opts.gpsEnabled);\n        } else {\n          this.log.warn('Sorry! gpsEnabled capability is only available for emulators');\n        }\n      }\n\n      await this.startAndroidSession(this.opts);\n      return [sessionId, this.caps];\n    } catch (e) {\n      // ignoring delete session exception if any and throw the real error\n      // that happened while creating the session.\n      try {\n        await this.deleteSession();\n      } catch (ign) {}\n      throw e;\n    }\n  }\n\n  isEmulator () {\n    return helpers.isEmulator(this.adb, this.opts);\n  }\n\n  setAvdFromCapabilities (caps) {\n    if (this.opts.avd) {\n      this.log.info('avd name defined, ignoring device name and platform version');\n    } else {\n      if (!caps.deviceName) {\n        this.log.errorAndThrow('avd or deviceName should be specified when reboot option is enables');\n      }\n      if (!caps.platformVersion) {\n        this.log.errorAndThrow('avd or platformVersion should be specified when reboot option is enabled');\n      }\n      let avdDevice = caps.deviceName.replace(/[^a-zA-Z0-9_.]/g, '-');\n      this.opts.avd = `${avdDevice}__${caps.platformVersion}`;\n    }\n  }\n\n  get appOnDevice () {\n    return this.helpers.isPackageOrBundle(this.opts.app) || (!this.opts.app &&\n           this.helpers.isPackageOrBundle(this.opts.appPackage));\n  }\n\n  get isChromeSession () {\n    return helpers.isChromeBrowser(this.opts.browserName);\n  }\n\n  async onSettingsUpdate (key, value) {\n    if (key === 'ignoreUnimportantViews') {\n      await this.setCompressedLayoutHierarchy(value);\n    }\n  }\n\n  async startAndroidSession () {\n    this.log.info(`Starting Android session`);\n    // set up the device to run on (real or emulator, etc)\n    this.defaultIME = await helpers.initDevice(this.adb, this.opts);\n\n    // set actual device name, udid, platform version, screen size, model and manufacturer details.\n    this.caps.deviceName = this.adb.curDeviceId;\n    this.caps.deviceUDID = this.opts.udid;\n    this.caps.platformVersion = await this.adb.getPlatformVersion();\n    this.caps.deviceScreenSize = await this.adb.getScreenSize();\n    this.caps.deviceModel = await this.adb.getModel();\n    this.caps.deviceManufacturer = await this.adb.getManufacturer();\n\n    if (this.opts.disableWindowAnimation) {\n      if (await this.adb.isAnimationOn()) {\n        if (await this.adb.getApiLevel() >= 28) { // API level 28 is Android P\n          // Don't forget to reset the relaxing in delete session\n          this.log.warn('Relaxing hidden api policy to manage animation scale');\n          await this.adb.setHiddenApiPolicy('1', !!this.opts.ignoreHiddenApiPolicyError);\n        }\n\n        this.log.info('Disabling window animation as it is requested by \"disableWindowAnimation\" capability');\n        await this.adb.setAnimationState(false);\n        this._wasWindowAnimationDisabled = true;\n      } else {\n        this.log.info('Window animation is already disabled');\n      }\n    }\n\n    // set up app under test\n    await this.initAUT();\n\n    // start UiAutomator\n    this.bootstrap = new helpers.bootstrap(this.adb, this.opts.bootstrapPort, this.opts.websocket);\n    await this.bootstrap.start(this.opts.appPackage, this.opts.disableAndroidWatchers, this.opts.acceptSslCerts);\n    // handling unexpected shutdown\n    (async () => {\n      try {\n        await this.bootstrap.onUnexpectedShutdown;\n      } catch (err) {\n        if (!this.bootstrap.ignoreUnexpectedShutdown) {\n          await this.startUnexpectedShutdown(err);\n        }\n      }\n    })();\n\n\n    if (this.opts.skipUnlock) {\n      this.log.info('Skipping lockscreen check');\n    } else {\n      this.log.info('Checking for lockscreen presence. ' +\n        `This could be skipped by setting the 'appium:skipUnlock' capability to true.`);\n      await helpers.unlock(this, this.adb, this.caps);\n    }\n\n    // Set CompressedLayoutHierarchy on the device based on current settings object\n    // this has to happen _after_ bootstrap is initialized\n    if (this.opts.ignoreUnimportantViews) {\n      await this.settings.update({ignoreUnimportantViews: this.opts.ignoreUnimportantViews});\n    }\n\n    if (this.isChromeSession) {\n      // start a chromedriver session and proxy to it\n      await this.startChromeSession();\n    } else {\n      if (this.opts.autoLaunch) {\n        // start app\n        await this.startAUT();\n      }\n    }\n\n    if (util.hasValue(this.opts.orientation)) {\n      this.log.debug(`Setting initial orientation to '${this.opts.orientation}'`);\n      await this.setOrientation(this.opts.orientation);\n    }\n\n    await this.initAutoWebview();\n  }\n\n  async initAutoWebview () {\n    if (this.opts.autoWebview) {\n      let viewName = this.defaultWebviewName();\n      let timeout = (this.opts.autoWebviewTimeout) || 2000;\n\n      this.log.info(`Setting auto webview to context '${viewName}' with timeout ${timeout}ms`);\n\n      // try every 500ms until timeout is over\n      await retryInterval(timeout / 500, 500, async () => {\n        await this.setContext(viewName);\n      });\n    }\n  }\n\n  async initAUT () {\n    // populate appPackage, appActivity, appWaitPackage, appWaitActivity,\n    // and the device being used\n    // in the opts and caps (so it gets back to the user on session creation)\n    let launchInfo = await helpers.getLaunchInfo(this.adb, this.opts);\n    Object.assign(this.opts, launchInfo);\n    Object.assign(this.caps, launchInfo);\n\n    // Uninstall any uninstallOtherPackages which were specified in caps\n    if (this.opts.uninstallOtherPackages) {\n      helpers.validateDesiredCaps(this.opts);\n      // Only SETTINGS_HELPER_PKG_ID package is used by UIA1\n      await helpers.uninstallOtherPackages(\n        this.adb,\n        helpers.parseArray(this.opts.uninstallOtherPackages),\n        [SETTINGS_HELPER_PKG_ID]\n      );\n    }\n\n    // Install any \"otherApps\" that were specified in caps\n    if (this.opts.otherApps) {\n      let otherApps;\n      try {\n        otherApps = helpers.parseArray(this.opts.otherApps);\n      } catch (e) {\n        this.log.errorAndThrow(`Could not parse \"otherApps\" capability: ${e.message}`);\n      }\n      otherApps = await B.all(otherApps.map((app) => this.helpers.configureApp(app, APP_EXTENSION)));\n      await helpers.installOtherApks(otherApps, this.adb, this.opts);\n    }\n\n    // install app\n    if (!this.opts.app) {\n      if (this.opts.fullReset) {\n        this.log.errorAndThrow('Full reset requires an app capability, use fastReset if app is not provided');\n      }\n      this.log.debug('No app capability. Assuming it is already on the device');\n      if (this.opts.fastReset) {\n        await helpers.resetApp(this.adb, this.opts);\n      }\n      return;\n    }\n    if (!this.opts.skipUninstall) {\n      await this.adb.uninstallApk(this.opts.appPackage);\n    }\n    await helpers.installApk(this.adb, this.opts);\n    const apkStringsForLanguage = await helpers.pushStrings(this.opts.language, this.adb, this.opts);\n    if (this.opts.language) {\n      this.apkStrings[this.opts.language] = apkStringsForLanguage;\n    }\n\n    // This must run after installing the apk, otherwise it would cause the\n    // install to fail. And before running the app.\n    if (!_.isUndefined(this.opts.sharedPreferences)) {\n      await this.setSharedPreferences(this.opts);\n    }\n  }\n\n  async checkAppPresent () {\n    this.log.debug('Checking whether app is actually present');\n    if (!(await fs.exists(this.opts.app))) {\n      this.log.errorAndThrow(`Could not find app apk at ${this.opts.app}`);\n    }\n  }\n\n  async checkPackagePresent () {\n    this.log.debug('Checking whether package is present on the device');\n    if (!(await this.adb.shell(['pm', 'list', 'packages', this.opts.appPackage]))) {\n      this.log.errorAndThrow(`Could not find package ${this.opts.appPackage} on the device`);\n    }\n  }\n\n  // Set CompressedLayoutHierarchy on the device\n  async setCompressedLayoutHierarchy (compress) {\n    await this.bootstrap.sendAction('compressedLayoutHierarchy', {compressLayout: compress});\n  }\n\n  async deleteSession () {\n    this.log.debug('Shutting down Android driver');\n\n    try {\n      if (!_.isEmpty(this._screenRecordingProperties)) {\n        await this.stopRecordingScreen();\n      }\n    } catch (ign) {}\n\n    await helpers.removeAllSessionWebSocketHandlers(this.server, this.sessionId);\n\n    await this.mobileStopScreenStreaming();\n\n    await super.deleteSession();\n\n    if (this.bootstrap) {\n      // certain cleanup we only care to do if the bootstrap was ever run\n      await this.stopChromedriverProxies();\n      if (this.opts.unicodeKeyboard && this.opts.resetKeyboard && this.defaultIME) {\n        this.log.debug(`Resetting IME to ${this.defaultIME}`);\n        await this.adb?.setIME(this.defaultIME);\n      }\n      if (!this.isChromeSession && !this.opts.dontStopAppOnReset) {\n        await this.adb?.forceStop(this.opts.appPackage);\n      }\n      await this.adb?.goToHome();\n      if (this.opts.fullReset && !this.opts.skipUninstall && !this.appOnDevice) {\n        await this.adb?.uninstallApk(this.opts.appPackage);\n      }\n      await this.bootstrap.shutdown();\n      this.bootstrap = null;\n    } else {\n      this.log.debug(\"Called deleteSession but bootstrap wasn't active\");\n    }\n    // some cleanup we want to do regardless, in case we are shutting down\n    // mid-startup\n    await this.adb?.stopLogcat();\n    if (this.useUnlockHelperApp) {\n      await this.adb?.forceStop('io.appium.unlock');\n    }\n    if (this._wasWindowAnimationDisabled) {\n      this.log.info('Restoring window animation state');\n      await this.adb?.setAnimationState(true);\n\n      // This was necessary to change animation scale over Android P. We must reset the policy for the security.\n      if (await this.adb?.getApiLevel() >= 28) {\n        this.log.info('Restoring hidden api policy to the device default configuration');\n        await this.adb?.setDefaultHiddenApiPolicy(!!this.opts.ignoreHiddenApiPolicyError);\n      }\n    }\n\n    if (this.opts.reboot) {\n      let avdName = this.opts.avd.replace('@', '');\n      this.log.debug(`closing emulator '${avdName}'`);\n      await this.adb?.killEmulator(avdName);\n    }\n  }\n\n  async setSharedPreferences () {\n    let sharedPrefs = this.opts.sharedPreferences;\n    this.log.info('Trying to set shared preferences');\n    let name = sharedPrefs.name;\n    if (_.isUndefined(name)) {\n      this.log.warn(`Skipping setting Shared preferences, name is undefined: ${JSON.stringify(sharedPrefs)}`);\n      return false;\n    }\n    let remotePath = `/data/data/${this.opts.appPackage}/shared_prefs`;\n    let remoteFile = `${remotePath}/${name}.xml`;\n    let localPath = `/tmp/${name}.xml`;\n    let builder = this.getPrefsBuilder();\n    builder.build(sharedPrefs.prefs);\n    this.log.info(`Creating temporary shared preferences: ${localPath}`);\n    builder.toFile(localPath);\n    this.log.info(`Creating shared_prefs remote folder: ${remotePath}`);\n    await this.adb.shell(['mkdir', '-p', remotePath]);\n    this.log.info(`Pushing shared_prefs to ${remoteFile}`);\n    await this.adb.push(localPath, remoteFile);\n    try {\n      this.log.info(`Trying to remove shared preferences temporary file`);\n      if (await fs.exists(localPath)) {\n        await fs.unlink(localPath);\n      }\n    } catch (e) {\n      this.log.warn(`Error trying to remove temporary file ${localPath}`);\n    }\n    return true;\n  }\n\n  getPrefsBuilder () {\n    /* Add this method to create a new SharedPrefsBuilder instead of\n     * directly creating the object on setSharedPreferences for testing purposes\n    */\n    return new SharedPrefsBuilder();\n  }\n\n  validateDesiredCaps (caps) {\n    if (!super.validateDesiredCaps(caps)) {\n      return false;\n    }\n    if ((!caps.browserName || !helpers.isChromeBrowser(caps.browserName)) && !caps.app && !caps.appPackage) {\n      this.log.errorAndThrow('The desired capabilities must include either an app, appPackage or browserName');\n    }\n    return helpers.validateDesiredCaps(caps);\n  }\n\n  proxyActive (sessionId) {\n    super.proxyActive(sessionId);\n\n    return this.jwpProxyActive;\n  }\n\n  getProxyAvoidList (sessionId) {\n    super.getProxyAvoidList(sessionId);\n\n    return this.jwpProxyAvoid;\n  }\n\n  canProxy (sessionId) {\n    super.canProxy(sessionId);\n\n    // this will change depending on ChromeDriver status\n    return _.isFunction(this.proxyReqRes);\n  }\n}\n\nexport { AndroidDriver };\nexport default AndroidDriver;\n"],"mappings":"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"}