{"version":3,"file":"execute.js","names":["_lodash","_interopRequireDefault","require","_driver","extensions","execute","script","args","match","log","info","replace","trim","executeMobile","_","isArray","isWebContext","errors","NotImplementedError","endpoint","chromedriver","jwproxy","downstreamProtocol","PROTOCOLS","MJSONWP","command","mobileCommand","opts","mobileCommandsMapping","shell","execEmuConsoleCommand","startLogsBroadcast","stopLogsBroadcast","changePermissions","getPermissions","performEditorAction","sensorSet","getDeviceTime","startScreenStreaming","stopScreenStreaming","getNotifications","listSms","pushFile","pullFile","pullFolder","deleteFile","isAppInstalled","queryAppState","activateApp","removeApp","terminateApp","installApp","clearApp","startService","stopService","startActivity","broadcast","getContexts","unlock","refreshGpsCache","startMediaProjectionRecording","isMediaProjectionRecordingRunning","stopMediaProjectionRecording","getConnectivity","setConnectivity","hideKeyboard","isKeyboardShown","has","UnknownCommandError","keys","_default","exports","default"],"sources":["../../../lib/commands/execute.js"],"sourcesContent":["import _ from 'lodash';\nimport { errors, PROTOCOLS } from 'appium/driver';\n\nconst extensions = {};\n\nextensions.execute = async function execute (script, args) {\n  if (script.match(/^mobile:/)) {\n    this.log.info(`Executing native command '${script}'`);\n    script = script.replace(/^mobile:/, '').trim();\n    return await this.executeMobile(script, _.isArray(args) ? args[0] : args);\n  }\n  if (!this.isWebContext()) {\n    throw new errors.NotImplementedError();\n  }\n  const endpoint = this.chromedriver.jwproxy.downstreamProtocol === PROTOCOLS.MJSONWP\n    ? '/execute'\n    : '/execute/sync';\n  return await this.chromedriver.jwproxy.command(endpoint, 'POST', {\n    script,\n    args,\n  });\n};\n\nextensions.executeMobile = async function executeMobile (mobileCommand, opts = {}) {\n  const mobileCommandsMapping = {\n    shell: 'mobileShell',\n\n    execEmuConsoleCommand: 'mobileExecEmuConsoleCommand',\n\n    startLogsBroadcast: 'mobileStartLogsBroadcast',\n    stopLogsBroadcast: 'mobileStopLogsBroadcast',\n\n    changePermissions: 'mobileChangePermissions',\n    getPermissions: 'mobileGetPermissions',\n\n    performEditorAction: 'mobilePerformEditorAction',\n\n    sensorSet: 'sensorSet',\n\n    getDeviceTime: 'mobileGetDeviceTime',\n\n    startScreenStreaming: 'mobileStartScreenStreaming',\n    stopScreenStreaming: 'mobileStopScreenStreaming',\n\n    getNotifications: 'mobileGetNotifications',\n\n    listSms: 'mobileListSms',\n\n    pushFile: 'mobilePushFile',\n    pullFile: 'mobilePullFile',\n    pullFolder: 'mobilePullFolder',\n    deleteFile: 'mobileDeleteFile',\n\n    isAppInstalled: 'mobileIsAppInstalled',\n    queryAppState: 'mobileQueryAppState',\n    activateApp: 'mobileActivateApp',\n    removeApp: 'mobileRemoveApp',\n    terminateApp: 'mobileTerminateApp',\n    installApp: 'mobileInstallApp',\n    clearApp: 'mobileClearApp',\n\n    startService: 'mobileStartService',\n    stopService: 'mobileStopService',\n    startActivity: 'mobileStartActivity',\n    broadcast: 'mobileBroadcast',\n\n    getContexts: 'mobileGetContexts',\n\n    unlock: 'mobileUnlock',\n\n    refreshGpsCache: 'mobileRefreshGpsCache',\n\n    startMediaProjectionRecording: 'mobileStartMediaProjectionRecording',\n    isMediaProjectionRecordingRunning: 'mobileIsMediaProjectionRecordingRunning',\n    stopMediaProjectionRecording: 'mobileStopMediaProjectionRecording',\n\n    getConnectivity: 'mobileGetConnectivity',\n    setConnectivity: 'mobileSetConnectivity',\n\n    hideKeyboard: 'hideKeyboard',\n    isKeyboardShown: 'isKeyboardShown',\n  };\n\n  if (!_.has(mobileCommandsMapping, mobileCommand)) {\n    throw new errors.UnknownCommandError(`Unknown mobile command \"${mobileCommand}\". ` +\n      `Only ${_.keys(mobileCommandsMapping)} commands are supported.`);\n  }\n  return await this[mobileCommandsMapping[mobileCommand]](opts);\n};\n\nexport default extensions;\n"],"mappings":"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"}