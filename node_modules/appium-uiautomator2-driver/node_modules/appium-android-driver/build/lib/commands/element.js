"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.helpers = exports.default = exports.commands = void 0;
require("source-map-support/register");
var _androidHelpers = _interopRequireDefault(require("../android-helpers"));
var _asyncbox = require("asyncbox");
var _support = require("@appium/support");
let commands = {},
  helpers = {},
  extensions = {};
exports.helpers = helpers;
exports.commands = commands;
commands.getAttribute = async function getAttribute(attribute, elementId) {
  let p = {
    attribute,
    elementId
  };
  return await this.bootstrap.sendAction('element:getAttribute', p);
};
commands.getName = async function getName(elementId) {
  return await this.getAttribute('className', elementId);
};
commands.elementDisplayed = async function elementDisplayed(elementId) {
  return (await this.getAttribute('displayed', elementId)) === 'true';
};
commands.elementEnabled = async function elementEnabled(elementId) {
  return (await this.getAttribute('enabled', elementId)) === 'true';
};
commands.elementSelected = async function elementSelected(elementId) {
  return (await this.getAttribute('selected', elementId)) === 'true';
};
helpers.setElementValue = async function setElementValue(keys, elementId, replace = false) {
  let text = keys;
  if (keys instanceof Array) {
    text = keys.join('');
  }
  let params = {
    elementId,
    text,
    replace,
    unicodeKeyboard: this.opts.unicodeKeyboard
  };
  return await this.doSetElementValue(params);
};
helpers.doSetElementValue = async function doSetElementValue(params) {
  return await this.bootstrap.sendAction('element:setText', params);
};
commands.setValue = async function setValue(keys, elementId) {
  return await this.setElementValue(keys, elementId, false);
};
commands.replaceValue = async function replaceValue(keys, elementId) {
  return await this.setElementValue(keys, elementId, true);
};
commands.setValueImmediate = async function setValueImmediate(keys, elementId) {
  let text = keys;
  if (keys instanceof Array) {
    text = keys.join('');
  }
  await this.click(elementId);
  await this.adb.inputText(text);
};
commands.getText = async function getText(elementId) {
  return await this.bootstrap.sendAction('element:getText', {
    elementId
  });
};
commands.clear = async function clear(elementId) {
  let text = (await this.getText(elementId)) || '';
  let length = text.length;
  if (length === 0) {
    length = 100;
  }
  await this.click(elementId);
  this.log.debug(`Sending up to ${length} clear characters to device`);
  return await (0, _asyncbox.retryInterval)(5, 500, async () => {
    let remainingLength = length;
    while (remainingLength > 0) {
      let lengthToSend = remainingLength < 50 ? remainingLength : 50;
      this.log.debug(`Sending ${lengthToSend} clear characters to device`);
      await this.adb.clearTextField(lengthToSend);
      remainingLength -= lengthToSend;
    }
  });
};
commands.click = async function click(elementId) {
  return await this.bootstrap.sendAction('element:click', {
    elementId
  });
};
commands.getLocation = async function getLocation(elementId) {
  return await this.bootstrap.sendAction('element:getLocation', {
    elementId
  });
};
commands.getLocationInView = async function getLocationInView(elementId) {
  return await this.getLocation(elementId);
};
commands.getSize = async function getSize(elementId) {
  return await this.bootstrap.sendAction('element:getSize', {
    elementId
  });
};
commands.getElementRect = async function getElementRect(elementId) {
  return await this.bootstrap.sendAction('element:getRect', {
    elementId
  });
};
commands.touchLongClick = async function touchLongClick(elementId, x, y, duration) {
  let params = {
    elementId,
    x,
    y,
    duration
  };
  _androidHelpers.default.removeNullProperties(params);
  return await this.bootstrap.sendAction('element:touchLongClick', params);
};
commands.touchDown = async function touchDown(elementId, x, y) {
  let params = {
    elementId,
    x,
    y
  };
  _androidHelpers.default.removeNullProperties(params);
  return await this.bootstrap.sendAction('element:touchDown', params);
};
commands.touchUp = async function touchUp(elementId, x, y) {
  let params = {
    elementId,
    x,
    y
  };
  _androidHelpers.default.removeNullProperties(params);
  return await this.bootstrap.sendAction('element:touchUp', params);
};
commands.touchMove = async function touchMove(elementId, x, y) {
  let params = {
    elementId,
    x,
    y
  };
  _androidHelpers.default.removeNullProperties(params);
  return await this.bootstrap.sendAction('element:touchMove', params);
};
commands.complexTap = async function complexTap(tapCount, touchCount, duration, x, y) {
  return await this.bootstrap.sendAction('click', {
    x,
    y
  });
};
commands.tap = async function (elementId = null, x = null, y = null, count = 1) {
  if (!_support.util.hasValue(elementId) && !_support.util.hasValue(x) && !_support.util.hasValue(y)) {
    throw new Error(`Either element to tap or both absolute coordinates should be defined`);
  }
  for (let i = 0; i < count; i++) {
    if (_support.util.hasValue(elementId)) {
      await this.bootstrap.sendAction('element:click', {
        elementId,
        x,
        y
      });
    } else {
      await this.bootstrap.sendAction('click', {
        x,
        y
      });
    }
  }
};
Object.assign(extensions, commands, helpers);
var _default = extensions;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYW5kcm9pZEhlbHBlcnMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9hc3luY2JveCIsIl9zdXBwb3J0IiwiY29tbWFuZHMiLCJoZWxwZXJzIiwiZXh0ZW5zaW9ucyIsImV4cG9ydHMiLCJnZXRBdHRyaWJ1dGUiLCJhdHRyaWJ1dGUiLCJlbGVtZW50SWQiLCJwIiwiYm9vdHN0cmFwIiwic2VuZEFjdGlvbiIsImdldE5hbWUiLCJlbGVtZW50RGlzcGxheWVkIiwiZWxlbWVudEVuYWJsZWQiLCJlbGVtZW50U2VsZWN0ZWQiLCJzZXRFbGVtZW50VmFsdWUiLCJrZXlzIiwicmVwbGFjZSIsInRleHQiLCJBcnJheSIsImpvaW4iLCJwYXJhbXMiLCJ1bmljb2RlS2V5Ym9hcmQiLCJvcHRzIiwiZG9TZXRFbGVtZW50VmFsdWUiLCJzZXRWYWx1ZSIsInJlcGxhY2VWYWx1ZSIsInNldFZhbHVlSW1tZWRpYXRlIiwiY2xpY2siLCJhZGIiLCJpbnB1dFRleHQiLCJnZXRUZXh0IiwiY2xlYXIiLCJsZW5ndGgiLCJsb2ciLCJkZWJ1ZyIsInJldHJ5SW50ZXJ2YWwiLCJyZW1haW5pbmdMZW5ndGgiLCJsZW5ndGhUb1NlbmQiLCJjbGVhclRleHRGaWVsZCIsImdldExvY2F0aW9uIiwiZ2V0TG9jYXRpb25JblZpZXciLCJnZXRTaXplIiwiZ2V0RWxlbWVudFJlY3QiLCJ0b3VjaExvbmdDbGljayIsIngiLCJ5IiwiZHVyYXRpb24iLCJhbmRyb2lkSGVscGVycyIsInJlbW92ZU51bGxQcm9wZXJ0aWVzIiwidG91Y2hEb3duIiwidG91Y2hVcCIsInRvdWNoTW92ZSIsImNvbXBsZXhUYXAiLCJ0YXBDb3VudCIsInRvdWNoQ291bnQiLCJ0YXAiLCJjb3VudCIsInV0aWwiLCJoYXNWYWx1ZSIsIkVycm9yIiwiaSIsIk9iamVjdCIsImFzc2lnbiIsIl9kZWZhdWx0IiwiZGVmYXVsdCJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2xpYi9jb21tYW5kcy9lbGVtZW50LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBhbmRyb2lkSGVscGVycyBmcm9tICcuLi9hbmRyb2lkLWhlbHBlcnMnO1xuaW1wb3J0IHsgcmV0cnlJbnRlcnZhbCB9IGZyb20gJ2FzeW5jYm94JztcbmltcG9ydCB7IHV0aWwgfSBmcm9tICdAYXBwaXVtL3N1cHBvcnQnO1xuXG5cbmxldCBjb21tYW5kcyA9IHt9LCBoZWxwZXJzID0ge30sIGV4dGVuc2lvbnMgPSB7fTtcblxuY29tbWFuZHMuZ2V0QXR0cmlidXRlID0gYXN5bmMgZnVuY3Rpb24gZ2V0QXR0cmlidXRlIChhdHRyaWJ1dGUsIGVsZW1lbnRJZCkge1xuICBsZXQgcCA9IHthdHRyaWJ1dGUsIGVsZW1lbnRJZH07XG4gIHJldHVybiBhd2FpdCB0aGlzLmJvb3RzdHJhcC5zZW5kQWN0aW9uKCdlbGVtZW50OmdldEF0dHJpYnV0ZScsIHApO1xufTtcblxuY29tbWFuZHMuZ2V0TmFtZSA9IGFzeW5jIGZ1bmN0aW9uIGdldE5hbWUgKGVsZW1lbnRJZCkge1xuICByZXR1cm4gYXdhaXQgdGhpcy5nZXRBdHRyaWJ1dGUoJ2NsYXNzTmFtZScsIGVsZW1lbnRJZCk7XG59O1xuXG5jb21tYW5kcy5lbGVtZW50RGlzcGxheWVkID0gYXN5bmMgZnVuY3Rpb24gZWxlbWVudERpc3BsYXllZCAoZWxlbWVudElkKSB7XG4gIHJldHVybiBhd2FpdCB0aGlzLmdldEF0dHJpYnV0ZSgnZGlzcGxheWVkJywgZWxlbWVudElkKSA9PT0gJ3RydWUnO1xufTtcblxuY29tbWFuZHMuZWxlbWVudEVuYWJsZWQgPSBhc3luYyBmdW5jdGlvbiBlbGVtZW50RW5hYmxlZCAoZWxlbWVudElkKSB7XG4gIHJldHVybiBhd2FpdCB0aGlzLmdldEF0dHJpYnV0ZSgnZW5hYmxlZCcsIGVsZW1lbnRJZCkgPT09ICd0cnVlJztcbn07XG5cbmNvbW1hbmRzLmVsZW1lbnRTZWxlY3RlZCA9IGFzeW5jIGZ1bmN0aW9uIGVsZW1lbnRTZWxlY3RlZCAoZWxlbWVudElkKSB7XG4gIHJldHVybiBhd2FpdCB0aGlzLmdldEF0dHJpYnV0ZSgnc2VsZWN0ZWQnLCBlbGVtZW50SWQpID09PSAndHJ1ZSc7XG59O1xuXG5oZWxwZXJzLnNldEVsZW1lbnRWYWx1ZSA9IGFzeW5jIGZ1bmN0aW9uIHNldEVsZW1lbnRWYWx1ZSAoa2V5cywgZWxlbWVudElkLCByZXBsYWNlID0gZmFsc2UpIHtcbiAgbGV0IHRleHQgPSBrZXlzO1xuICBpZiAoa2V5cyBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgdGV4dCA9IGtleXMuam9pbignJyk7XG4gIH1cblxuICBsZXQgcGFyYW1zID0ge1xuICAgIGVsZW1lbnRJZCxcbiAgICB0ZXh0LFxuICAgIHJlcGxhY2UsXG4gICAgdW5pY29kZUtleWJvYXJkOiB0aGlzLm9wdHMudW5pY29kZUtleWJvYXJkXG4gIH07XG5cbiAgcmV0dXJuIGF3YWl0IHRoaXMuZG9TZXRFbGVtZW50VmFsdWUocGFyYW1zKTtcbn07XG5cbi8qKlxuICogUmVhc29uIGZvciBpc29sYXRpbmcgZG9TZXRFbGVtZW50VmFsdWUgZnJvbSBzZXRFbGVtZW50VmFsdWUgaXMgZm9yIHJldXNpbmcgc2V0RWxlbWVudFZhbHVlXG4gKiBhY3Jvc3MgYW5kcm9pZC1kcml2ZXJzIChsaWtlIGFwcGl1bS11aWF1dG9tYXRvcjItZHJpdmVyKSBhbmQgdG8gYXZvaWQgY29kZSBkdXBsaWNhdGlvbi5cbiAqIE90aGVyIGFuZHJvaWQtZHJpdmVycyAobGlrZSBhcHBpdW0tdWlhdXRvbWF0b3IyLWRyaXZlcikgbmVlZCB0byBvdmVycmlkZSBkb1NldEVsZW1lbnRWYWx1ZVxuICogdG8gZmFjaWxpdGF0ZSBzZXRFbGVtZW50VmFsdWUuXG4gKi9cbmhlbHBlcnMuZG9TZXRFbGVtZW50VmFsdWUgPSBhc3luYyBmdW5jdGlvbiBkb1NldEVsZW1lbnRWYWx1ZSAocGFyYW1zKSB7XG4gIHJldHVybiBhd2FpdCB0aGlzLmJvb3RzdHJhcC5zZW5kQWN0aW9uKCdlbGVtZW50OnNldFRleHQnLCBwYXJhbXMpO1xufTtcblxuY29tbWFuZHMuc2V0VmFsdWUgPSBhc3luYyBmdW5jdGlvbiBzZXRWYWx1ZSAoa2V5cywgZWxlbWVudElkKSB7XG4gIHJldHVybiBhd2FpdCB0aGlzLnNldEVsZW1lbnRWYWx1ZShrZXlzLCBlbGVtZW50SWQsIGZhbHNlKTtcbn07XG5cbmNvbW1hbmRzLnJlcGxhY2VWYWx1ZSA9IGFzeW5jIGZ1bmN0aW9uIHJlcGxhY2VWYWx1ZSAoa2V5cywgZWxlbWVudElkKSB7XG4gIHJldHVybiBhd2FpdCB0aGlzLnNldEVsZW1lbnRWYWx1ZShrZXlzLCBlbGVtZW50SWQsIHRydWUpO1xufTtcblxuY29tbWFuZHMuc2V0VmFsdWVJbW1lZGlhdGUgPSBhc3luYyBmdW5jdGlvbiBzZXRWYWx1ZUltbWVkaWF0ZSAoa2V5cywgZWxlbWVudElkKSB7XG4gIGxldCB0ZXh0ID0ga2V5cztcbiAgaWYgKGtleXMgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgIHRleHQgPSBrZXlzLmpvaW4oJycpO1xuICB9XG5cbiAgLy8gZmlyc3QsIG1ha2Ugc3VyZSB3ZSBhcmUgZm9jdXNlZCBvbiB0aGUgZWxlbWVudFxuICBhd2FpdCB0aGlzLmNsaWNrKGVsZW1lbnRJZCk7XG5cbiAgLy8gdGhlbiBzZW5kIHRocm91Z2ggYWRiXG4gIGF3YWl0IHRoaXMuYWRiLmlucHV0VGV4dCh0ZXh0KTtcbn07XG5cbmNvbW1hbmRzLmdldFRleHQgPSBhc3luYyBmdW5jdGlvbiBnZXRUZXh0IChlbGVtZW50SWQpIHtcbiAgcmV0dXJuIGF3YWl0IHRoaXMuYm9vdHN0cmFwLnNlbmRBY3Rpb24oJ2VsZW1lbnQ6Z2V0VGV4dCcsIHtlbGVtZW50SWR9KTtcbn07XG5cbmNvbW1hbmRzLmNsZWFyID0gYXN5bmMgZnVuY3Rpb24gY2xlYXIgKGVsZW1lbnRJZCkge1xuICBsZXQgdGV4dCA9IChhd2FpdCB0aGlzLmdldFRleHQoZWxlbWVudElkKSkgfHwgJyc7XG4gIGxldCBsZW5ndGggPSB0ZXh0Lmxlbmd0aDtcbiAgaWYgKGxlbmd0aCA9PT0gMCkge1xuICAgIC8vIGlmIGxlbmd0aCBpcyB6ZXJvIHRoZXJlIGFyZSB0d28gcG9zc2liaWxpdGllczpcbiAgICAvLyAgIDEuIHRoZXJlIGlzIG5vdGhpbmcgaW4gdGhlIHRleHQgZmllbGRcbiAgICAvLyAgIDIuIGl0IGlzIGEgcGFzc3dvcmQgZmllbGRcbiAgICAvLyBzaW5jZSB0aGVyZSBpcyBsaXR0bGUgb3ZlcmhlYWQgdG8gdGhlIGFkYiBjYWxsLCBkZWxldGUgMTAwIGVsZW1lbnRzXG4gICAgLy8gaWYgd2UgZ2V0IHplcm8sIGp1c3QgaW4gY2FzZSBpdCBpcyAjMlxuICAgIGxlbmd0aCA9IDEwMDtcbiAgfVxuICBhd2FpdCB0aGlzLmNsaWNrKGVsZW1lbnRJZCk7XG4gIHRoaXMubG9nLmRlYnVnKGBTZW5kaW5nIHVwIHRvICR7bGVuZ3RofSBjbGVhciBjaGFyYWN0ZXJzIHRvIGRldmljZWApO1xuICByZXR1cm4gYXdhaXQgcmV0cnlJbnRlcnZhbCg1LCA1MDAsIGFzeW5jICgpID0+IHtcbiAgICBsZXQgcmVtYWluaW5nTGVuZ3RoID0gbGVuZ3RoO1xuICAgIHdoaWxlIChyZW1haW5pbmdMZW5ndGggPiAwKSB7XG4gICAgICBsZXQgbGVuZ3RoVG9TZW5kID0gcmVtYWluaW5nTGVuZ3RoIDwgNTAgPyByZW1haW5pbmdMZW5ndGggOiA1MDtcbiAgICAgIHRoaXMubG9nLmRlYnVnKGBTZW5kaW5nICR7bGVuZ3RoVG9TZW5kfSBjbGVhciBjaGFyYWN0ZXJzIHRvIGRldmljZWApO1xuICAgICAgYXdhaXQgdGhpcy5hZGIuY2xlYXJUZXh0RmllbGQobGVuZ3RoVG9TZW5kKTtcbiAgICAgIHJlbWFpbmluZ0xlbmd0aCAtPSBsZW5ndGhUb1NlbmQ7XG4gICAgfVxuICB9KTtcbn07XG5cbmNvbW1hbmRzLmNsaWNrID0gYXN5bmMgZnVuY3Rpb24gY2xpY2sgKGVsZW1lbnRJZCkge1xuICByZXR1cm4gYXdhaXQgdGhpcy5ib290c3RyYXAuc2VuZEFjdGlvbignZWxlbWVudDpjbGljaycsIHtlbGVtZW50SWR9KTtcbn07XG5cbmNvbW1hbmRzLmdldExvY2F0aW9uID0gYXN5bmMgZnVuY3Rpb24gZ2V0TG9jYXRpb24gKGVsZW1lbnRJZCkge1xuICByZXR1cm4gYXdhaXQgdGhpcy5ib290c3RyYXAuc2VuZEFjdGlvbignZWxlbWVudDpnZXRMb2NhdGlvbicsIHtlbGVtZW50SWR9KTtcbn07XG5cbmNvbW1hbmRzLmdldExvY2F0aW9uSW5WaWV3ID0gYXN5bmMgZnVuY3Rpb24gZ2V0TG9jYXRpb25JblZpZXcgKGVsZW1lbnRJZCkge1xuICByZXR1cm4gYXdhaXQgdGhpcy5nZXRMb2NhdGlvbihlbGVtZW50SWQpO1xufTtcblxuY29tbWFuZHMuZ2V0U2l6ZSA9IGFzeW5jIGZ1bmN0aW9uIGdldFNpemUgKGVsZW1lbnRJZCkge1xuICByZXR1cm4gYXdhaXQgdGhpcy5ib290c3RyYXAuc2VuZEFjdGlvbignZWxlbWVudDpnZXRTaXplJywge2VsZW1lbnRJZH0pO1xufTtcblxuY29tbWFuZHMuZ2V0RWxlbWVudFJlY3QgPSBhc3luYyBmdW5jdGlvbiBnZXRFbGVtZW50UmVjdCAoZWxlbWVudElkKSB7XG4gIHJldHVybiBhd2FpdCB0aGlzLmJvb3RzdHJhcC5zZW5kQWN0aW9uKCdlbGVtZW50OmdldFJlY3QnLCB7ZWxlbWVudElkfSk7XG59O1xuXG5jb21tYW5kcy50b3VjaExvbmdDbGljayA9IGFzeW5jIGZ1bmN0aW9uIHRvdWNoTG9uZ0NsaWNrIChlbGVtZW50SWQsIHgsIHksIGR1cmF0aW9uKSB7XG4gIGxldCBwYXJhbXMgPSB7ZWxlbWVudElkLCB4LCB5LCBkdXJhdGlvbn07XG4gIGFuZHJvaWRIZWxwZXJzLnJlbW92ZU51bGxQcm9wZXJ0aWVzKHBhcmFtcyk7XG4gIHJldHVybiBhd2FpdCB0aGlzLmJvb3RzdHJhcC5zZW5kQWN0aW9uKCdlbGVtZW50OnRvdWNoTG9uZ0NsaWNrJywgcGFyYW1zKTtcbn07XG5cbmNvbW1hbmRzLnRvdWNoRG93biA9IGFzeW5jIGZ1bmN0aW9uIHRvdWNoRG93biAoZWxlbWVudElkLCB4LCB5KSB7XG4gIGxldCBwYXJhbXMgPSB7ZWxlbWVudElkLCB4LCB5fTtcbiAgYW5kcm9pZEhlbHBlcnMucmVtb3ZlTnVsbFByb3BlcnRpZXMocGFyYW1zKTtcbiAgcmV0dXJuIGF3YWl0IHRoaXMuYm9vdHN0cmFwLnNlbmRBY3Rpb24oJ2VsZW1lbnQ6dG91Y2hEb3duJywgcGFyYW1zKTtcbn07XG5cbmNvbW1hbmRzLnRvdWNoVXAgPSBhc3luYyBmdW5jdGlvbiB0b3VjaFVwIChlbGVtZW50SWQsIHgsIHkpIHtcbiAgbGV0IHBhcmFtcyA9IHtlbGVtZW50SWQsIHgsIHl9O1xuICBhbmRyb2lkSGVscGVycy5yZW1vdmVOdWxsUHJvcGVydGllcyhwYXJhbXMpO1xuICByZXR1cm4gYXdhaXQgdGhpcy5ib290c3RyYXAuc2VuZEFjdGlvbignZWxlbWVudDp0b3VjaFVwJywgcGFyYW1zKTtcbn07XG5cbmNvbW1hbmRzLnRvdWNoTW92ZSA9IGFzeW5jIGZ1bmN0aW9uIHRvdWNoTW92ZSAoZWxlbWVudElkLCB4LCB5KSB7XG4gIGxldCBwYXJhbXMgPSB7ZWxlbWVudElkLCB4LCB5fTtcbiAgYW5kcm9pZEhlbHBlcnMucmVtb3ZlTnVsbFByb3BlcnRpZXMocGFyYW1zKTtcbiAgcmV0dXJuIGF3YWl0IHRoaXMuYm9vdHN0cmFwLnNlbmRBY3Rpb24oJ2VsZW1lbnQ6dG91Y2hNb3ZlJywgcGFyYW1zKTtcbn07XG5cbmNvbW1hbmRzLmNvbXBsZXhUYXAgPSBhc3luYyBmdW5jdGlvbiBjb21wbGV4VGFwICh0YXBDb3VudCwgdG91Y2hDb3VudCwgZHVyYXRpb24sIHgsIHkpIHtcbiAgcmV0dXJuIGF3YWl0IHRoaXMuYm9vdHN0cmFwLnNlbmRBY3Rpb24oJ2NsaWNrJywge3gsIHl9KTtcbn07XG5cbmNvbW1hbmRzLnRhcCA9IGFzeW5jIGZ1bmN0aW9uIChlbGVtZW50SWQgPSBudWxsLCB4ID0gbnVsbCwgeSA9IG51bGwsIGNvdW50ID0gMSkge1xuICBpZiAoIXV0aWwuaGFzVmFsdWUoZWxlbWVudElkKSAmJiAhdXRpbC5oYXNWYWx1ZSh4KSAmJiAhdXRpbC5oYXNWYWx1ZSh5KSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgRWl0aGVyIGVsZW1lbnQgdG8gdGFwIG9yIGJvdGggYWJzb2x1dGUgY29vcmRpbmF0ZXMgc2hvdWxkIGJlIGRlZmluZWRgKTtcbiAgfVxuICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHtcbiAgICBpZiAodXRpbC5oYXNWYWx1ZShlbGVtZW50SWQpKSB7XG4gICAgICAvLyBGSVhNRTogYm9vdHN0cmFwIGlnbm9yZXMgcmVsYXRpdmUgY29vcmRpbmF0ZXNcbiAgICAgIGF3YWl0IHRoaXMuYm9vdHN0cmFwLnNlbmRBY3Rpb24oJ2VsZW1lbnQ6Y2xpY2snLCB7ZWxlbWVudElkLCB4LCB5fSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGF3YWl0IHRoaXMuYm9vdHN0cmFwLnNlbmRBY3Rpb24oJ2NsaWNrJywge3gsIHl9KTtcbiAgICB9XG4gIH1cbn07XG5cbk9iamVjdC5hc3NpZ24oZXh0ZW5zaW9ucywgY29tbWFuZHMsIGhlbHBlcnMpO1xuZXhwb3J0IHsgY29tbWFuZHMsIGhlbHBlcnMgfTtcbmV4cG9ydCBkZWZhdWx0IGV4dGVuc2lvbnM7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUEsSUFBQUEsZUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsU0FBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsUUFBQSxHQUFBRixPQUFBO0FBR0EsSUFBSUcsUUFBUSxHQUFHLENBQUMsQ0FBQztFQUFFQyxPQUFPLEdBQUcsQ0FBQyxDQUFDO0VBQUVDLFVBQVUsR0FBRyxDQUFDLENBQUM7QUFBQ0MsT0FBQSxDQUFBRixPQUFBLEdBQUFBLE9BQUE7QUFBQUUsT0FBQSxDQUFBSCxRQUFBLEdBQUFBLFFBQUE7QUFFakRBLFFBQVEsQ0FBQ0ksWUFBWSxHQUFHLGVBQWVBLFlBQVlBLENBQUVDLFNBQVMsRUFBRUMsU0FBUyxFQUFFO0VBQ3pFLElBQUlDLENBQUMsR0FBRztJQUFDRixTQUFTO0lBQUVDO0VBQVMsQ0FBQztF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