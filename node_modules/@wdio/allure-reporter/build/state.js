import { sep } from 'node:path';
import { AllureGroup, AllureTest, AllureStep } from 'allure-js-commons';
import { findLast } from './utils.js';
export class AllureReporterState {
    currentFile;
    runningUnits = [];
    get currentSuite() {
        return findLast(this.runningUnits, (unit) => unit instanceof AllureGroup);
    }
    get currentTest() {
        return findLast(this.runningUnits, (unit) => unit instanceof AllureTest);
    }
    get currentStep() {
        return findLast(this.runningUnits, (unit) => unit instanceof AllureStep);
    }
    get currentAllureTestOrStep() {
        return findLast(this.runningUnits, (unit) => unit instanceof AllureTest || unit instanceof AllureStep);
    }
    get currentPackageLabel() {
        if (!this.currentFile) {
            return undefined;
        }
        return this.currentFile.replaceAll(sep, '.');
    }
    push(unit) {
        this.runningUnits.push(unit);
    }
    pop() {
        return this.runningUnits.pop();
    }
}
